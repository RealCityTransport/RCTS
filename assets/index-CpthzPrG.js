(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();function Gh(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Qe={},oi=[],Mn=()=>{},r_=()=>!1,pc=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),zh=n=>n.startsWith("onUpdate:"),Ft=Object.assign,Hh=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},OT=Object.prototype.hasOwnProperty,Ue=(n,e)=>OT.call(n,e),ve=Array.isArray,ai=n=>va(n)==="[object Map]",mc=n=>va(n)==="[object Set]",lp=n=>va(n)==="[object Date]",we=n=>typeof n=="function",ht=n=>typeof n=="string",bn=n=>typeof n=="symbol",Je=n=>n!==null&&typeof n=="object",i_=n=>(Je(n)||we(n))&&we(n.then)&&we(n.catch),o_=Object.prototype.toString,va=n=>o_.call(n),MT=n=>va(n).slice(8,-1),a_=n=>va(n)==="[object Object]",Wh=n=>ht(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Co=Gh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),gc=n=>{const e=Object.create(null);return(t=>e[t]||(e[t]=n(t)))},LT=/-\w/g,fn=gc(n=>n.replace(LT,e=>e.slice(1).toUpperCase())),FT=/\B([A-Z])/g,Lr=gc(n=>n.replace(FT,"-$1").toLowerCase()),_c=gc(n=>n.charAt(0).toUpperCase()+n.slice(1)),mu=gc(n=>n?`on${_c(n)}`:""),Ls=(n,e)=>!Object.is(n,e),al=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},l_=(n,e,t,s=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:s,value:t})},Qh=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let cp;const yc=()=>cp||(cp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function vc(n){if(ve(n)){const e={};for(let t=0;t<n.length;t++){const s=n[t],r=ht(s)?jT(s):vc(s);if(r)for(const i in r)e[i]=r[i]}return e}else if(ht(n)||Je(n))return n}const UT=/;(?![^(]*\))/g,BT=/:([^]+)/,$T=/\/\*[^]*?\*\//g;function jT(n){const e={};return n.replace($T,"").split(UT).forEach(t=>{if(t){const s=t.split(BT);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function gi(n){let e="";if(ht(n))e=n;else if(ve(n))for(let t=0;t<n.length;t++){const s=gi(n[t]);s&&(e+=s+" ")}else if(Je(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const qT="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",KT=Gh(qT);function c_(n){return!!n||n===""}function GT(n,e){if(n.length!==e.length)return!1;let t=!0;for(let s=0;t&&s<n.length;s++)t=_i(n[s],e[s]);return t}function _i(n,e){if(n===e)return!0;let t=lp(n),s=lp(e);if(t||s)return t&&s?n.getTime()===e.getTime():!1;if(t=bn(n),s=bn(e),t||s)return n===e;if(t=ve(n),s=ve(e),t||s)return t&&s?GT(n,e):!1;if(t=Je(n),s=Je(e),t||s){if(!t||!s)return!1;const r=Object.keys(n).length,i=Object.keys(e).length;if(r!==i)return!1;for(const o in n){const l=n.hasOwnProperty(o),c=e.hasOwnProperty(o);if(l&&!c||!l&&c||!_i(n[o],e[o]))return!1}}return String(n)===String(e)}function u_(n,e){return n.findIndex(t=>_i(t,e))}const h_=n=>!!(n&&n.__v_isRef===!0),_e=n=>ht(n)?n:n==null?"":ve(n)||Je(n)&&(n.toString===o_||!we(n.toString))?h_(n)?_e(n.value):JSON.stringify(n,d_,2):String(n),d_=(n,e)=>h_(e)?d_(n,e.value):ai(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[s,r],i)=>(t[gu(s,i)+" =>"]=r,t),{})}:mc(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>gu(t))}:bn(e)?gu(e):Je(e)&&!ve(e)&&!a_(e)?String(e):e,gu=(n,e="")=>{var t;return bn(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};let Nt;class zT{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Nt,!e&&Nt&&(this.index=(Nt.scopes||(Nt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Nt;try{return Nt=this,e()}finally{Nt=t}}}on(){++this._on===1&&(this.prevScope=Nt,Nt=this)}off(){this._on>0&&--this._on===0&&(Nt=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,s;for(t=0,s=this.effects.length;t<s;t++)this.effects[t].stop();for(this.effects.length=0,t=0,s=this.cleanups.length;t<s;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function HT(){return Nt}function WT(n,e=!1){Nt&&Nt.cleanups.push(n)}let Xe;const _u=new WeakSet;class f_{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Nt&&Nt.active&&Nt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,_u.has(this)&&(_u.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||m_(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,up(this),g_(this);const e=Xe,t=En;Xe=this,En=!0;try{return this.fn()}finally{__(this),Xe=e,En=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Xh(e);this.deps=this.depsTail=void 0,up(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?_u.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Gu(this)&&this.run()}get dirty(){return Gu(this)}}let p_=0,ko,No;function m_(n,e=!1){if(n.flags|=8,e){n.next=No,No=n;return}n.next=ko,ko=n}function Yh(){p_++}function Jh(){if(--p_>0)return;if(No){let e=No;for(No=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;ko;){let e=ko;for(ko=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){n||(n=s)}e=t}}if(n)throw n}function g_(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function __(n){let e,t=n.depsTail,s=t;for(;s;){const r=s.prevDep;s.version===-1?(s===t&&(t=r),Xh(s),QT(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=r}n.deps=e,n.depsTail=t}function Gu(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(y_(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function y_(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===Ho)||(n.globalVersion=Ho,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!Gu(n))))return;n.flags|=2;const e=n.dep,t=Xe,s=En;Xe=n,En=!0;try{g_(n);const r=n.fn(n._value);(e.version===0||Ls(r,n._value))&&(n.flags|=128,n._value=r,e.version++)}catch(r){throw e.version++,r}finally{Xe=t,En=s,__(n),n.flags&=-3}}function Xh(n,e=!1){const{dep:t,prevSub:s,nextSub:r}=n;if(s&&(s.nextSub=r,n.prevSub=void 0),r&&(r.prevSub=s,n.nextSub=void 0),t.subs===n&&(t.subs=s,!s&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)Xh(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function QT(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let En=!0;const v_=[];function rs(){v_.push(En),En=!1}function is(){const n=v_.pop();En=n===void 0?!0:n}function up(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Xe;Xe=void 0;try{e()}finally{Xe=t}}}let Ho=0;class YT{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Zh{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Xe||!En||Xe===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Xe)t=this.activeLink=new YT(Xe,this),Xe.deps?(t.prevDep=Xe.depsTail,Xe.depsTail.nextDep=t,Xe.depsTail=t):Xe.deps=Xe.depsTail=t,E_(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const s=t.nextDep;s.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=s),t.prevDep=Xe.depsTail,t.nextDep=void 0,Xe.depsTail.nextDep=t,Xe.depsTail=t,Xe.deps===t&&(Xe.deps=s)}return t}trigger(e){this.version++,Ho++,this.notify(e)}notify(e){Yh();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Jh()}}}function E_(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)E_(s)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const zu=new WeakMap,yr=Symbol(""),Hu=Symbol(""),Wo=Symbol("");function Vt(n,e,t){if(En&&Xe){let s=zu.get(n);s||zu.set(n,s=new Map);let r=s.get(t);r||(s.set(t,r=new Zh),r.map=s,r.key=t),r.track()}}function Qn(n,e,t,s,r,i){const o=zu.get(n);if(!o){Ho++;return}const l=c=>{c&&c.trigger()};if(Yh(),e==="clear")o.forEach(l);else{const c=ve(n),u=c&&Wh(t);if(c&&t==="length"){const h=Number(s);o.forEach((f,m)=>{(m==="length"||m===Wo||!bn(m)&&m>=h)&&l(f)})}else switch((t!==void 0||o.has(void 0))&&l(o.get(t)),u&&l(o.get(Wo)),e){case"add":c?u&&l(o.get("length")):(l(o.get(yr)),ai(n)&&l(o.get(Hu)));break;case"delete":c||(l(o.get(yr)),ai(n)&&l(o.get(Hu)));break;case"set":ai(n)&&l(o.get(yr));break}}Jh()}function zr(n){const e=Fe(n);return e===n?e:(Vt(e,"iterate",Wo),hn(n)?e:e.map(An))}function Ec(n){return Vt(n=Fe(n),"iterate",Wo),n}function Rs(n,e){return os(n)?vr(n)?yi(An(e)):yi(e):An(e)}const JT={__proto__:null,[Symbol.iterator](){return yu(this,Symbol.iterator,n=>Rs(this,n))},concat(...n){return zr(this).concat(...n.map(e=>ve(e)?zr(e):e))},entries(){return yu(this,"entries",n=>(n[1]=Rs(this,n[1]),n))},every(n,e){return zn(this,"every",n,e,void 0,arguments)},filter(n,e){return zn(this,"filter",n,e,t=>t.map(s=>Rs(this,s)),arguments)},find(n,e){return zn(this,"find",n,e,t=>Rs(this,t),arguments)},findIndex(n,e){return zn(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return zn(this,"findLast",n,e,t=>Rs(this,t),arguments)},findLastIndex(n,e){return zn(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return zn(this,"forEach",n,e,void 0,arguments)},includes(...n){return vu(this,"includes",n)},indexOf(...n){return vu(this,"indexOf",n)},join(n){return zr(this).join(n)},lastIndexOf(...n){return vu(this,"lastIndexOf",n)},map(n,e){return zn(this,"map",n,e,void 0,arguments)},pop(){return uo(this,"pop")},push(...n){return uo(this,"push",n)},reduce(n,...e){return hp(this,"reduce",n,e)},reduceRight(n,...e){return hp(this,"reduceRight",n,e)},shift(){return uo(this,"shift")},some(n,e){return zn(this,"some",n,e,void 0,arguments)},splice(...n){return uo(this,"splice",n)},toReversed(){return zr(this).toReversed()},toSorted(n){return zr(this).toSorted(n)},toSpliced(...n){return zr(this).toSpliced(...n)},unshift(...n){return uo(this,"unshift",n)},values(){return yu(this,"values",n=>Rs(this,n))}};function yu(n,e,t){const s=Ec(n),r=s[e]();return s!==n&&!hn(n)&&(r._next=r.next,r.next=()=>{const i=r._next();return i.done||(i.value=t(i.value)),i}),r}const XT=Array.prototype;function zn(n,e,t,s,r,i){const o=Ec(n),l=o!==n&&!hn(n),c=o[e];if(c!==XT[e]){const f=c.apply(n,i);return l?An(f):f}let u=t;o!==n&&(l?u=function(f,m){return t.call(this,Rs(n,f),m,n)}:t.length>2&&(u=function(f,m){return t.call(this,f,m,n)}));const h=c.call(o,u,s);return l&&r?r(h):h}function hp(n,e,t,s){const r=Ec(n);let i=t;return r!==n&&(hn(n)?t.length>3&&(i=function(o,l,c){return t.call(this,o,l,c,n)}):i=function(o,l,c){return t.call(this,o,Rs(n,l),c,n)}),r[e](i,...s)}function vu(n,e,t){const s=Fe(n);Vt(s,"iterate",Wo);const r=s[e](...t);return(r===-1||r===!1)&&nd(t[0])?(t[0]=Fe(t[0]),s[e](...t)):r}function uo(n,e,t=[]){rs(),Yh();const s=Fe(n)[e].apply(n,t);return Jh(),is(),s}const ZT=Gh("__proto__,__v_isRef,__isVue"),I_=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(bn));function ew(n){bn(n)||(n=String(n));const e=Fe(this);return Vt(e,"has",n),e.hasOwnProperty(n)}class T_{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,s){if(t==="__v_skip")return e.__v_skip;const r=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!r;if(t==="__v_isReadonly")return r;if(t==="__v_isShallow")return i;if(t==="__v_raw")return s===(r?i?uw:S_:i?A_:b_).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=ve(e);if(!r){let c;if(o&&(c=JT[t]))return c;if(t==="hasOwnProperty")return ew}const l=Reflect.get(e,t,Ot(e)?e:s);if((bn(t)?I_.has(t):ZT(t))||(r||Vt(e,"get",t),i))return l;if(Ot(l)){const c=o&&Wh(t)?l:l.value;return r&&Je(c)?Qu(c):c}return Je(l)?r?Qu(l):Ic(l):l}}class w_ extends T_{constructor(e=!1){super(!1,e)}set(e,t,s,r){let i=e[t];const o=ve(e)&&Wh(t);if(!this._isShallow){const u=os(i);if(!hn(s)&&!os(s)&&(i=Fe(i),s=Fe(s)),!o&&Ot(i)&&!Ot(s))return u||(i.value=s),!0}const l=o?Number(t)<e.length:Ue(e,t),c=Reflect.set(e,t,s,Ot(e)?e:r);return e===Fe(r)&&(l?Ls(s,i)&&Qn(e,"set",t,s):Qn(e,"add",t,s)),c}deleteProperty(e,t){const s=Ue(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&s&&Qn(e,"delete",t,void 0),r}has(e,t){const s=Reflect.has(e,t);return(!bn(t)||!I_.has(t))&&Vt(e,"has",t),s}ownKeys(e){return Vt(e,"iterate",ve(e)?"length":yr),Reflect.ownKeys(e)}}class tw extends T_{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const nw=new w_,sw=new tw,rw=new w_(!0);const Wu=n=>n,Wa=n=>Reflect.getPrototypeOf(n);function iw(n,e,t){return function(...s){const r=this.__v_raw,i=Fe(r),o=ai(i),l=n==="entries"||n===Symbol.iterator&&o,c=n==="keys"&&o,u=r[n](...s),h=t?Wu:e?yi:An;return!e&&Vt(i,"iterate",c?Hu:yr),{next(){const{value:f,done:m}=u.next();return m?{value:f,done:m}:{value:l?[h(f[0]),h(f[1])]:h(f),done:m}},[Symbol.iterator](){return this}}}}function Qa(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function ow(n,e){const t={get(r){const i=this.__v_raw,o=Fe(i),l=Fe(r);n||(Ls(r,l)&&Vt(o,"get",r),Vt(o,"get",l));const{has:c}=Wa(o),u=e?Wu:n?yi:An;if(c.call(o,r))return u(i.get(r));if(c.call(o,l))return u(i.get(l));i!==o&&i.get(r)},get size(){const r=this.__v_raw;return!n&&Vt(Fe(r),"iterate",yr),r.size},has(r){const i=this.__v_raw,o=Fe(i),l=Fe(r);return n||(Ls(r,l)&&Vt(o,"has",r),Vt(o,"has",l)),r===l?i.has(r):i.has(r)||i.has(l)},forEach(r,i){const o=this,l=o.__v_raw,c=Fe(l),u=e?Wu:n?yi:An;return!n&&Vt(c,"iterate",yr),l.forEach((h,f)=>r.call(i,u(h),u(f),o))}};return Ft(t,n?{add:Qa("add"),set:Qa("set"),delete:Qa("delete"),clear:Qa("clear")}:{add(r){!e&&!hn(r)&&!os(r)&&(r=Fe(r));const i=Fe(this);return Wa(i).has.call(i,r)||(i.add(r),Qn(i,"add",r,r)),this},set(r,i){!e&&!hn(i)&&!os(i)&&(i=Fe(i));const o=Fe(this),{has:l,get:c}=Wa(o);let u=l.call(o,r);u||(r=Fe(r),u=l.call(o,r));const h=c.call(o,r);return o.set(r,i),u?Ls(i,h)&&Qn(o,"set",r,i):Qn(o,"add",r,i),this},delete(r){const i=Fe(this),{has:o,get:l}=Wa(i);let c=o.call(i,r);c||(r=Fe(r),c=o.call(i,r)),l&&l.call(i,r);const u=i.delete(r);return c&&Qn(i,"delete",r,void 0),u},clear(){const r=Fe(this),i=r.size!==0,o=r.clear();return i&&Qn(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=iw(r,n,e)}),t}function ed(n,e){const t=ow(n,e);return(s,r,i)=>r==="__v_isReactive"?!n:r==="__v_isReadonly"?n:r==="__v_raw"?s:Reflect.get(Ue(t,r)&&r in s?t:s,r,i)}const aw={get:ed(!1,!1)},lw={get:ed(!1,!0)},cw={get:ed(!0,!1)};const b_=new WeakMap,A_=new WeakMap,S_=new WeakMap,uw=new WeakMap;function hw(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function dw(n){return n.__v_skip||!Object.isExtensible(n)?0:hw(MT(n))}function Ic(n){return os(n)?n:td(n,!1,nw,aw,b_)}function R_(n){return td(n,!1,rw,lw,A_)}function Qu(n){return td(n,!0,sw,cw,S_)}function td(n,e,t,s,r){if(!Je(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=dw(n);if(i===0)return n;const o=r.get(n);if(o)return o;const l=new Proxy(n,i===2?s:t);return r.set(n,l),l}function vr(n){return os(n)?vr(n.__v_raw):!!(n&&n.__v_isReactive)}function os(n){return!!(n&&n.__v_isReadonly)}function hn(n){return!!(n&&n.__v_isShallow)}function nd(n){return n?!!n.__v_raw:!1}function Fe(n){const e=n&&n.__v_raw;return e?Fe(e):n}function fw(n){return!Ue(n,"__v_skip")&&Object.isExtensible(n)&&l_(n,"__v_skip",!0),n}const An=n=>Je(n)?Ic(n):n,yi=n=>Je(n)?Qu(n):n;function Ot(n){return n?n.__v_isRef===!0:!1}function be(n){return P_(n,!1)}function pw(n){return P_(n,!0)}function P_(n,e){return Ot(n)?n:new mw(n,e)}class mw{constructor(e,t){this.dep=new Zh,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Fe(e),this._value=t?e:An(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,s=this.__v_isShallow||hn(e)||os(e);e=s?e:Fe(e),Ls(e,t)&&(this._rawValue=e,this._value=s?e:An(e),this.dep.trigger())}}function Be(n){return Ot(n)?n.value:n}const gw={get:(n,e,t)=>e==="__v_raw"?n:Be(Reflect.get(n,e,t)),set:(n,e,t,s)=>{const r=n[e];return Ot(r)&&!Ot(t)?(r.value=t,!0):Reflect.set(n,e,t,s)}};function C_(n){return vr(n)?n:new Proxy(n,gw)}class _w{constructor(e,t,s){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Zh(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ho-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Xe!==this)return m_(this,!0),!0}get value(){const e=this.dep.track();return y_(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function yw(n,e,t=!1){let s,r;return we(n)?s=n:(s=n.get,r=n.set),new _w(s,r,t)}const Ya={},Nl=new WeakMap;let or;function vw(n,e=!1,t=or){if(t){let s=Nl.get(t);s||Nl.set(t,s=[]),s.push(n)}}function Ew(n,e,t=Qe){const{immediate:s,deep:r,once:i,scheduler:o,augmentJob:l,call:c}=t,u=P=>r?P:hn(P)||r===!1||r===0?Yn(P,1):Yn(P);let h,f,m,_,R=!1,x=!1;if(Ot(n)?(f=()=>n.value,R=hn(n)):vr(n)?(f=()=>u(n),R=!0):ve(n)?(x=!0,R=n.some(P=>vr(P)||hn(P)),f=()=>n.map(P=>{if(Ot(P))return P.value;if(vr(P))return u(P);if(we(P))return c?c(P,2):P()})):we(n)?e?f=c?()=>c(n,2):n:f=()=>{if(m){rs();try{m()}finally{is()}}const P=or;or=h;try{return c?c(n,3,[_]):n(_)}finally{or=P}}:f=Mn,e&&r){const P=f,j=r===!0?1/0:r;f=()=>Yn(P(),j)}const O=HT(),$=()=>{h.stop(),O&&O.active&&Hh(O.effects,h)};if(i&&e){const P=e;e=(...j)=>{P(...j),$()}}let U=x?new Array(n.length).fill(Ya):Ya;const D=P=>{if(!(!(h.flags&1)||!h.dirty&&!P))if(e){const j=h.run();if(r||R||(x?j.some((Y,I)=>Ls(Y,U[I])):Ls(j,U))){m&&m();const Y=or;or=h;try{const I=[j,U===Ya?void 0:x&&U[0]===Ya?[]:U,_];U=j,c?c(e,3,I):e(...I)}finally{or=Y}}}else h.run()};return l&&l(D),h=new f_(f),h.scheduler=o?()=>o(D,!1):D,_=P=>vw(P,!1,h),m=h.onStop=()=>{const P=Nl.get(h);if(P){if(c)c(P,4);else for(const j of P)j();Nl.delete(h)}},e?s?D(!0):U=h.run():o?o(D.bind(null,!0),!0):h.run(),$.pause=h.pause.bind(h),$.resume=h.resume.bind(h),$.stop=$,$}function Yn(n,e=1/0,t){if(e<=0||!Je(n)||n.__v_skip||(t=t||new Map,(t.get(n)||0)>=e))return n;if(t.set(n,e),e--,Ot(n))Yn(n.value,e,t);else if(ve(n))for(let s=0;s<n.length;s++)Yn(n[s],e,t);else if(mc(n)||ai(n))n.forEach(s=>{Yn(s,e,t)});else if(a_(n)){for(const s in n)Yn(n[s],e,t);for(const s of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,s)&&Yn(n[s],e,t)}return n}function Ea(n,e,t,s){try{return s?n(...s):n()}catch(r){Tc(r,e,t)}}function jn(n,e,t,s){if(we(n)){const r=Ea(n,e,t,s);return r&&i_(r)&&r.catch(i=>{Tc(i,e,t)}),r}if(ve(n)){const r=[];for(let i=0;i<n.length;i++)r.push(jn(n[i],e,t,s));return r}}function Tc(n,e,t,s=!0){const r=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Qe;if(e){let l=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;l;){const h=l.ec;if(h){for(let f=0;f<h.length;f++)if(h[f](n,c,u)===!1)return}l=l.parent}if(i){rs(),Ea(i,null,10,[n,c,u]),is();return}}Iw(n,t,r,s,o)}function Iw(n,e,t,s=!0,r=!1){if(r)throw n;console.error(n)}const Kt=[];let Nn=-1;const li=[];let Ps=null,Zr=0;const k_=Promise.resolve();let Dl=null;function N_(n){const e=Dl||k_;return n?e.then(this?n.bind(this):n):e}function Tw(n){let e=Nn+1,t=Kt.length;for(;e<t;){const s=e+t>>>1,r=Kt[s],i=Qo(r);i<n||i===n&&r.flags&2?e=s+1:t=s}return e}function sd(n){if(!(n.flags&1)){const e=Qo(n),t=Kt[Kt.length-1];!t||!(n.flags&2)&&e>=Qo(t)?Kt.push(n):Kt.splice(Tw(e),0,n),n.flags|=1,D_()}}function D_(){Dl||(Dl=k_.then(x_))}function ww(n){ve(n)?li.push(...n):Ps&&n.id===-1?Ps.splice(Zr+1,0,n):n.flags&1||(li.push(n),n.flags|=1),D_()}function dp(n,e,t=Nn+1){for(;t<Kt.length;t++){const s=Kt[t];if(s&&s.flags&2){if(n&&s.id!==n.uid)continue;Kt.splice(t,1),t--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function V_(n){if(li.length){const e=[...new Set(li)].sort((t,s)=>Qo(t)-Qo(s));if(li.length=0,Ps){Ps.push(...e);return}for(Ps=e,Zr=0;Zr<Ps.length;Zr++){const t=Ps[Zr];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}Ps=null,Zr=0}}const Qo=n=>n.id==null?n.flags&2?-1:1/0:n.id;function x_(n){try{for(Nn=0;Nn<Kt.length;Nn++){const e=Kt[Nn];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Ea(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Nn<Kt.length;Nn++){const e=Kt[Nn];e&&(e.flags&=-2)}Nn=-1,Kt.length=0,V_(),Dl=null,(Kt.length||li.length)&&x_()}}let St=null,O_=null;function Vl(n){const e=St;return St=n,O_=n&&n.type.__scopeId||null,e}function mn(n,e=St,t){if(!e||n._n)return n;const s=(...r)=>{s._d&&Ml(-1);const i=Vl(e);let o;try{o=n(...r)}finally{Vl(i),s._d&&Ml(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function ho(n,e){if(St===null)return n;const t=Sc(St),s=n.dirs||(n.dirs=[]);for(let r=0;r<e.length;r++){let[i,o,l,c=Qe]=e[r];i&&(we(i)&&(i={mounted:i,updated:i}),i.deep&&Yn(o),s.push({dir:i,instance:t,value:o,oldValue:void 0,arg:l,modifiers:c}))}return n}function sr(n,e,t,s){const r=n.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const l=r[o];i&&(l.oldValue=i[o].value);let c=l.dir[s];c&&(rs(),jn(c,t,8,[n.el,l,n,e]),is())}}function ll(n,e){if(xt){let t=xt.provides;const s=xt.parent&&xt.parent.provides;s===t&&(t=xt.provides=Object.create(s)),t[n]=e}}function In(n,e,t=!1){const s=Tb();if(s||ui){let r=ui?ui._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(r&&n in r)return r[n];if(arguments.length>1)return t&&we(e)?e.call(s&&s.proxy):e}}const bw=Symbol.for("v-scx"),Aw=()=>In(bw);function Do(n,e){return rd(n,null,e)}function Ln(n,e,t){return rd(n,e,t)}function rd(n,e,t=Qe){const{immediate:s,deep:r,flush:i,once:o}=t,l=Ft({},t),c=e&&s||!e&&i!=="post";let u;if(Zo){if(i==="sync"){const _=Aw();u=_.__watcherHandles||(_.__watcherHandles=[])}else if(!c){const _=()=>{};return _.stop=Mn,_.resume=Mn,_.pause=Mn,_}}const h=xt;l.call=(_,R,x)=>jn(_,h,R,x);let f=!1;i==="post"?l.scheduler=_=>{en(_,h&&h.suspense)}:i!=="sync"&&(f=!0,l.scheduler=(_,R)=>{R?_():sd(_)}),l.augmentJob=_=>{e&&(_.flags|=4),f&&(_.flags|=2,h&&(_.id=h.uid,_.i=h))};const m=Ew(n,e,l);return Zo&&(u?u.push(m):c&&m()),m}function Sw(n,e,t){const s=this.proxy,r=ht(n)?n.includes(".")?M_(s,n):()=>s[n]:n.bind(s,s);let i;we(e)?i=e:(i=e.handler,t=e);const o=Ia(this),l=rd(r,i.bind(s),t);return o(),l}function M_(n,e){const t=e.split(".");return()=>{let s=n;for(let r=0;r<t.length&&s;r++)s=s[t[r]];return s}}const Rw=Symbol("_vte"),Pw=n=>n.__isTeleport,Cw=Symbol("_leaveCb");function id(n,e){n.shapeFlag&6&&n.component?(n.transition=e,id(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function L_(n,e){return we(n)?Ft({name:n.name},e,{setup:n}):n}function F_(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}const xl=new WeakMap;function Vo(n,e,t,s,r=!1){if(ve(n)){n.forEach((R,x)=>Vo(R,e&&(ve(e)?e[x]:e),t,s,r));return}if(ci(s)&&!r){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Vo(n,e,t,s.component.subTree);return}const i=s.shapeFlag&4?Sc(s.component):s.el,o=r?null:i,{i:l,r:c}=n,u=e&&e.r,h=l.refs===Qe?l.refs={}:l.refs,f=l.setupState,m=Fe(f),_=f===Qe?r_:R=>Ue(m,R);if(u!=null&&u!==c){if(fp(e),ht(u))h[u]=null,_(u)&&(f[u]=null);else if(Ot(u)){u.value=null;const R=e;R.k&&(h[R.k]=null)}}if(we(c))Ea(c,l,12,[o,h]);else{const R=ht(c),x=Ot(c);if(R||x){const O=()=>{if(n.f){const $=R?_(c)?f[c]:h[c]:c.value;if(r)ve($)&&Hh($,i);else if(ve($))$.includes(i)||$.push(i);else if(R)h[c]=[i],_(c)&&(f[c]=h[c]);else{const U=[i];c.value=U,n.k&&(h[n.k]=U)}}else R?(h[c]=o,_(c)&&(f[c]=o)):x&&(c.value=o,n.k&&(h[n.k]=o))};if(o){const $=()=>{O(),xl.delete(n)};$.id=-1,xl.set(n,$),en($,t)}else fp(n),O()}}}function fp(n){const e=xl.get(n);e&&(e.flags|=8,xl.delete(n))}yc().requestIdleCallback;yc().cancelIdleCallback;const ci=n=>!!n.type.__asyncLoader,U_=n=>n.type.__isKeepAlive;function kw(n,e){B_(n,"a",e)}function Nw(n,e){B_(n,"da",e)}function B_(n,e,t=xt){const s=n.__wdc||(n.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return n()});if(wc(e,s,t),t){let r=t.parent;for(;r&&r.parent;)U_(r.parent.vnode)&&Dw(s,e,t,r),r=r.parent}}function Dw(n,e,t,s){const r=wc(e,n,s,!0);j_(()=>{Hh(s[e],r)},t)}function wc(n,e,t=xt,s=!1){if(t){const r=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{rs();const l=Ia(t),c=jn(e,t,n,o);return l(),is(),c});return s?r.unshift(i):r.push(i),i}}const ds=n=>(e,t=xt)=>{(!Zo||n==="sp")&&wc(n,(...s)=>e(...s),t)},Vw=ds("bm"),od=ds("m"),xw=ds("bu"),Ow=ds("u"),$_=ds("bum"),j_=ds("um"),Mw=ds("sp"),Lw=ds("rtg"),Fw=ds("rtc");function Uw(n,e=xt){wc("ec",n,e)}const Bw="components";function Yo(n,e){return jw(Bw,n,!0,e)||n}const $w=Symbol.for("v-ndc");function jw(n,e,t=!0,s=!1){const r=St||xt;if(r){const i=r.type;{const l=Rb(i,!1);if(l&&(l===e||l===fn(e)||l===_c(fn(e))))return i}const o=pp(r[n]||i[n],e)||pp(r.appContext[n],e);return!o&&s?i:o}}function pp(n,e){return n&&(n[e]||n[fn(e)]||n[_c(fn(e))])}function Rt(n,e,t,s){let r;const i=t,o=ve(n);if(o||ht(n)){const l=o&&vr(n);let c=!1,u=!1;l&&(c=!hn(n),u=os(n),n=Ec(n)),r=new Array(n.length);for(let h=0,f=n.length;h<f;h++)r[h]=e(c?u?yi(An(n[h])):An(n[h]):n[h],h,void 0,i)}else if(typeof n=="number"){r=new Array(n);for(let l=0;l<n;l++)r[l]=e(l+1,l,void 0,i)}else if(Je(n))if(n[Symbol.iterator])r=Array.from(n,(l,c)=>e(l,c,void 0,i));else{const l=Object.keys(n);r=new Array(l.length);for(let c=0,u=l.length;c<u;c++){const h=l[c];r[c]=e(n[h],h,c,i)}}else r=[];return r}function mp(n,e,t={},s,r){if(St.ce||St.parent&&ci(St.parent)&&St.parent.ce){const u=Object.keys(t).length>0;return e!=="default"&&(t.name=e),W(),vi(Me,null,[$e("slot",t,s)],u?-2:64)}let i=n[e];i&&i._c&&(i._d=!1),W();const o=i&&q_(i(t)),l=t.key||o&&o.key,c=vi(Me,{key:(l&&!bn(l)?l:`_${e}`)+(!o&&s?"_fb":"")},o||[],o&&n._===1?64:-2);return i&&i._c&&(i._d=!0),c}function q_(n){return n.some(e=>Xo(e)?!(e.type===as||e.type===Me&&!q_(e.children)):!0)?n:null}const Yu=n=>n?ly(n)?Sc(n):Yu(n.parent):null,xo=Ft(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Yu(n.parent),$root:n=>Yu(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>G_(n),$forceUpdate:n=>n.f||(n.f=()=>{sd(n.update)}),$nextTick:n=>n.n||(n.n=N_.bind(n.proxy)),$watch:n=>Sw.bind(n)}),Eu=(n,e)=>n!==Qe&&!n.__isScriptSetup&&Ue(n,e),qw={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:s,data:r,props:i,accessCache:o,type:l,appContext:c}=n;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return s[e];case 2:return r[e];case 4:return t[e];case 3:return i[e]}else{if(Eu(s,e))return o[e]=1,s[e];if(r!==Qe&&Ue(r,e))return o[e]=2,r[e];if(Ue(i,e))return o[e]=3,i[e];if(t!==Qe&&Ue(t,e))return o[e]=4,t[e];Ju&&(o[e]=0)}}const u=xo[e];let h,f;if(u)return e==="$attrs"&&Vt(n.attrs,"get",""),u(n);if((h=l.__cssModules)&&(h=h[e]))return h;if(t!==Qe&&Ue(t,e))return o[e]=4,t[e];if(f=c.config.globalProperties,Ue(f,e))return f[e]},set({_:n},e,t){const{data:s,setupState:r,ctx:i}=n;return Eu(r,e)?(r[e]=t,!0):s!==Qe&&Ue(s,e)?(s[e]=t,!0):Ue(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:s,appContext:r,props:i,type:o}},l){let c;return!!(t[l]||n!==Qe&&l[0]!=="$"&&Ue(n,l)||Eu(e,l)||Ue(i,l)||Ue(s,l)||Ue(xo,l)||Ue(r.config.globalProperties,l)||(c=o.__cssModules)&&c[l])},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:Ue(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function gp(n){return ve(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Ju=!0;function Kw(n){const e=G_(n),t=n.proxy,s=n.ctx;Ju=!1,e.beforeCreate&&_p(e.beforeCreate,n,"bc");const{data:r,computed:i,methods:o,watch:l,provide:c,inject:u,created:h,beforeMount:f,mounted:m,beforeUpdate:_,updated:R,activated:x,deactivated:O,beforeDestroy:$,beforeUnmount:U,destroyed:D,unmounted:P,render:j,renderTracked:Y,renderTriggered:I,errorCaptured:v,serverPrefetch:w,expose:S,inheritAttrs:A,components:C,directives:T,filters:ue}=e;if(u&&Gw(u,s,null),o)for(const Oe in o){const Re=o[Oe];we(Re)&&(s[Oe]=Re.bind(t))}if(r){const Oe=r.call(t,t);Je(Oe)&&(n.data=Ic(Oe))}if(Ju=!0,i)for(const Oe in i){const Re=i[Oe],Tt=we(Re)?Re.bind(t,t):we(Re.get)?Re.get.bind(t,t):Mn,an=!we(Re)&&we(Re.set)?Re.set.bind(t):Mn,Ut=pe({get:Tt,set:an});Object.defineProperty(s,Oe,{enumerable:!0,configurable:!0,get:()=>Ut.value,set:ft=>Ut.value=ft})}if(l)for(const Oe in l)K_(l[Oe],s,t,Oe);if(c){const Oe=we(c)?c.call(t):c;Reflect.ownKeys(Oe).forEach(Re=>{ll(Re,Oe[Re])})}h&&_p(h,n,"c");function Ve(Oe,Re){ve(Re)?Re.forEach(Tt=>Oe(Tt.bind(t))):Re&&Oe(Re.bind(t))}if(Ve(Vw,f),Ve(od,m),Ve(xw,_),Ve(Ow,R),Ve(kw,x),Ve(Nw,O),Ve(Uw,v),Ve(Fw,Y),Ve(Lw,I),Ve($_,U),Ve(j_,P),Ve(Mw,w),ve(S))if(S.length){const Oe=n.exposed||(n.exposed={});S.forEach(Re=>{Object.defineProperty(Oe,Re,{get:()=>t[Re],set:Tt=>t[Re]=Tt,enumerable:!0})})}else n.exposed||(n.exposed={});j&&n.render===Mn&&(n.render=j),A!=null&&(n.inheritAttrs=A),C&&(n.components=C),T&&(n.directives=T),w&&F_(n)}function Gw(n,e,t=Mn){ve(n)&&(n=Xu(n));for(const s in n){const r=n[s];let i;Je(r)?"default"in r?i=In(r.from||s,r.default,!0):i=In(r.from||s):i=In(r),Ot(i)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[s]=i}}function _p(n,e,t){jn(ve(n)?n.map(s=>s.bind(e.proxy)):n.bind(e.proxy),e,t)}function K_(n,e,t,s){let r=s.includes(".")?M_(t,s):()=>t[s];if(ht(n)){const i=e[n];we(i)&&Ln(r,i)}else if(we(n))Ln(r,n.bind(t));else if(Je(n))if(ve(n))n.forEach(i=>K_(i,e,t,s));else{const i=we(n.handler)?n.handler.bind(t):e[n.handler];we(i)&&Ln(r,i,n)}}function G_(n){const e=n.type,{mixins:t,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,l=i.get(e);let c;return l?c=l:!r.length&&!t&&!s?c=e:(c={},r.length&&r.forEach(u=>Ol(c,u,o,!0)),Ol(c,e,o)),Je(e)&&i.set(e,c),c}function Ol(n,e,t,s=!1){const{mixins:r,extends:i}=e;i&&Ol(n,i,t,!0),r&&r.forEach(o=>Ol(n,o,t,!0));for(const o in e)if(!(s&&o==="expose")){const l=zw[o]||t&&t[o];n[o]=l?l(n[o],e[o]):e[o]}return n}const zw={data:yp,props:vp,emits:vp,methods:wo,computed:wo,beforeCreate:$t,created:$t,beforeMount:$t,mounted:$t,beforeUpdate:$t,updated:$t,beforeDestroy:$t,beforeUnmount:$t,destroyed:$t,unmounted:$t,activated:$t,deactivated:$t,errorCaptured:$t,serverPrefetch:$t,components:wo,directives:wo,watch:Ww,provide:yp,inject:Hw};function yp(n,e){return e?n?function(){return Ft(we(n)?n.call(this,this):n,we(e)?e.call(this,this):e)}:e:n}function Hw(n,e){return wo(Xu(n),Xu(e))}function Xu(n){if(ve(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function $t(n,e){return n?[...new Set([].concat(n,e))]:e}function wo(n,e){return n?Ft(Object.create(null),n,e):e}function vp(n,e){return n?ve(n)&&ve(e)?[...new Set([...n,...e])]:Ft(Object.create(null),gp(n),gp(e??{})):e}function Ww(n,e){if(!n)return e;if(!e)return n;const t=Ft(Object.create(null),n);for(const s in e)t[s]=$t(n[s],e[s]);return t}function z_(){return{app:null,config:{isNativeTag:r_,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Qw=0;function Yw(n,e){return function(s,r=null){we(s)||(s=Ft({},s)),r!=null&&!Je(r)&&(r=null);const i=z_(),o=new WeakSet,l=[];let c=!1;const u=i.app={_uid:Qw++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:Cb,get config(){return i.config},set config(h){},use(h,...f){return o.has(h)||(h&&we(h.install)?(o.add(h),h.install(u,...f)):we(h)&&(o.add(h),h(u,...f))),u},mixin(h){return i.mixins.includes(h)||i.mixins.push(h),u},component(h,f){return f?(i.components[h]=f,u):i.components[h]},directive(h,f){return f?(i.directives[h]=f,u):i.directives[h]},mount(h,f,m){if(!c){const _=u._ceVNode||$e(s,r);return _.appContext=i,m===!0?m="svg":m===!1&&(m=void 0),n(_,h,m),c=!0,u._container=h,h.__vue_app__=u,Sc(_.component)}},onUnmount(h){l.push(h)},unmount(){c&&(jn(l,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(h,f){return i.provides[h]=f,u},runWithContext(h){const f=ui;ui=u;try{return h()}finally{ui=f}}};return u}}let ui=null;const Jw=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${fn(e)}Modifiers`]||n[`${Lr(e)}Modifiers`];function Xw(n,e,...t){if(n.isUnmounted)return;const s=n.vnode.props||Qe;let r=t;const i=e.startsWith("update:"),o=i&&Jw(s,e.slice(7));o&&(o.trim&&(r=t.map(h=>ht(h)?h.trim():h)),o.number&&(r=t.map(Qh)));let l,c=s[l=mu(e)]||s[l=mu(fn(e))];!c&&i&&(c=s[l=mu(Lr(e))]),c&&jn(c,n,6,r);const u=s[l+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[l])return;n.emitted[l]=!0,jn(u,n,6,r)}}const Zw=new WeakMap;function H_(n,e,t=!1){const s=t?Zw:e.emitsCache,r=s.get(n);if(r!==void 0)return r;const i=n.emits;let o={},l=!1;if(!we(n)){const c=u=>{const h=H_(u,e,!0);h&&(l=!0,Ft(o,h))};!t&&e.mixins.length&&e.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}return!i&&!l?(Je(n)&&s.set(n,null),null):(ve(i)?i.forEach(c=>o[c]=null):Ft(o,i),Je(n)&&s.set(n,o),o)}function bc(n,e){return!n||!pc(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ue(n,e[0].toLowerCase()+e.slice(1))||Ue(n,Lr(e))||Ue(n,e))}function Ep(n){const{type:e,vnode:t,proxy:s,withProxy:r,propsOptions:[i],slots:o,attrs:l,emit:c,render:u,renderCache:h,props:f,data:m,setupState:_,ctx:R,inheritAttrs:x}=n,O=Vl(n);let $,U;try{if(t.shapeFlag&4){const P=r||s,j=P;$=Vn(u.call(j,P,h,f,_,m,R)),U=l}else{const P=e;$=Vn(P.length>1?P(f,{attrs:l,slots:o,emit:c}):P(f,null)),U=e.props?l:eb(l)}}catch(P){Oo.length=0,Tc(P,n,1),$=$e(as)}let D=$;if(U&&x!==!1){const P=Object.keys(U),{shapeFlag:j}=D;P.length&&j&7&&(i&&P.some(zh)&&(U=tb(U,i)),D=Ei(D,U,!1,!0))}return t.dirs&&(D=Ei(D,null,!1,!0),D.dirs=D.dirs?D.dirs.concat(t.dirs):t.dirs),t.transition&&id(D,t.transition),$=D,Vl(O),$}const eb=n=>{let e;for(const t in n)(t==="class"||t==="style"||pc(t))&&((e||(e={}))[t]=n[t]);return e},tb=(n,e)=>{const t={};for(const s in n)(!zh(s)||!(s.slice(9)in e))&&(t[s]=n[s]);return t};function nb(n,e,t){const{props:s,children:r,component:i}=n,{props:o,children:l,patchFlag:c}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&c>=0){if(c&1024)return!0;if(c&16)return s?Ip(s,o,u):!!o;if(c&8){const h=e.dynamicProps;for(let f=0;f<h.length;f++){const m=h[f];if(o[m]!==s[m]&&!bc(u,m))return!0}}}else return(r||l)&&(!l||!l.$stable)?!0:s===o?!1:s?o?Ip(s,o,u):!0:!!o;return!1}function Ip(n,e,t){const s=Object.keys(e);if(s.length!==Object.keys(n).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==n[i]&&!bc(t,i))return!0}return!1}function sb({vnode:n,parent:e},t){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===n&&(s.el=n.el),s===n)(n=e.vnode).el=t,e=e.parent;else break}}const W_={},Q_=()=>Object.create(W_),Y_=n=>Object.getPrototypeOf(n)===W_;function rb(n,e,t,s=!1){const r={},i=Q_();n.propsDefaults=Object.create(null),J_(n,e,r,i);for(const o in n.propsOptions[0])o in r||(r[o]=void 0);t?n.props=s?r:R_(r):n.type.props?n.props=r:n.props=i,n.attrs=i}function ib(n,e,t,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=n,l=Fe(r),[c]=n.propsOptions;let u=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=n.vnode.dynamicProps;for(let f=0;f<h.length;f++){let m=h[f];if(bc(n.emitsOptions,m))continue;const _=e[m];if(c)if(Ue(i,m))_!==i[m]&&(i[m]=_,u=!0);else{const R=fn(m);r[R]=Zu(c,l,R,_,n,!1)}else _!==i[m]&&(i[m]=_,u=!0)}}}else{J_(n,e,r,i)&&(u=!0);let h;for(const f in l)(!e||!Ue(e,f)&&((h=Lr(f))===f||!Ue(e,h)))&&(c?t&&(t[f]!==void 0||t[h]!==void 0)&&(r[f]=Zu(c,l,f,void 0,n,!0)):delete r[f]);if(i!==l)for(const f in i)(!e||!Ue(e,f))&&(delete i[f],u=!0)}u&&Qn(n.attrs,"set","")}function J_(n,e,t,s){const[r,i]=n.propsOptions;let o=!1,l;if(e)for(let c in e){if(Co(c))continue;const u=e[c];let h;r&&Ue(r,h=fn(c))?!i||!i.includes(h)?t[h]=u:(l||(l={}))[h]=u:bc(n.emitsOptions,c)||(!(c in s)||u!==s[c])&&(s[c]=u,o=!0)}if(i){const c=Fe(t),u=l||Qe;for(let h=0;h<i.length;h++){const f=i[h];t[f]=Zu(r,c,f,u[f],n,!Ue(u,f))}}return o}function Zu(n,e,t,s,r,i){const o=n[t];if(o!=null){const l=Ue(o,"default");if(l&&s===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&we(c)){const{propsDefaults:u}=r;if(t in u)s=u[t];else{const h=Ia(r);s=u[t]=c.call(null,e),h()}}else s=c;r.ce&&r.ce._setProp(t,s)}o[0]&&(i&&!l?s=!1:o[1]&&(s===""||s===Lr(t))&&(s=!0))}return s}const ob=new WeakMap;function X_(n,e,t=!1){const s=t?ob:e.propsCache,r=s.get(n);if(r)return r;const i=n.props,o={},l=[];let c=!1;if(!we(n)){const h=f=>{c=!0;const[m,_]=X_(f,e,!0);Ft(o,m),_&&l.push(..._)};!t&&e.mixins.length&&e.mixins.forEach(h),n.extends&&h(n.extends),n.mixins&&n.mixins.forEach(h)}if(!i&&!c)return Je(n)&&s.set(n,oi),oi;if(ve(i))for(let h=0;h<i.length;h++){const f=fn(i[h]);Tp(f)&&(o[f]=Qe)}else if(i)for(const h in i){const f=fn(h);if(Tp(f)){const m=i[h],_=o[f]=ve(m)||we(m)?{type:m}:Ft({},m),R=_.type;let x=!1,O=!0;if(ve(R))for(let $=0;$<R.length;++$){const U=R[$],D=we(U)&&U.name;if(D==="Boolean"){x=!0;break}else D==="String"&&(O=!1)}else x=we(R)&&R.name==="Boolean";_[0]=x,_[1]=O,(x||Ue(_,"default"))&&l.push(f)}}const u=[o,l];return Je(n)&&s.set(n,u),u}function Tp(n){return n[0]!=="$"&&!Co(n)}const ad=n=>n==="_"||n==="_ctx"||n==="$stable",ld=n=>ve(n)?n.map(Vn):[Vn(n)],ab=(n,e,t)=>{if(e._n)return e;const s=mn((...r)=>ld(e(...r)),t);return s._c=!1,s},Z_=(n,e,t)=>{const s=n._ctx;for(const r in n){if(ad(r))continue;const i=n[r];if(we(i))e[r]=ab(r,i,s);else if(i!=null){const o=ld(i);e[r]=()=>o}}},ey=(n,e)=>{const t=ld(e);n.slots.default=()=>t},ty=(n,e,t)=>{for(const s in e)(t||!ad(s))&&(n[s]=e[s])},lb=(n,e,t)=>{const s=n.slots=Q_();if(n.vnode.shapeFlag&32){const r=e._;r?(ty(s,e,t),t&&l_(s,"_",r,!0)):Z_(e,s)}else e&&ey(n,e)},cb=(n,e,t)=>{const{vnode:s,slots:r}=n;let i=!0,o=Qe;if(s.shapeFlag&32){const l=e._;l?t&&l===1?i=!1:ty(r,e,t):(i=!e.$stable,Z_(e,r)),o=e}else e&&(ey(n,e),o={default:1});if(i)for(const l in r)!ad(l)&&o[l]==null&&delete r[l]},en=pb;function ub(n){return hb(n)}function hb(n,e){const t=yc();t.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:l,createComment:c,setText:u,setElementText:h,parentNode:f,nextSibling:m,setScopeId:_=Mn,insertStaticContent:R}=n,x=(E,b,k,L=null,K=null,F=null,ee=void 0,H=null,z=!!b.dynamicChildren)=>{if(E===b)return;E&&!fo(E,b)&&(L=B(E),ft(E,K,F,!0),E=null),b.patchFlag===-2&&(z=!1,b.dynamicChildren=null);const{type:G,ref:ge,shapeFlag:re}=b;switch(G){case Ac:O(E,b,k,L);break;case as:$(E,b,k,L);break;case cl:E==null&&U(b,k,L,ee);break;case Me:C(E,b,k,L,K,F,ee,H,z);break;default:re&1?j(E,b,k,L,K,F,ee,H,z):re&6?T(E,b,k,L,K,F,ee,H,z):(re&64||re&128)&&G.process(E,b,k,L,K,F,ee,H,z,de)}ge!=null&&K?Vo(ge,E&&E.ref,F,b||E,!b):ge==null&&E&&E.ref!=null&&Vo(E.ref,null,F,E,!0)},O=(E,b,k,L)=>{if(E==null)s(b.el=l(b.children),k,L);else{const K=b.el=E.el;b.children!==E.children&&u(K,b.children)}},$=(E,b,k,L)=>{E==null?s(b.el=c(b.children||""),k,L):b.el=E.el},U=(E,b,k,L)=>{[E.el,E.anchor]=R(E.children,b,k,L,E.el,E.anchor)},D=({el:E,anchor:b},k,L)=>{let K;for(;E&&E!==b;)K=m(E),s(E,k,L),E=K;s(b,k,L)},P=({el:E,anchor:b})=>{let k;for(;E&&E!==b;)k=m(E),r(E),E=k;r(b)},j=(E,b,k,L,K,F,ee,H,z)=>{if(b.type==="svg"?ee="svg":b.type==="math"&&(ee="mathml"),E==null)Y(b,k,L,K,F,ee,H,z);else{const G=E.el&&E.el._isVueCE?E.el:null;try{G&&G._beginPatch(),w(E,b,K,F,ee,H,z)}finally{G&&G._endPatch()}}},Y=(E,b,k,L,K,F,ee,H)=>{let z,G;const{props:ge,shapeFlag:re,transition:fe,dirs:ye}=E;if(z=E.el=o(E.type,F,ge&&ge.is,ge),re&8?h(z,E.children):re&16&&v(E.children,z,null,L,K,Iu(E,F),ee,H),ye&&sr(E,null,L,"created"),I(z,E,E.scopeId,ee,L),ge){for(const je in ge)je!=="value"&&!Co(je)&&i(z,je,null,ge[je],F,L);"value"in ge&&i(z,"value",null,ge.value,F),(G=ge.onVnodeBeforeMount)&&kn(G,L,E)}ye&&sr(E,null,L,"beforeMount");const Pe=db(K,fe);Pe&&fe.beforeEnter(z),s(z,b,k),((G=ge&&ge.onVnodeMounted)||Pe||ye)&&en(()=>{G&&kn(G,L,E),Pe&&fe.enter(z),ye&&sr(E,null,L,"mounted")},K)},I=(E,b,k,L,K)=>{if(k&&_(E,k),L)for(let F=0;F<L.length;F++)_(E,L[F]);if(K){let F=K.subTree;if(b===F||iy(F.type)&&(F.ssContent===b||F.ssFallback===b)){const ee=K.vnode;I(E,ee,ee.scopeId,ee.slotScopeIds,K.parent)}}},v=(E,b,k,L,K,F,ee,H,z=0)=>{for(let G=z;G<E.length;G++){const ge=E[G]=H?Cs(E[G]):Vn(E[G]);x(null,ge,b,k,L,K,F,ee,H)}},w=(E,b,k,L,K,F,ee)=>{const H=b.el=E.el;let{patchFlag:z,dynamicChildren:G,dirs:ge}=b;z|=E.patchFlag&16;const re=E.props||Qe,fe=b.props||Qe;let ye;if(k&&rr(k,!1),(ye=fe.onVnodeBeforeUpdate)&&kn(ye,k,b,E),ge&&sr(b,E,k,"beforeUpdate"),k&&rr(k,!0),(re.innerHTML&&fe.innerHTML==null||re.textContent&&fe.textContent==null)&&h(H,""),G?S(E.dynamicChildren,G,H,k,L,Iu(b,K),F):ee||Re(E,b,H,null,k,L,Iu(b,K),F,!1),z>0){if(z&16)A(H,re,fe,k,K);else if(z&2&&re.class!==fe.class&&i(H,"class",null,fe.class,K),z&4&&i(H,"style",re.style,fe.style,K),z&8){const Pe=b.dynamicProps;for(let je=0;je<Pe.length;je++){const xe=Pe[je],Pt=re[xe],Ct=fe[xe];(Ct!==Pt||xe==="value")&&i(H,xe,Pt,Ct,K,k)}}z&1&&E.children!==b.children&&h(H,b.children)}else!ee&&G==null&&A(H,re,fe,k,K);((ye=fe.onVnodeUpdated)||ge)&&en(()=>{ye&&kn(ye,k,b,E),ge&&sr(b,E,k,"updated")},L)},S=(E,b,k,L,K,F,ee)=>{for(let H=0;H<b.length;H++){const z=E[H],G=b[H],ge=z.el&&(z.type===Me||!fo(z,G)||z.shapeFlag&198)?f(z.el):k;x(z,G,ge,null,L,K,F,ee,!0)}},A=(E,b,k,L,K)=>{if(b!==k){if(b!==Qe)for(const F in b)!Co(F)&&!(F in k)&&i(E,F,b[F],null,K,L);for(const F in k){if(Co(F))continue;const ee=k[F],H=b[F];ee!==H&&F!=="value"&&i(E,F,H,ee,K,L)}"value"in k&&i(E,"value",b.value,k.value,K)}},C=(E,b,k,L,K,F,ee,H,z)=>{const G=b.el=E?E.el:l(""),ge=b.anchor=E?E.anchor:l("");let{patchFlag:re,dynamicChildren:fe,slotScopeIds:ye}=b;ye&&(H=H?H.concat(ye):ye),E==null?(s(G,k,L),s(ge,k,L),v(b.children||[],k,ge,K,F,ee,H,z)):re>0&&re&64&&fe&&E.dynamicChildren&&E.dynamicChildren.length===fe.length?(S(E.dynamicChildren,fe,k,K,F,ee,H),(b.key!=null||K&&b===K.subTree)&&ny(E,b,!0)):Re(E,b,k,ge,K,F,ee,H,z)},T=(E,b,k,L,K,F,ee,H,z)=>{b.slotScopeIds=H,E==null?b.shapeFlag&512?K.ctx.activate(b,k,L,ee,z):ue(b,k,L,K,F,ee,z):oe(E,b,z)},ue=(E,b,k,L,K,F,ee)=>{const H=E.component=Ib(E,L,K);if(U_(E)&&(H.ctx.renderer=de),wb(H,!1,ee),H.asyncDep){if(K&&K.registerDep(H,Ve,ee),!E.el){const z=H.subTree=$e(as);$(null,z,b,k),E.placeholder=z.el}}else Ve(H,E,b,k,K,F,ee)},oe=(E,b,k)=>{const L=b.component=E.component;if(nb(E,b,k))if(L.asyncDep&&!L.asyncResolved){Oe(L,b,k);return}else L.next=b,L.update();else b.el=E.el,L.vnode=b},Ve=(E,b,k,L,K,F,ee)=>{const H=()=>{if(E.isMounted){let{next:re,bu:fe,u:ye,parent:Pe,vnode:je}=E;{const Xt=sy(E);if(Xt){re&&(re.el=je.el,Oe(E,re,ee)),Xt.asyncDep.then(()=>{E.isUnmounted||H()});return}}let xe=re,Pt;rr(E,!1),re?(re.el=je.el,Oe(E,re,ee)):re=je,fe&&al(fe),(Pt=re.props&&re.props.onVnodeBeforeUpdate)&&kn(Pt,Pe,re,je),rr(E,!0);const Ct=Ep(E),Jt=E.subTree;E.subTree=Ct,x(Jt,Ct,f(Jt.el),B(Jt),E,K,F),re.el=Ct.el,xe===null&&sb(E,Ct.el),ye&&en(ye,K),(Pt=re.props&&re.props.onVnodeUpdated)&&en(()=>kn(Pt,Pe,re,je),K)}else{let re;const{el:fe,props:ye}=b,{bm:Pe,m:je,parent:xe,root:Pt,type:Ct}=E,Jt=ci(b);rr(E,!1),Pe&&al(Pe),!Jt&&(re=ye&&ye.onVnodeBeforeMount)&&kn(re,xe,b),rr(E,!0);{Pt.ce&&Pt.ce._def.shadowRoot!==!1&&Pt.ce._injectChildStyle(Ct);const Xt=E.subTree=Ep(E);x(null,Xt,k,L,E,K,F),b.el=Xt.el}if(je&&en(je,K),!Jt&&(re=ye&&ye.onVnodeMounted)){const Xt=b;en(()=>kn(re,xe,Xt),K)}(b.shapeFlag&256||xe&&ci(xe.vnode)&&xe.vnode.shapeFlag&256)&&E.a&&en(E.a,K),E.isMounted=!0,b=k=L=null}};E.scope.on();const z=E.effect=new f_(H);E.scope.off();const G=E.update=z.run.bind(z),ge=E.job=z.runIfDirty.bind(z);ge.i=E,ge.id=E.uid,z.scheduler=()=>sd(ge),rr(E,!0),G()},Oe=(E,b,k)=>{b.component=E;const L=E.vnode.props;E.vnode=b,E.next=null,ib(E,b.props,L,k),cb(E,b.children,k),rs(),dp(E),is()},Re=(E,b,k,L,K,F,ee,H,z=!1)=>{const G=E&&E.children,ge=E?E.shapeFlag:0,re=b.children,{patchFlag:fe,shapeFlag:ye}=b;if(fe>0){if(fe&128){an(G,re,k,L,K,F,ee,H,z);return}else if(fe&256){Tt(G,re,k,L,K,F,ee,H,z);return}}ye&8?(ge&16&&Ge(G,K,F),re!==G&&h(k,re)):ge&16?ye&16?an(G,re,k,L,K,F,ee,H,z):Ge(G,K,F,!0):(ge&8&&h(k,""),ye&16&&v(re,k,L,K,F,ee,H,z))},Tt=(E,b,k,L,K,F,ee,H,z)=>{E=E||oi,b=b||oi;const G=E.length,ge=b.length,re=Math.min(G,ge);let fe;for(fe=0;fe<re;fe++){const ye=b[fe]=z?Cs(b[fe]):Vn(b[fe]);x(E[fe],ye,k,null,K,F,ee,H,z)}G>ge?Ge(E,K,F,!0,!1,re):v(b,k,L,K,F,ee,H,z,re)},an=(E,b,k,L,K,F,ee,H,z)=>{let G=0;const ge=b.length;let re=E.length-1,fe=ge-1;for(;G<=re&&G<=fe;){const ye=E[G],Pe=b[G]=z?Cs(b[G]):Vn(b[G]);if(fo(ye,Pe))x(ye,Pe,k,null,K,F,ee,H,z);else break;G++}for(;G<=re&&G<=fe;){const ye=E[re],Pe=b[fe]=z?Cs(b[fe]):Vn(b[fe]);if(fo(ye,Pe))x(ye,Pe,k,null,K,F,ee,H,z);else break;re--,fe--}if(G>re){if(G<=fe){const ye=fe+1,Pe=ye<ge?b[ye].el:L;for(;G<=fe;)x(null,b[G]=z?Cs(b[G]):Vn(b[G]),k,Pe,K,F,ee,H,z),G++}}else if(G>fe)for(;G<=re;)ft(E[G],K,F,!0),G++;else{const ye=G,Pe=G,je=new Map;for(G=Pe;G<=fe;G++){const wt=b[G]=z?Cs(b[G]):Vn(b[G]);wt.key!=null&&je.set(wt.key,G)}let xe,Pt=0;const Ct=fe-Pe+1;let Jt=!1,Xt=0;const pn=new Array(Ct);for(G=0;G<Ct;G++)pn[G]=0;for(G=ye;G<=re;G++){const wt=E[G];if(Pt>=Ct){ft(wt,K,F,!0);continue}let vt;if(wt.key!=null)vt=je.get(wt.key);else for(xe=Pe;xe<=fe;xe++)if(pn[xe-Pe]===0&&fo(wt,b[xe])){vt=xe;break}vt===void 0?ft(wt,K,F,!0):(pn[vt-Pe]=G+1,vt>=Xt?Xt=vt:Jt=!0,x(wt,b[vt],k,null,K,F,ee,H,z),Pt++)}const jr=Jt?fb(pn):oi;for(xe=jr.length-1,G=Ct-1;G>=0;G--){const wt=Pe+G,vt=b[wt],Qi=b[wt+1],Xs=wt+1<ge?Qi.el||ry(Qi):L;pn[G]===0?x(null,vt,k,Xs,K,F,ee,H,z):Jt&&(xe<0||G!==jr[xe]?Ut(vt,k,Xs,2):xe--)}}},Ut=(E,b,k,L,K=null)=>{const{el:F,type:ee,transition:H,children:z,shapeFlag:G}=E;if(G&6){Ut(E.component.subTree,b,k,L);return}if(G&128){E.suspense.move(b,k,L);return}if(G&64){ee.move(E,b,k,de);return}if(ee===Me){s(F,b,k);for(let re=0;re<z.length;re++)Ut(z[re],b,k,L);s(E.anchor,b,k);return}if(ee===cl){D(E,b,k);return}if(L!==2&&G&1&&H)if(L===0)H.beforeEnter(F),s(F,b,k),en(()=>H.enter(F),K);else{const{leave:re,delayLeave:fe,afterLeave:ye}=H,Pe=()=>{E.ctx.isUnmounted?r(F):s(F,b,k)},je=()=>{F._isLeaving&&F[Cw](!0),re(F,()=>{Pe(),ye&&ye()})};fe?fe(F,Pe,je):je()}else s(F,b,k)},ft=(E,b,k,L=!1,K=!1)=>{const{type:F,props:ee,ref:H,children:z,dynamicChildren:G,shapeFlag:ge,patchFlag:re,dirs:fe,cacheIndex:ye}=E;if(re===-2&&(K=!1),H!=null&&(rs(),Vo(H,null,k,E,!0),is()),ye!=null&&(b.renderCache[ye]=void 0),ge&256){b.ctx.deactivate(E);return}const Pe=ge&1&&fe,je=!ci(E);let xe;if(je&&(xe=ee&&ee.onVnodeBeforeUnmount)&&kn(xe,b,E),ge&6)se(E.component,k,L);else{if(ge&128){E.suspense.unmount(k,L);return}Pe&&sr(E,null,b,"beforeUnmount"),ge&64?E.type.remove(E,b,k,de,L):G&&!G.hasOnce&&(F!==Me||re>0&&re&64)?Ge(G,b,k,!1,!0):(F===Me&&re&384||!K&&ge&16)&&Ge(z,b,k),L&&ie(E)}(je&&(xe=ee&&ee.onVnodeUnmounted)||Pe)&&en(()=>{xe&&kn(xe,b,E),Pe&&sr(E,null,b,"unmounted")},k)},ie=E=>{const{type:b,el:k,anchor:L,transition:K}=E;if(b===Me){Z(k,L);return}if(b===cl){P(E);return}const F=()=>{r(k),K&&!K.persisted&&K.afterLeave&&K.afterLeave()};if(E.shapeFlag&1&&K&&!K.persisted){const{leave:ee,delayLeave:H}=K,z=()=>ee(k,F);H?H(E.el,F,z):z()}else F()},Z=(E,b)=>{let k;for(;E!==b;)k=m(E),r(E),E=k;r(b)},se=(E,b,k)=>{const{bum:L,scope:K,job:F,subTree:ee,um:H,m:z,a:G}=E;wp(z),wp(G),L&&al(L),K.stop(),F&&(F.flags|=8,ft(ee,E,b,k)),H&&en(H,b),en(()=>{E.isUnmounted=!0},b)},Ge=(E,b,k,L=!1,K=!1,F=0)=>{for(let ee=F;ee<E.length;ee++)ft(E[ee],b,k,L,K)},B=E=>{if(E.shapeFlag&6)return B(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const b=m(E.anchor||E.el),k=b&&b[Rw];return k?m(k):b};let le=!1;const te=(E,b,k)=>{let L;E==null?b._vnode&&(ft(b._vnode,null,null,!0),L=b._vnode.component):x(b._vnode||null,E,b,null,null,null,k),b._vnode=E,le||(le=!0,dp(L),V_(),le=!1)},de={p:x,um:ft,m:Ut,r:ie,mt:ue,mc:v,pc:Re,pbc:S,n:B,o:n};return{render:te,hydrate:void 0,createApp:Yw(te)}}function Iu({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function rr({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function db(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function ny(n,e,t=!1){const s=n.children,r=e.children;if(ve(s)&&ve(r))for(let i=0;i<s.length;i++){const o=s[i];let l=r[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=r[i]=Cs(r[i]),l.el=o.el),!t&&l.patchFlag!==-2&&ny(o,l)),l.type===Ac&&(l.patchFlag!==-1?l.el=o.el:l.__elIndex=i+(n.type===Me?1:0)),l.type===as&&!l.el&&(l.el=o.el)}}function fb(n){const e=n.slice(),t=[0];let s,r,i,o,l;const c=n.length;for(s=0;s<c;s++){const u=n[s];if(u!==0){if(r=t[t.length-1],n[r]<u){e[s]=r,t.push(s);continue}for(i=0,o=t.length-1;i<o;)l=i+o>>1,n[t[l]]<u?i=l+1:o=l;u<n[t[i]]&&(i>0&&(e[s]=t[i-1]),t[i]=s)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function sy(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:sy(e)}function wp(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}function ry(n){if(n.placeholder)return n.placeholder;const e=n.component;return e?ry(e.subTree):null}const iy=n=>n.__isSuspense;function pb(n,e){e&&e.pendingBranch?ve(n)?e.effects.push(...n):e.effects.push(n):ww(n)}const Me=Symbol.for("v-fgt"),Ac=Symbol.for("v-txt"),as=Symbol.for("v-cmt"),cl=Symbol.for("v-stc"),Oo=[];let nn=null;function W(n=!1){Oo.push(nn=n?null:[])}function mb(){Oo.pop(),nn=Oo[Oo.length-1]||null}let Jo=1;function Ml(n,e=!1){Jo+=n,n<0&&nn&&e&&(nn.hasOnce=!0)}function oy(n){return n.dynamicChildren=Jo>0?nn||oi:null,mb(),Jo>0&&nn&&nn.push(n),n}function J(n,e,t,s,r,i){return oy(g(n,e,t,s,r,i,!0))}function vi(n,e,t,s,r){return oy($e(n,e,t,s,r,!0))}function Xo(n){return n?n.__v_isVNode===!0:!1}function fo(n,e){return n.type===e.type&&n.key===e.key}const ay=({key:n})=>n??null,ul=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?ht(n)||Ot(n)||we(n)?{i:St,r:n,k:e,f:!!t}:n:null);function g(n,e=null,t=null,s=0,r=null,i=n===Me?0:1,o=!1,l=!1){const c={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&ay(e),ref:e&&ul(e),scopeId:O_,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:St};return l?(cd(c,t),i&128&&n.normalize(c)):t&&(c.shapeFlag|=ht(t)?8:16),Jo>0&&!o&&nn&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&nn.push(c),c}const $e=gb;function gb(n,e=null,t=null,s=0,r=null,i=!1){if((!n||n===$w)&&(n=as),Xo(n)){const l=Ei(n,e,!0);return t&&cd(l,t),Jo>0&&!i&&nn&&(l.shapeFlag&6?nn[nn.indexOf(n)]=l:nn.push(l)),l.patchFlag=-2,l}if(Pb(n)&&(n=n.__vccOpts),e){e=_b(e);let{class:l,style:c}=e;l&&!ht(l)&&(e.class=gi(l)),Je(c)&&(nd(c)&&!ve(c)&&(c=Ft({},c)),e.style=vc(c))}const o=ht(n)?1:iy(n)?128:Pw(n)?64:Je(n)?4:we(n)?2:0;return g(n,e,t,s,r,o,i,!0)}function _b(n){return n?nd(n)||Y_(n)?Ft({},n):n:null}function Ei(n,e,t=!1,s=!1){const{props:r,ref:i,patchFlag:o,children:l,transition:c}=n,u=e?yb(r||{},e):r,h={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&ay(u),ref:e&&e.ref?t&&i?ve(i)?i.concat(ul(e)):[i,ul(e)]:ul(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:l,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Me?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:c,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Ei(n.ssContent),ssFallback:n.ssFallback&&Ei(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return c&&s&&id(h,c.clone(h)),h}function At(n=" ",e=0){return $e(Ac,null,n,e)}function Tn(n,e){const t=$e(cl,null,n);return t.staticCount=e,t}function at(n="",e=!1){return e?(W(),vi(as,null,n)):$e(as,null,n)}function Vn(n){return n==null||typeof n=="boolean"?$e(as):ve(n)?$e(Me,null,n.slice()):Xo(n)?Cs(n):$e(Ac,null,String(n))}function Cs(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Ei(n)}function cd(n,e){let t=0;const{shapeFlag:s}=n;if(e==null)e=null;else if(ve(e))t=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),cd(n,r()),r._c&&(r._d=!0));return}else{t=32;const r=e._;!r&&!Y_(e)?e._ctx=St:r===3&&St&&(St.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else we(e)?(e={default:e,_ctx:St},t=32):(e=String(e),s&64?(t=16,e=[At(e)]):t=8);n.children=e,n.shapeFlag|=t}function yb(...n){const e={};for(let t=0;t<n.length;t++){const s=n[t];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=gi([e.class,s.class]));else if(r==="style")e.style=vc([e.style,s.style]);else if(pc(r)){const i=e[r],o=s[r];o&&i!==o&&!(ve(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function kn(n,e,t,s=null){jn(n,e,7,[t,s])}const vb=z_();let Eb=0;function Ib(n,e,t){const s=n.type,r=(e?e.appContext:n.appContext)||vb,i={uid:Eb++,vnode:n,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new zT(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:X_(s,r),emitsOptions:H_(s,r),emit:null,emitted:null,propsDefaults:Qe,inheritAttrs:s.inheritAttrs,ctx:Qe,data:Qe,props:Qe,attrs:Qe,slots:Qe,refs:Qe,setupState:Qe,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=Xw.bind(null,i),n.ce&&n.ce(i),i}let xt=null;const Tb=()=>xt||St;let Ll,eh;{const n=yc(),e=(t,s)=>{let r;return(r=n[t])||(r=n[t]=[]),r.push(s),i=>{r.length>1?r.forEach(o=>o(i)):r[0](i)}};Ll=e("__VUE_INSTANCE_SETTERS__",t=>xt=t),eh=e("__VUE_SSR_SETTERS__",t=>Zo=t)}const Ia=n=>{const e=xt;return Ll(n),n.scope.on(),()=>{n.scope.off(),Ll(e)}},bp=()=>{xt&&xt.scope.off(),Ll(null)};function ly(n){return n.vnode.shapeFlag&4}let Zo=!1;function wb(n,e=!1,t=!1){e&&eh(e);const{props:s,children:r}=n.vnode,i=ly(n);rb(n,s,i,e),lb(n,r,t||e);const o=i?bb(n,e):void 0;return e&&eh(!1),o}function bb(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,qw);const{setup:s}=t;if(s){rs();const r=n.setupContext=s.length>1?Sb(n):null,i=Ia(n),o=Ea(s,n,0,[n.props,r]),l=i_(o);if(is(),i(),(l||n.sp)&&!ci(n)&&F_(n),l){if(o.then(bp,bp),e)return o.then(c=>{Ap(n,c)}).catch(c=>{Tc(c,n,0)});n.asyncDep=o}else Ap(n,o)}else cy(n)}function Ap(n,e,t){we(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Je(e)&&(n.setupState=C_(e)),cy(n)}function cy(n,e,t){const s=n.type;n.render||(n.render=s.render||Mn);{const r=Ia(n);rs();try{Kw(n)}finally{is(),r()}}}const Ab={get(n,e){return Vt(n,"get",""),n[e]}};function Sb(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,Ab),slots:n.slots,emit:n.emit,expose:e}}function Sc(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(C_(fw(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in xo)return xo[t](n)},has(e,t){return t in e||t in xo}})):n.proxy}function Rb(n,e=!0){return we(n)?n.displayName||n.name:n.name||e&&n.__name}function Pb(n){return we(n)&&"__vccOpts"in n}const pe=(n,e)=>yw(n,e,Zo);function uy(n,e,t){try{Ml(-1);const s=arguments.length;return s===2?Je(e)&&!ve(e)?Xo(e)?$e(n,null,[e]):$e(n,e):$e(n,null,e):(s>3?t=Array.prototype.slice.call(arguments,2):s===3&&Xo(t)&&(t=[t]),$e(n,e,t))}finally{Ml(1)}}const Cb="3.5.26";let th;const Sp=typeof window<"u"&&window.trustedTypes;if(Sp)try{th=Sp.createPolicy("vue",{createHTML:n=>n})}catch{}const hy=th?n=>th.createHTML(n):n=>n,kb="http://www.w3.org/2000/svg",Nb="http://www.w3.org/1998/Math/MathML",Wn=typeof document<"u"?document:null,Rp=Wn&&Wn.createElement("template"),Db={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,s)=>{const r=e==="svg"?Wn.createElementNS(kb,n):e==="mathml"?Wn.createElementNS(Nb,n):t?Wn.createElement(n,{is:t}):Wn.createElement(n);return n==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:n=>Wn.createTextNode(n),createComment:n=>Wn.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Wn.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,s,r,i){const o=t?t.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),t),!(r===i||!(r=r.nextSibling)););else{Rp.innerHTML=hy(s==="svg"?`<svg>${n}</svg>`:s==="mathml"?`<math>${n}</math>`:n);const l=Rp.content;if(s==="svg"||s==="mathml"){const c=l.firstChild;for(;c.firstChild;)l.appendChild(c.firstChild);l.removeChild(c)}e.insertBefore(l,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Vb=Symbol("_vtc");function xb(n,e,t){const s=n[Vb];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const Pp=Symbol("_vod"),Ob=Symbol("_vsh"),Mb=Symbol(""),Lb=/(?:^|;)\s*display\s*:/;function Fb(n,e,t){const s=n.style,r=ht(t);let i=!1;if(t&&!r){if(e)if(ht(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();t[l]==null&&hl(s,l,"")}else for(const o in e)t[o]==null&&hl(s,o,"");for(const o in t)o==="display"&&(i=!0),hl(s,o,t[o])}else if(r){if(e!==t){const o=s[Mb];o&&(t+=";"+o),s.cssText=t,i=Lb.test(t)}}else e&&n.removeAttribute("style");Pp in n&&(n[Pp]=i?s.display:"",n[Ob]&&(s.display="none"))}const Cp=/\s*!important$/;function hl(n,e,t){if(ve(t))t.forEach(s=>hl(n,e,s));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const s=Ub(n,e);Cp.test(t)?n.setProperty(Lr(s),t.replace(Cp,""),"important"):n[s]=t}}const kp=["Webkit","Moz","ms"],Tu={};function Ub(n,e){const t=Tu[e];if(t)return t;let s=fn(e);if(s!=="filter"&&s in n)return Tu[e]=s;s=_c(s);for(let r=0;r<kp.length;r++){const i=kp[r]+s;if(i in n)return Tu[e]=i}return e}const Np="http://www.w3.org/1999/xlink";function Dp(n,e,t,s,r,i=KT(e)){s&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(Np,e.slice(6,e.length)):n.setAttributeNS(Np,e,t):t==null||i&&!c_(t)?n.removeAttribute(e):n.setAttribute(e,i?"":bn(t)?String(t):t)}function Vp(n,e,t,s,r){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?hy(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const l=i==="OPTION"?n.getAttribute("value")||"":n.value,c=t==null?n.type==="checkbox"?"on":"":String(t);(l!==c||!("_value"in n))&&(n.value=c),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const l=typeof n[e];l==="boolean"?t=c_(t):t==null&&l==="string"?(t="",o=!0):l==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(r||e)}function Ns(n,e,t,s){n.addEventListener(e,t,s)}function Bb(n,e,t,s){n.removeEventListener(e,t,s)}const xp=Symbol("_vei");function $b(n,e,t,s,r=null){const i=n[xp]||(n[xp]={}),o=i[e];if(s&&o)o.value=s;else{const[l,c]=jb(e);if(s){const u=i[e]=Gb(s,r);Ns(n,l,u,c)}else o&&(Bb(n,l,o,c),i[e]=void 0)}}const Op=/(?:Once|Passive|Capture)$/;function jb(n){let e;if(Op.test(n)){e={};let s;for(;s=n.match(Op);)n=n.slice(0,n.length-s[0].length),e[s[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Lr(n.slice(2)),e]}let wu=0;const qb=Promise.resolve(),Kb=()=>wu||(qb.then(()=>wu=0),wu=Date.now());function Gb(n,e){const t=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=t.attached)return;jn(zb(s,t.value),e,5,[s])};return t.value=n,t.attached=Kb(),t}function zb(n,e){if(ve(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const Mp=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,Hb=(n,e,t,s,r,i)=>{const o=r==="svg";e==="class"?xb(n,s,o):e==="style"?Fb(n,t,s):pc(e)?zh(e)||$b(n,e,t,s,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Wb(n,e,s,o))?(Vp(n,e,s),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Dp(n,e,s,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!ht(s))?Vp(n,fn(e),s,i,e):(e==="true-value"?n._trueValue=s:e==="false-value"&&(n._falseValue=s),Dp(n,e,s,o))};function Wb(n,e,t,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in n&&Mp(e)&&we(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&n.tagName==="IFRAME"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=n.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Mp(e)&&ht(t)?!1:e in n}const Ii=n=>{const e=n.props["onUpdate:modelValue"]||!1;return ve(e)?t=>al(e,t):e};function Qb(n){n.target.composing=!0}function Lp(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ts=Symbol("_assign");function Fp(n,e,t){return e&&(n=n.trim()),t&&(n=Qh(n)),n}const Yb={created(n,{modifiers:{lazy:e,trim:t,number:s}},r){n[ts]=Ii(r);const i=s||r.props&&r.props.type==="number";Ns(n,e?"change":"input",o=>{o.target.composing||n[ts](Fp(n.value,t,i))}),(t||i)&&Ns(n,"change",()=>{n.value=Fp(n.value,t,i)}),e||(Ns(n,"compositionstart",Qb),Ns(n,"compositionend",Lp),Ns(n,"change",Lp))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:s,trim:r,number:i}},o){if(n[ts]=Ii(o),n.composing)return;const l=(i||n.type==="number")&&!/^0\d/.test(n.value)?Qh(n.value):n.value,c=e??"";l!==c&&(document.activeElement===n&&n.type!=="range"&&(s&&e===t||r&&n.value.trim()===c)||(n.value=c))}},Jb={deep:!0,created(n,e,t){n[ts]=Ii(t),Ns(n,"change",()=>{const s=n._modelValue,r=dy(n),i=n.checked,o=n[ts];if(ve(s)){const l=u_(s,r),c=l!==-1;if(i&&!c)o(s.concat(r));else if(!i&&c){const u=[...s];u.splice(l,1),o(u)}}else if(mc(s)){const l=new Set(s);i?l.add(r):l.delete(r),o(l)}else o(fy(n,i))})},mounted:Up,beforeUpdate(n,e,t){n[ts]=Ii(t),Up(n,e,t)}};function Up(n,{value:e,oldValue:t},s){n._modelValue=e;let r;if(ve(e))r=u_(e,s.props.value)>-1;else if(mc(e))r=e.has(s.props.value);else{if(e===t)return;r=_i(e,fy(n,!0))}n.checked!==r&&(n.checked=r)}const bu={created(n,{value:e},t){n.checked=_i(e,t.props.value),n[ts]=Ii(t),Ns(n,"change",()=>{n[ts](dy(n))})},beforeUpdate(n,{value:e,oldValue:t},s){n[ts]=Ii(s),e!==t&&(n.checked=_i(e,s.props.value))}};function dy(n){return"_value"in n?n._value:n.value}function fy(n,e){const t=e?"_trueValue":"_falseValue";return t in n?n[t]:e}const Xb=["ctrl","shift","alt","meta"],Zb={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>Xb.some(t=>n[`${t}Key`]&&!e.includes(t))},py=(n,e)=>{const t=n._withMods||(n._withMods={}),s=e.join(".");return t[s]||(t[s]=((r,...i)=>{for(let o=0;o<e.length;o++){const l=Zb[e[o]];if(l&&l(r,e))return}return n(r,...i)}))},eA=Ft({patchProp:Hb},Db);let Bp;function tA(){return Bp||(Bp=ub(eA))}const nA=((...n)=>{const e=tA().createApp(...n),{mount:t}=e;return e.mount=s=>{const r=rA(s);if(!r)return;const i=e._component;!we(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=t(r,!1,sA(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e});function sA(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function rA(n){return ht(n)?document.querySelector(n):n}const nh=be(null),my=be(""),sh=be(!1);let $p=null;const Ja=n=>String(n).padStart(2,"0"),iA=()=>{const n=new Date,e=n.getTime()+n.getTimezoneOffset()*6e4;return new Date(e+540*60*1e3)},oA=n=>{if(!(n instanceof Date))return"...";const e=n.getFullYear(),t=Ja(n.getMonth()+1),s=Ja(n.getDate()),r=Ja(n.getHours()),i=Ja(n.getMinutes());return`${e}. ${t}. ${s}. ${r}:${i}`};function aA(){if($p)return;const n=()=>{nh.value=iA(),my.value=oA(nh.value),sh.value||(sh.value=!0)};n(),$p=setInterval(n,1e3)}function gy(){return{kstDate:nh,kstString:my,isKstTimeReady:sh}}const lA=()=>{};var jp={};const _y=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let r=n.charCodeAt(s);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},cA=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const r=n[t++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=n[t++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=n[t++],o=n[t++],l=n[t++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=n[t++],o=n[t++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},yy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<n.length;r+=3){const i=n[r],o=r+1<n.length,l=o?n[r+1]:0,c=r+2<n.length,u=c?n[r+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let m=(l&15)<<2|u>>6,_=u&63;c||(_=64,o||(m=64)),s.push(t[h],t[f],t[m],t[_])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(_y(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):cA(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<n.length;){const i=t[n.charAt(r++)],l=r<n.length?t[n.charAt(r)]:0;++r;const u=r<n.length?t[n.charAt(r)]:64;++r;const f=r<n.length?t[n.charAt(r)]:64;if(++r,i==null||l==null||u==null||f==null)throw new uA;const m=i<<2|l>>4;if(s.push(m),u!==64){const _=l<<4&240|u>>2;if(s.push(_),f!==64){const R=u<<6&192|f;s.push(R)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class uA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hA=function(n){const e=_y(n);return yy.encodeByteArray(e,!0)},vy=function(n){return hA(n).replace(/\./g,"")},Ey=function(n){try{return yy.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Iy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const dA=()=>Iy().__FIREBASE_DEFAULTS__,fA=()=>{if(typeof process>"u"||typeof jp>"u")return;const n=jp.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},pA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Ey(n[1]);return e&&JSON.parse(e)},Rc=()=>{try{return lA()||dA()||fA()||pA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},mA=n=>Rc()?.emulatorHosts?.[n],Ty=()=>Rc()?.config,wy=n=>Rc()?.[`_${n}`];class gA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}function $i(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function by(n){return(await fetch(n,{credentials:"include"})).ok}const Mo={};function _A(){const n={prod:[],emulator:[]};for(const e of Object.keys(Mo))Mo[e]?n.emulator.push(e):n.prod.push(e);return n}function yA(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let qp=!1;function vA(n,e){if(typeof window>"u"||typeof document>"u"||!$i(window.location.host)||Mo[n]===e||Mo[n]||qp)return;Mo[n]=e;function t(m){return`__firebase__banner__${m}`}const s="__firebase__banner",i=_A().prod.length>0;function o(){const m=document.getElementById(s);m&&m.remove()}function l(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,_){m.setAttribute("width","24"),m.setAttribute("id",_),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function u(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{qp=!0,o()},m}function h(m,_){m.setAttribute("id",_),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function f(){const m=yA(s),_=t("text"),R=document.getElementById(_)||document.createElement("span"),x=t("learnmore"),O=document.getElementById(x)||document.createElement("a"),$=t("preprendIcon"),U=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const D=m.element;l(D),h(O,x);const P=u();c(U,$),D.append(U,R,O,P),document.body.appendChild(D)}i?(R.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function _t(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function EA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_t())}function Ay(){const n=Rc()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function IA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function TA(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function wA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bA(){const n=_t();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Sy(){return!Ay()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ry(){return!Ay()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Py(){try{return typeof indexedDB=="object"}catch{return!1}}function AA(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(t){e(t)}})}const SA="FirebaseError";class fs extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=SA,Object.setPrototypeOf(this,fs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ta.prototype.create)}}class Ta{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?RA(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new fs(r,l,s)}}function RA(n,e){return n.replace(PA,(t,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const PA=/\{\$([^}]+)}/g;function CA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Sr(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const r of t){if(!s.includes(r))return!1;const i=n[r],o=e[r];if(Kp(i)&&Kp(o)){if(!Sr(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!t.includes(r))return!1;return!0}function Kp(n){return n!==null&&typeof n=="object"}function wa(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function kA(n,e){const t=new NA(n,e);return t.subscribe.bind(t)}class NA{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let r;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");DA(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:s},r.next===void 0&&(r.next=Au),r.error===void 0&&(r.error=Au),r.complete===void 0&&(r.complete=Au);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function DA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Au(){}function rn(n){return n&&n._delegate?n._delegate:n}class Rr{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ar="[DEFAULT]";class VA{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new gA;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(OA(e))try{this.getOrInitializeService({instanceIdentifier:ar})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=ar){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ar){return this.instances.has(e)}getOptions(e=ar){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);s===l&&o.resolve(r)}return r}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:xA(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ar){return this.component?this.component.multipleInstances?e:ar:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xA(n){return n===ar?void 0:n}function OA(n){return n.instantiationMode==="EAGER"}class MA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new VA(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ke||(ke={}));const LA={debug:ke.DEBUG,verbose:ke.VERBOSE,info:ke.INFO,warn:ke.WARN,error:ke.ERROR,silent:ke.SILENT},FA=ke.INFO,UA={[ke.DEBUG]:"log",[ke.VERBOSE]:"log",[ke.INFO]:"info",[ke.WARN]:"warn",[ke.ERROR]:"error"},BA=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),r=UA[e];if(r)console[r](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ud{constructor(e){this.name=e,this._logLevel=FA,this._logHandler=BA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?LA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ke.DEBUG,...e),this._logHandler(this,ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ke.VERBOSE,...e),this._logHandler(this,ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ke.INFO,...e),this._logHandler(this,ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ke.WARN,...e),this._logHandler(this,ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ke.ERROR,...e),this._logHandler(this,ke.ERROR,...e)}}const $A=(n,e)=>e.some(t=>n instanceof t);let Gp,zp;function jA(){return Gp||(Gp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qA(){return zp||(zp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Cy=new WeakMap,rh=new WeakMap,ky=new WeakMap,Su=new WeakMap,hd=new WeakMap;function KA(n){const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Fs(n.result)),r()},o=()=>{s(n.error),r()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Cy.set(t,n)}).catch(()=>{}),hd.set(e,n),e}function GA(n){if(rh.has(n))return;const e=new Promise((t,s)=>{const r=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});rh.set(n,e)}let ih={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return rh.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ky.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function zA(n){ih=n(ih)}function HA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Ru(this),e,...t);return ky.set(s,e.sort?e.sort():[e]),Fs(s)}:qA().includes(n)?function(...e){return n.apply(Ru(this),e),Fs(Cy.get(this))}:function(...e){return Fs(n.apply(Ru(this),e))}}function WA(n){return typeof n=="function"?HA(n):(n instanceof IDBTransaction&&GA(n),$A(n,jA())?new Proxy(n,ih):n)}function Fs(n){if(n instanceof IDBRequest)return KA(n);if(Su.has(n))return Su.get(n);const e=WA(n);return e!==n&&(Su.set(n,e),hd.set(e,n)),e}const Ru=n=>hd.get(n);function QA(n,e,{blocked:t,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(n,e),l=Fs(o);return s&&o.addEventListener("upgradeneeded",c=>{s(Fs(o.result),c.oldVersion,c.newVersion,Fs(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),r&&c.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const YA=["get","getKey","getAll","getAllKeys","count"],JA=["put","add","delete","clear"],Pu=new Map;function Hp(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Pu.get(e))return Pu.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,r=JA.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(r||YA.includes(t)))return;const i=async function(o,...l){const c=this.transaction(o,r?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(l.shift())),(await Promise.all([u[t](...l),r&&c.done]))[0]};return Pu.set(e,i),i}zA(n=>({...n,get:(e,t,s)=>Hp(e,t)||n.get(e,t,s),has:(e,t)=>!!Hp(e,t)||n.has(e,t)}));class XA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ZA(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function ZA(n){return n.getComponent()?.type==="VERSION"}const oh="@firebase/app",Wp="0.14.6";const ls=new ud("@firebase/app"),eS="@firebase/app-compat",tS="@firebase/analytics-compat",nS="@firebase/analytics",sS="@firebase/app-check-compat",rS="@firebase/app-check",iS="@firebase/auth",oS="@firebase/auth-compat",aS="@firebase/database",lS="@firebase/data-connect",cS="@firebase/database-compat",uS="@firebase/functions",hS="@firebase/functions-compat",dS="@firebase/installations",fS="@firebase/installations-compat",pS="@firebase/messaging",mS="@firebase/messaging-compat",gS="@firebase/performance",_S="@firebase/performance-compat",yS="@firebase/remote-config",vS="@firebase/remote-config-compat",ES="@firebase/storage",IS="@firebase/storage-compat",TS="@firebase/firestore",wS="@firebase/ai",bS="@firebase/firestore-compat",AS="firebase",SS="12.6.0";const ah="[DEFAULT]",RS={[oh]:"fire-core",[eS]:"fire-core-compat",[nS]:"fire-analytics",[tS]:"fire-analytics-compat",[rS]:"fire-app-check",[sS]:"fire-app-check-compat",[iS]:"fire-auth",[oS]:"fire-auth-compat",[aS]:"fire-rtdb",[lS]:"fire-data-connect",[cS]:"fire-rtdb-compat",[uS]:"fire-fn",[hS]:"fire-fn-compat",[dS]:"fire-iid",[fS]:"fire-iid-compat",[pS]:"fire-fcm",[mS]:"fire-fcm-compat",[gS]:"fire-perf",[_S]:"fire-perf-compat",[yS]:"fire-rc",[vS]:"fire-rc-compat",[ES]:"fire-gcs",[IS]:"fire-gcs-compat",[TS]:"fire-fst",[bS]:"fire-fst-compat",[wS]:"fire-vertex","fire-js":"fire-js",[AS]:"fire-js-all"};const Fl=new Map,PS=new Map,lh=new Map;function Qp(n,e){try{n.container.addComponent(e)}catch(t){ls.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ti(n){const e=n.name;if(lh.has(e))return ls.debug(`There were multiple attempts to register component ${e}.`),!1;lh.set(e,n);for(const t of Fl.values())Qp(t,n);for(const t of PS.values())Qp(t,n);return!0}function dd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function _n(n){return n==null?!1:n.settings!==void 0}const CS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Us=new Ta("app","Firebase",CS);class kS{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Rr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Us.create("app-deleted",{appName:this._name})}}const ji=SS;function Ny(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:ah,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw Us.create("bad-app-name",{appName:String(r)});if(t||(t=Ty()),!t)throw Us.create("no-options");const i=Fl.get(r);if(i){if(Sr(t,i.options)&&Sr(s,i.config))return i;throw Us.create("duplicate-app",{appName:r})}const o=new MA(r);for(const c of lh.values())o.addComponent(c);const l=new kS(t,s,o);return Fl.set(r,l),l}function NS(n=ah){const e=Fl.get(n);if(!e&&n===ah&&Ty())return Ny();if(!e)throw Us.create("no-app",{appName:n});return e}function Bs(n,e,t){let s=RS[n]??n;t&&(s+=`-${t}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ls.warn(o.join(" "));return}Ti(new Rr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const DS="firebase-heartbeat-database",VS=1,ea="firebase-heartbeat-store";let Cu=null;function Dy(){return Cu||(Cu=QA(DS,VS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ea)}catch(t){console.warn(t)}}}}).catch(n=>{throw Us.create("idb-open",{originalErrorMessage:n.message})})),Cu}async function xS(n){try{const t=(await Dy()).transaction(ea),s=await t.objectStore(ea).get(Vy(n));return await t.done,s}catch(e){if(e instanceof fs)ls.warn(e.message);else{const t=Us.create("idb-get",{originalErrorMessage:e?.message});ls.warn(t.message)}}}async function Yp(n,e){try{const s=(await Dy()).transaction(ea,"readwrite");await s.objectStore(ea).put(e,Vy(n)),await s.done}catch(t){if(t instanceof fs)ls.warn(t.message);else{const s=Us.create("idb-set",{originalErrorMessage:t?.message});ls.warn(s.message)}}}function Vy(n){return`${n.name}!${n.options.appId}`}const OS=1024,MS=30;class LS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new US(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Jp();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>MS){const r=BS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ls.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Jp(),{heartbeatsToSend:t,unsentEntries:s}=FS(this._heartbeatsCache.heartbeats),r=vy(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return ls.warn(e),""}}}function Jp(){return new Date().toISOString().substring(0,10)}function FS(n,e=OS){const t=[];let s=n.slice();for(const r of n){const i=t.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Xp(t)>e){i.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Xp(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class US{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Py()?AA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await xS(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Yp(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Yp(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Xp(n){return vy(JSON.stringify({version:2,heartbeats:n})).length}function BS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}function $S(n){Ti(new Rr("platform-logger",e=>new XA(e),"PRIVATE")),Ti(new Rr("heartbeat",e=>new LS(e),"PRIVATE")),Bs(oh,Wp,n),Bs(oh,Wp,"esm2020"),Bs("fire-js","")}$S("");function xy(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jS=xy,Oy=new Ta("auth","Firebase",xy());const Ul=new ud("@firebase/auth");function qS(n,...e){Ul.logLevel<=ke.WARN&&Ul.warn(`Auth (${ji}): ${n}`,...e)}function dl(n,...e){Ul.logLevel<=ke.ERROR&&Ul.error(`Auth (${ji}): ${n}`,...e)}function qn(n,...e){throw pd(n,...e)}function wn(n,...e){return pd(n,...e)}function fd(n,e,t){const s={...jS(),[e]:t};return new Ta("auth","Firebase",s).create(e,{appName:n.name})}function Er(n){return fd(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function KS(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&qn(n,"argument-error"),fd(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function pd(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return Oy.create(n,...e)}function Ee(n,e,...t){if(!n)throw pd(e,...t)}function Xn(n){const e="INTERNAL ASSERTION FAILED: "+n;throw dl(e),new Error(e)}function cs(n,e){n||Xn(e)}function ch(){return typeof self<"u"&&self.location?.href||""}function GS(){return Zp()==="http:"||Zp()==="https:"}function Zp(){return typeof self<"u"&&self.location?.protocol||null}function zS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(GS()||TA()||"connection"in navigator)?navigator.onLine:!0}function HS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class ba{constructor(e,t){this.shortDelay=e,this.longDelay=t,cs(t>e,"Short delay should be less than long delay!"),this.isMobile=EA()||wA()}get(){return zS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function md(n,e){cs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class My{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Xn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Xn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Xn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const WS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const QS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],YS=new ba(3e4,6e4);function gd(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function qi(n,e,t,s,r={}){return Ly(n,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const l=wa({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const u={method:e,headers:c,...i};return IA()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&$i(n.emulatorConfig.host)&&(u.credentials="include"),My.fetch()(await Fy(n,n.config.apiHost,t,l),u)})}async function Ly(n,e,t){n._canInitEmulator=!1;const s={...WS,...e};try{const r=new XS(n),i=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Xa(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xa(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Xa(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Xa(n,"user-disabled",o);const h=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw fd(n,h,u);qn(n,h)}}catch(r){if(r instanceof fs)throw r;qn(n,"network-request-failed",{message:String(r)})}}async function JS(n,e,t,s,r={}){const i=await qi(n,e,t,s,r);return"mfaPendingCredential"in i&&qn(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function Fy(n,e,t,s){const r=`${e}${t}?${s}`,i=n,o=i.config.emulator?md(n.config,r):`${n.config.apiScheme}://${r}`;return QS.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class XS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(wn(this.auth,"network-request-failed")),YS.get())})}}function Xa(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const r=wn(n,e,s);return r.customData._tokenResponse=t,r}async function ZS(n,e){return qi(n,"POST","/v1/accounts:delete",e)}async function Bl(n,e){return qi(n,"POST","/v1/accounts:lookup",e)}function Lo(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function eR(n,e=!1){const t=rn(n),s=await t.getIdToken(e),r=_d(s);Ee(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i?.sign_in_provider;return{claims:r,token:s,authTime:Lo(ku(r.auth_time)),issuedAtTime:Lo(ku(r.iat)),expirationTime:Lo(ku(r.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function ku(n){return Number(n)*1e3}function _d(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return dl("JWT malformed, contained fewer than 3 sections"),null;try{const r=Ey(t);return r?JSON.parse(r):(dl("Failed to decode base64 JWT payload"),null)}catch(r){return dl("Caught error parsing JWT payload as JSON",r?.toString()),null}}function em(n){const e=_d(n);return Ee(e,"internal-error"),Ee(typeof e.exp<"u","internal-error"),Ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ta(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof fs&&tR(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function tR({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class nR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class uh{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lo(this.lastLoginAt),this.creationTime=Lo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function $l(n){const e=n.auth,t=await n.getIdToken(),s=await ta(n,Bl(e,{idToken:t}));Ee(s?.users.length,e,"internal-error");const r=s.users[0];n._notifyReloadListener(r);const i=r.providerUserInfo?.length?Uy(r.providerUserInfo):[],o=rR(n.providerData,i),l=n.isAnonymous,c=!(n.email&&r.passwordHash)&&!o?.length,u=l?c:!1,h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new uh(r.createdAt,r.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function sR(n){const e=rn(n);await $l(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rR(n,e){return[...n.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function Uy(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function iR(n,e){const t=await Ly(n,{},async()=>{const s=wa({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=n.config,o=await Fy(n,r,"/v1/token",`key=${i}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:s};return n.emulatorConfig&&$i(n.emulatorConfig.host)&&(c.credentials="include"),My.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function oR(n,e){return qi(n,"POST","/v2/accounts:revokeToken",gd(n,e))}class hi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ee(e.idToken,"internal-error"),Ee(typeof e.idToken<"u","internal-error"),Ee(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):em(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ee(e.length!==0,"internal-error");const t=em(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:r,expiresIn:i}=await iR(e,t);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:r,expirationTime:i}=t,o=new hi;return s&&(Ee(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(Ee(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(Ee(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new hi,this.toJSON())}_performRefresh(){return Xn("not implemented")}}function Is(n,e){Ee(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class vn{constructor({uid:e,auth:t,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new nR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new uh(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await ta(this,this.stsTokenManager.getToken(this.auth,e));return Ee(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return eR(this,e)}reload(){return sR(this)}_assign(e){this!==e&&(Ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new vn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await $l(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_n(this.auth.app))return Promise.reject(Er(this.auth));const e=await this.getIdToken();return await ta(this,ZS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,r=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,l=t.tenantId??void 0,c=t._redirectEventId??void 0,u=t.createdAt??void 0,h=t.lastLoginAt??void 0,{uid:f,emailVerified:m,isAnonymous:_,providerData:R,stsTokenManager:x}=t;Ee(f&&x,e,"internal-error");const O=hi.fromJSON(this.name,x);Ee(typeof f=="string",e,"internal-error"),Is(s,e.name),Is(r,e.name),Ee(typeof m=="boolean",e,"internal-error"),Ee(typeof _=="boolean",e,"internal-error"),Is(i,e.name),Is(o,e.name),Is(l,e.name),Is(c,e.name),Is(u,e.name),Is(h,e.name);const $=new vn({uid:f,auth:e,email:r,emailVerified:m,displayName:s,isAnonymous:_,photoURL:o,phoneNumber:i,tenantId:l,stsTokenManager:O,createdAt:u,lastLoginAt:h});return R&&Array.isArray(R)&&($.providerData=R.map(U=>({...U}))),c&&($._redirectEventId=c),$}static async _fromIdTokenResponse(e,t,s=!1){const r=new hi;r.updateFromServerResponse(t);const i=new vn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await $l(i),i}static async _fromGetAccountInfoResponse(e,t,s){const r=t.users[0];Ee(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?Uy(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!i?.length,l=new hi;l.updateFromIdToken(s);const c=new vn({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new uh(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!i?.length};return Object.assign(c,u),c}}const tm=new Map;function Zn(n){cs(n instanceof Function,"Expected a class definition");let e=tm.get(n);return e?(cs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,tm.set(n,e),e)}class By{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}By.type="NONE";const nm=By;function fl(n,e,t){return`firebase:${n}:${e}:${t}`}class di{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=fl(this.userKey,r.apiKey,i),this.fullPersistenceKey=fl("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Bl(this.auth,{idToken:e}).catch(()=>{});return t?vn._fromGetAccountInfoResponse(this.auth,t,e):null}return vn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new di(Zn(nm),e,s);const r=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=r[0]||Zn(nm);const o=fl(s,e.config.apiKey,e.name);let l=null;for(const u of t)try{const h=await u._get(o);if(h){let f;if(typeof h=="string"){const m=await Bl(e,{idToken:h}).catch(()=>{});if(!m)break;f=await vn._fromGetAccountInfoResponse(e,m,h)}else f=vn._fromJSON(e,h);u!==i&&(l=f),i=u;break}}catch{}const c=r.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new di(i,e,s):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(t.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new di(i,e,s))}}function sm(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ky(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if($y(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(zy(e))return"Blackberry";if(Hy(e))return"Webos";if(jy(e))return"Safari";if((e.includes("chrome/")||qy(e))&&!e.includes("edge/"))return"Chrome";if(Gy(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function $y(n=_t()){return/firefox\//i.test(n)}function jy(n=_t()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function qy(n=_t()){return/crios\//i.test(n)}function Ky(n=_t()){return/iemobile/i.test(n)}function Gy(n=_t()){return/android/i.test(n)}function zy(n=_t()){return/blackberry/i.test(n)}function Hy(n=_t()){return/webos/i.test(n)}function yd(n=_t()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function aR(n=_t()){return yd(n)&&!!window.navigator?.standalone}function lR(){return bA()&&document.documentMode===10}function Wy(n=_t()){return yd(n)||Gy(n)||Hy(n)||zy(n)||/windows phone/i.test(n)||Ky(n)}function Qy(n,e=[]){let t;switch(n){case"Browser":t=sm(_t());break;case"Worker":t=`${sm(_t())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ji}/${s}`}class cR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});s.onAbort=t,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function uR(n,e={}){return qi(n,"GET","/v2/passwordPolicy",gd(n,e))}const hR=6;class dR{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??hR,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class fR{constructor(e,t,s,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rm(this),this.idTokenSubscription=new rm(this),this.beforeStateQueue=new cR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Oy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Zn(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await di.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Bl(this,{idToken:e}),s=await vn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(_n(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=s?._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===o)&&l?.user&&(s=l.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await $l(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=HS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_n(this.app))return Promise.reject(Er(this));const t=e?rn(e):null;return t&&Ee(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _n(this.app)?Promise.reject(Er(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _n(this.app)?Promise.reject(Er(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Zn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uR(this),t=new dR(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ta("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await oR(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Zn(e)||this._popupRedirectResolver;Ee(t,this,"argument-error"),this.redirectPersistenceManager=await di.create(this,[Zn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,r){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ee(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,s,r);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Qy(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(_n(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&qS(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Pc(n){return rn(n)}class rm{constructor(e){this.auth=e,this.observer=null,this.addObserver=kA(t=>this.observer=t)}get next(){return Ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let vd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pR(n){vd=n}function mR(n){return vd.loadJS(n)}function gR(){return vd.gapiScript}function _R(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function yR(n,e){const t=dd(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),i=t.getOptions();if(Sr(i,e??{}))return r;qn(r,"already-initialized")}return t.initialize({options:e})}function vR(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(Zn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function ER(n,e,t){const s=Pc(n);Ee(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=Yy(e),{host:o,port:l}=IR(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},h=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){Ee(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Ee(Sr(u,s.config.emulator)&&Sr(h,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=u,s.emulatorConfig=h,s.settings.appVerificationDisabledForTesting=!0,$i(o)?(by(`${i}//${o}${c}`),vA("Auth",!0)):TR()}function Yy(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function IR(n){const e=Yy(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:im(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:im(o)}}}function im(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function TR(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Jy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Xn("not implemented")}_getIdTokenResponse(e){return Xn("not implemented")}_linkToIdToken(e,t){return Xn("not implemented")}_getReauthenticationResolver(e){return Xn("not implemented")}}async function fi(n,e){return JS(n,"POST","/v1/accounts:signInWithIdp",gd(n,e))}const wR="http://localhost";class Pr extends Jy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Pr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...i}=t;if(!s||!r)return null;const o=new Pr(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return fi(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,fi(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,fi(e,t)}buildRequest(){const e={requestUri:wR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=wa(t)}return e}}class Ed{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Aa extends Ed{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ds extends Aa{constructor(){super("facebook.com")}static credential(e){return Pr._fromParams({providerId:Ds.PROVIDER_ID,signInMethod:Ds.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ds.credentialFromTaggedObject(e)}static credentialFromError(e){return Ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ds.credential(e.oauthAccessToken)}catch{return null}}}Ds.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ds.PROVIDER_ID="facebook.com";class Jn extends Aa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Pr._fromParams({providerId:Jn.PROVIDER_ID,signInMethod:Jn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Jn.credentialFromTaggedObject(e)}static credentialFromError(e){return Jn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Jn.credential(t,s)}catch{return null}}}Jn.GOOGLE_SIGN_IN_METHOD="google.com";Jn.PROVIDER_ID="google.com";class Vs extends Aa{constructor(){super("github.com")}static credential(e){return Pr._fromParams({providerId:Vs.PROVIDER_ID,signInMethod:Vs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vs.credentialFromTaggedObject(e)}static credentialFromError(e){return Vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vs.credential(e.oauthAccessToken)}catch{return null}}}Vs.GITHUB_SIGN_IN_METHOD="github.com";Vs.PROVIDER_ID="github.com";class xs extends Aa{constructor(){super("twitter.com")}static credential(e,t){return Pr._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return xs.credential(t,s)}catch{return null}}}xs.TWITTER_SIGN_IN_METHOD="twitter.com";xs.PROVIDER_ID="twitter.com";class wi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,r=!1){const i=await vn._fromIdTokenResponse(e,s,r),o=om(s);return new wi({user:i,providerId:o,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const r=om(s);return new wi({user:e,providerId:r,_tokenResponse:s,operationType:t})}}function om(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class jl extends fs{constructor(e,t,s,r){super(t.code,t.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,jl.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,r){return new jl(e,t,s,r)}}function Xy(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?jl._fromErrorAndOperation(n,i,e,s):i})}async function bR(n,e,t=!1){const s=await ta(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wi._forOperation(n,"link",s)}async function AR(n,e,t=!1){const{auth:s}=n;if(_n(s.app))return Promise.reject(Er(s));const r="reauthenticate";try{const i=await ta(n,Xy(s,r,e,n),t);Ee(i.idToken,s,"internal-error");const o=_d(i.idToken);Ee(o,s,"internal-error");const{sub:l}=o;return Ee(n.uid===l,s,"user-mismatch"),wi._forOperation(n,r,i)}catch(i){throw i?.code==="auth/user-not-found"&&qn(s,"user-mismatch"),i}}async function SR(n,e,t=!1){if(_n(n.app))return Promise.reject(Er(n));const s="signIn",r=await Xy(n,s,e),i=await wi._fromIdTokenResponse(n,s,r);return t||await n._updateCurrentUser(i.user),i}function RR(n,e,t,s){return rn(n).onIdTokenChanged(e,t,s)}function PR(n,e,t){return rn(n).beforeAuthStateChanged(e,t)}function CR(n,e,t,s){return rn(n).onAuthStateChanged(e,t,s)}function kR(n){return rn(n).signOut()}const ql="__sak";class Zy{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ql,"1"),this.storage.removeItem(ql),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const NR=1e3,DR=10;class ev extends Zy{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Wy(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),r=this.localCache[t];s!==r&&e(t,r,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const s=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(s);!t&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);lR()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,DR):r()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},NR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ev.type="LOCAL";const VR=ev;class tv extends Zy{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}tv.type="SESSION";const nv=tv;function xR(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Cc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const s=new Cc(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const l=Array.from(o).map(async u=>u(t.origin,i)),c=await xR(l);t.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Cc.receivers=[];function Id(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}class OR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=Id("",20);r.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(f){const m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Fn(){return window}function MR(n){Fn().location.href=n}function sv(){return typeof Fn().WorkerGlobalScope<"u"&&typeof Fn().importScripts=="function"}async function LR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function FR(){return navigator?.serviceWorker?.controller||null}function UR(){return sv()?self:null}const rv="firebaseLocalStorageDb",BR=1,Kl="firebaseLocalStorage",iv="fbase_key";class Sa{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function kc(n,e){return n.transaction([Kl],e?"readwrite":"readonly").objectStore(Kl)}function $R(){const n=indexedDB.deleteDatabase(rv);return new Sa(n).toPromise()}function hh(){const n=indexedDB.open(rv,BR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Kl,{keyPath:iv})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Kl)?e(s):(s.close(),await $R(),e(await hh()))})})}async function am(n,e,t){const s=kc(n,!0).put({[iv]:e,value:t});return new Sa(s).toPromise()}async function jR(n,e){const t=kc(n,!1).get(e),s=await new Sa(t).toPromise();return s===void 0?null:s.value}function lm(n,e){const t=kc(n,!0).delete(e);return new Sa(t).toPromise()}const qR=800,KR=3;class ov{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await hh(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>KR)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cc._getInstance(UR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await LR(),!this.activeServiceWorker)return;this.sender=new OR(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||FR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await hh();return await am(e,ql,"1"),await lm(e,ql),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>am(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>jR(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>lm(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=kc(r,!1).getAll();return new Sa(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),qR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ov.type="LOCAL";const GR=ov;new ba(3e4,6e4);function av(n,e){return e?Zn(e):(Ee(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Td extends Jy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return fi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return fi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function zR(n){return SR(n.auth,new Td(n),n.bypassAuthState)}function HR(n){const{auth:e,user:t}=n;return Ee(t,e,"internal-error"),AR(t,new Td(n),n.bypassAuthState)}async function WR(n){const{auth:e,user:t}=n;return Ee(t,e,"internal-error"),bR(t,new Td(n),n.bypassAuthState)}class lv{constructor(e,t,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:r,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zR;case"linkViaPopup":case"linkViaRedirect":return WR;case"reauthViaPopup":case"reauthViaRedirect":return HR;default:qn(this.auth,"internal-error")}}resolve(e){cs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){cs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const QR=new ba(2e3,1e4);async function YR(n,e,t){if(_n(n.app))return Promise.reject(wn(n,"operation-not-supported-in-this-environment"));const s=Pc(n);KS(n,e,Ed);const r=av(s,t);return new pr(s,"signInViaPopup",e,r).executeNotNull()}class pr extends lv{constructor(e,t,s,r,i){super(e,t,r,i),this.provider=s,this.authWindow=null,this.pollId=null,pr.currentPopupAction&&pr.currentPopupAction.cancel(),pr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ee(e,this.auth,"internal-error"),e}async onExecution(){cs(this.filter.length===1,"Popup operations only handle one event");const e=Id();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(wn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(wn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,pr.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(wn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,QR.get())};e()}}pr.currentPopupAction=null;const JR="pendingRedirect",pl=new Map;class XR extends lv{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=pl.get(this.auth._key());if(!e){try{const s=await ZR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}pl.set(this.auth._key(),e)}return this.bypassAuthState||pl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ZR(n,e){const t=n0(e),s=t0(n);if(!await s._isAvailable())return!1;const r=await s._get(t)==="true";return await s._remove(t),r}function e0(n,e){pl.set(n._key(),e)}function t0(n){return Zn(n._redirectPersistence)}function n0(n){return fl(JR,n.config.apiKey,n.name)}async function s0(n,e,t=!1){if(_n(n.app))return Promise.reject(Er(n));const s=Pc(n),r=av(s,e),o=await new XR(s,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}const r0=600*1e3;class i0{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!o0(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!cv(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(wn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=r0&&this.cachedEventUids.clear(),this.cachedEventUids.has(cm(e))}saveEventToCache(e){this.cachedEventUids.add(cm(e)),this.lastProcessedEventTime=Date.now()}}function cm(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function cv({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function o0(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cv(n);default:return!1}}async function a0(n,e={}){return qi(n,"GET","/v1/projects",e)}const l0=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,c0=/^https?/;async function u0(n){if(n.config.emulator)return;const{authorizedDomains:e}=await a0(n);for(const t of e)try{if(h0(t))return}catch{}qn(n,"unauthorized-domain")}function h0(n){const e=ch(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===s}if(!c0.test(t))return!1;if(l0.test(n))return s===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}const d0=new ba(3e4,6e4);function um(){const n=Fn().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function f0(n){return new Promise((e,t)=>{function s(){um(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{um(),t(wn(n,"network-request-failed"))},timeout:d0.get()})}if(Fn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Fn().gapi?.load)s();else{const r=_R("iframefcb");return Fn()[r]=()=>{gapi.load?s():t(wn(n,"network-request-failed"))},mR(`${gR()}?onload=${r}`).catch(i=>t(i))}}).catch(e=>{throw ml=null,e})}let ml=null;function p0(n){return ml=ml||f0(n),ml}const m0=new ba(5e3,15e3),g0="__/auth/iframe",_0="emulator/auth/iframe",y0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},v0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function E0(n){const e=n.config;Ee(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?md(e,_0):`https://${n.config.authDomain}/${g0}`,s={apiKey:e.apiKey,appName:n.name,v:ji},r=v0.get(n.config.apiHost);r&&(s.eid=r);const i=n._getFrameworks();return i.length&&(s.fw=i.join(",")),`${t}?${wa(s).slice(1)}`}async function I0(n){const e=await p0(n),t=Fn().gapi;return Ee(t,n,"internal-error"),e.open({where:document.body,url:E0(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:y0,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=wn(n,"network-request-failed"),l=Fn().setTimeout(()=>{i(o)},m0.get());function c(){Fn().clearTimeout(l),r(s)}s.ping(c).then(c,()=>{i(o)})}))}const T0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},w0=500,b0=600,A0="_blank",S0="http://localhost";class hm{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function R0(n,e,t,s=w0,r=b0){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let l="";const c={...T0,width:s.toString(),height:r.toString(),top:i,left:o},u=_t().toLowerCase();t&&(l=qy(u)?A0:t),$y(u)&&(e=e||S0,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[_,R])=>`${m}${_}=${R},`,"");if(aR(u)&&l!=="_self")return P0(e||"",l),new hm(null);const f=window.open(e||"",l,h);Ee(f,n,"popup-blocked");try{f.focus()}catch{}return new hm(f)}function P0(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}const C0="__/auth/handler",k0="emulator/auth/handler",N0=encodeURIComponent("fac");async function dm(n,e,t,s,r,i){Ee(n.config.authDomain,n,"auth-domain-config-required"),Ee(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:ji,eventId:r};if(e instanceof Ed){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",CA(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Aa){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await n._getAppCheckToken(),u=c?`#${N0}=${encodeURIComponent(c)}`:"";return`${D0(n)}?${wa(l).slice(1)}${u}`}function D0({config:n}){return n.emulator?md(n,k0):`https://${n.authDomain}/${C0}`}const Nu="webStorageSupport";class V0{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=nv,this._completeRedirectFn=s0,this._overrideRedirectResult=e0}async _openPopup(e,t,s,r){cs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await dm(e,t,s,ch(),r);return R0(e,i,Id())}async _openRedirect(e,t,s,r){await this._originValidation(e);const i=await dm(e,t,s,ch(),r);return MR(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:i}=this.eventManagers[t];return r?Promise.resolve(r):(cs(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await I0(e),s=new i0(e);return t.register("authEvent",r=>(Ee(r?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Nu,{type:Nu},r=>{const i=r?.[0]?.[Nu];i!==void 0&&t(!!i),qn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=u0(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Wy()||jy()||yd()}}const x0=V0;var fm="@firebase/auth",pm="1.12.0";class O0{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function M0(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function L0(n){Ti(new Rr("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=s.options;Ee(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qy(n)},u=new fR(s,r,i,c);return vR(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Ti(new Rr("auth-internal",e=>{const t=Pc(e.getProvider("auth").getImmediate());return(s=>new O0(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Bs(fm,pm,M0(n)),Bs(fm,pm,"esm2020")}const F0=300,U0=wy("authIdTokenMaxAge")||F0;let mm=null;const B0=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>U0)return;const r=t?.token;mm!==r&&(mm=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function $0(n=NS()){const e=dd(n,"auth");if(e.isInitialized())return e.getImmediate();const t=yR(n,{popupRedirectResolver:x0,persistence:[GR,VR,nv]}),s=wy("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=B0(i.toString());PR(t,o,()=>o(t.currentUser)),RR(t,l=>o(l))}}const r=mA("auth");return r&&ER(t,`http://${r}`),t}function j0(){return document.getElementsByTagName("head")?.[0]??document}pR({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=r=>{const i=wn("internal-error");i.customData=r,t(i)},s.type="text/javascript",s.charset="UTF-8",j0().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});L0("Browser");var q0="firebase",K0="12.7.0";Bs(q0,K0,"app");var gm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $s,uv;(function(){var n;function e(I,v){function w(){}w.prototype=v.prototype,I.F=v.prototype,I.prototype=new w,I.prototype.constructor=I,I.D=function(S,A,C){for(var T=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)T[ue-2]=arguments[ue];return v.prototype[A].apply(S,T)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(I,v,w){w||(w=0);const S=Array(16);if(typeof v=="string")for(var A=0;A<16;++A)S[A]=v.charCodeAt(w++)|v.charCodeAt(w++)<<8|v.charCodeAt(w++)<<16|v.charCodeAt(w++)<<24;else for(A=0;A<16;++A)S[A]=v[w++]|v[w++]<<8|v[w++]<<16|v[w++]<<24;v=I.g[0],w=I.g[1],A=I.g[2];let C=I.g[3],T;T=v+(C^w&(A^C))+S[0]+3614090360&4294967295,v=w+(T<<7&4294967295|T>>>25),T=C+(A^v&(w^A))+S[1]+3905402710&4294967295,C=v+(T<<12&4294967295|T>>>20),T=A+(w^C&(v^w))+S[2]+606105819&4294967295,A=C+(T<<17&4294967295|T>>>15),T=w+(v^A&(C^v))+S[3]+3250441966&4294967295,w=A+(T<<22&4294967295|T>>>10),T=v+(C^w&(A^C))+S[4]+4118548399&4294967295,v=w+(T<<7&4294967295|T>>>25),T=C+(A^v&(w^A))+S[5]+1200080426&4294967295,C=v+(T<<12&4294967295|T>>>20),T=A+(w^C&(v^w))+S[6]+2821735955&4294967295,A=C+(T<<17&4294967295|T>>>15),T=w+(v^A&(C^v))+S[7]+4249261313&4294967295,w=A+(T<<22&4294967295|T>>>10),T=v+(C^w&(A^C))+S[8]+1770035416&4294967295,v=w+(T<<7&4294967295|T>>>25),T=C+(A^v&(w^A))+S[9]+2336552879&4294967295,C=v+(T<<12&4294967295|T>>>20),T=A+(w^C&(v^w))+S[10]+4294925233&4294967295,A=C+(T<<17&4294967295|T>>>15),T=w+(v^A&(C^v))+S[11]+2304563134&4294967295,w=A+(T<<22&4294967295|T>>>10),T=v+(C^w&(A^C))+S[12]+1804603682&4294967295,v=w+(T<<7&4294967295|T>>>25),T=C+(A^v&(w^A))+S[13]+4254626195&4294967295,C=v+(T<<12&4294967295|T>>>20),T=A+(w^C&(v^w))+S[14]+2792965006&4294967295,A=C+(T<<17&4294967295|T>>>15),T=w+(v^A&(C^v))+S[15]+1236535329&4294967295,w=A+(T<<22&4294967295|T>>>10),T=v+(A^C&(w^A))+S[1]+4129170786&4294967295,v=w+(T<<5&4294967295|T>>>27),T=C+(w^A&(v^w))+S[6]+3225465664&4294967295,C=v+(T<<9&4294967295|T>>>23),T=A+(v^w&(C^v))+S[11]+643717713&4294967295,A=C+(T<<14&4294967295|T>>>18),T=w+(C^v&(A^C))+S[0]+3921069994&4294967295,w=A+(T<<20&4294967295|T>>>12),T=v+(A^C&(w^A))+S[5]+3593408605&4294967295,v=w+(T<<5&4294967295|T>>>27),T=C+(w^A&(v^w))+S[10]+38016083&4294967295,C=v+(T<<9&4294967295|T>>>23),T=A+(v^w&(C^v))+S[15]+3634488961&4294967295,A=C+(T<<14&4294967295|T>>>18),T=w+(C^v&(A^C))+S[4]+3889429448&4294967295,w=A+(T<<20&4294967295|T>>>12),T=v+(A^C&(w^A))+S[9]+568446438&4294967295,v=w+(T<<5&4294967295|T>>>27),T=C+(w^A&(v^w))+S[14]+3275163606&4294967295,C=v+(T<<9&4294967295|T>>>23),T=A+(v^w&(C^v))+S[3]+4107603335&4294967295,A=C+(T<<14&4294967295|T>>>18),T=w+(C^v&(A^C))+S[8]+1163531501&4294967295,w=A+(T<<20&4294967295|T>>>12),T=v+(A^C&(w^A))+S[13]+2850285829&4294967295,v=w+(T<<5&4294967295|T>>>27),T=C+(w^A&(v^w))+S[2]+4243563512&4294967295,C=v+(T<<9&4294967295|T>>>23),T=A+(v^w&(C^v))+S[7]+1735328473&4294967295,A=C+(T<<14&4294967295|T>>>18),T=w+(C^v&(A^C))+S[12]+2368359562&4294967295,w=A+(T<<20&4294967295|T>>>12),T=v+(w^A^C)+S[5]+4294588738&4294967295,v=w+(T<<4&4294967295|T>>>28),T=C+(v^w^A)+S[8]+2272392833&4294967295,C=v+(T<<11&4294967295|T>>>21),T=A+(C^v^w)+S[11]+1839030562&4294967295,A=C+(T<<16&4294967295|T>>>16),T=w+(A^C^v)+S[14]+4259657740&4294967295,w=A+(T<<23&4294967295|T>>>9),T=v+(w^A^C)+S[1]+2763975236&4294967295,v=w+(T<<4&4294967295|T>>>28),T=C+(v^w^A)+S[4]+1272893353&4294967295,C=v+(T<<11&4294967295|T>>>21),T=A+(C^v^w)+S[7]+4139469664&4294967295,A=C+(T<<16&4294967295|T>>>16),T=w+(A^C^v)+S[10]+3200236656&4294967295,w=A+(T<<23&4294967295|T>>>9),T=v+(w^A^C)+S[13]+681279174&4294967295,v=w+(T<<4&4294967295|T>>>28),T=C+(v^w^A)+S[0]+3936430074&4294967295,C=v+(T<<11&4294967295|T>>>21),T=A+(C^v^w)+S[3]+3572445317&4294967295,A=C+(T<<16&4294967295|T>>>16),T=w+(A^C^v)+S[6]+76029189&4294967295,w=A+(T<<23&4294967295|T>>>9),T=v+(w^A^C)+S[9]+3654602809&4294967295,v=w+(T<<4&4294967295|T>>>28),T=C+(v^w^A)+S[12]+3873151461&4294967295,C=v+(T<<11&4294967295|T>>>21),T=A+(C^v^w)+S[15]+530742520&4294967295,A=C+(T<<16&4294967295|T>>>16),T=w+(A^C^v)+S[2]+3299628645&4294967295,w=A+(T<<23&4294967295|T>>>9),T=v+(A^(w|~C))+S[0]+4096336452&4294967295,v=w+(T<<6&4294967295|T>>>26),T=C+(w^(v|~A))+S[7]+1126891415&4294967295,C=v+(T<<10&4294967295|T>>>22),T=A+(v^(C|~w))+S[14]+2878612391&4294967295,A=C+(T<<15&4294967295|T>>>17),T=w+(C^(A|~v))+S[5]+4237533241&4294967295,w=A+(T<<21&4294967295|T>>>11),T=v+(A^(w|~C))+S[12]+1700485571&4294967295,v=w+(T<<6&4294967295|T>>>26),T=C+(w^(v|~A))+S[3]+2399980690&4294967295,C=v+(T<<10&4294967295|T>>>22),T=A+(v^(C|~w))+S[10]+4293915773&4294967295,A=C+(T<<15&4294967295|T>>>17),T=w+(C^(A|~v))+S[1]+2240044497&4294967295,w=A+(T<<21&4294967295|T>>>11),T=v+(A^(w|~C))+S[8]+1873313359&4294967295,v=w+(T<<6&4294967295|T>>>26),T=C+(w^(v|~A))+S[15]+4264355552&4294967295,C=v+(T<<10&4294967295|T>>>22),T=A+(v^(C|~w))+S[6]+2734768916&4294967295,A=C+(T<<15&4294967295|T>>>17),T=w+(C^(A|~v))+S[13]+1309151649&4294967295,w=A+(T<<21&4294967295|T>>>11),T=v+(A^(w|~C))+S[4]+4149444226&4294967295,v=w+(T<<6&4294967295|T>>>26),T=C+(w^(v|~A))+S[11]+3174756917&4294967295,C=v+(T<<10&4294967295|T>>>22),T=A+(v^(C|~w))+S[2]+718787259&4294967295,A=C+(T<<15&4294967295|T>>>17),T=w+(C^(A|~v))+S[9]+3951481745&4294967295,I.g[0]=I.g[0]+v&4294967295,I.g[1]=I.g[1]+(A+(T<<21&4294967295|T>>>11))&4294967295,I.g[2]=I.g[2]+A&4294967295,I.g[3]=I.g[3]+C&4294967295}s.prototype.v=function(I,v){v===void 0&&(v=I.length);const w=v-this.blockSize,S=this.C;let A=this.h,C=0;for(;C<v;){if(A==0)for(;C<=w;)r(this,I,C),C+=this.blockSize;if(typeof I=="string"){for(;C<v;)if(S[A++]=I.charCodeAt(C++),A==this.blockSize){r(this,S),A=0;break}}else for(;C<v;)if(S[A++]=I[C++],A==this.blockSize){r(this,S),A=0;break}}this.h=A,this.o+=v},s.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var v=1;v<I.length-8;++v)I[v]=0;v=this.o*8;for(var w=I.length-8;w<I.length;++w)I[w]=v&255,v/=256;for(this.v(I),I=Array(16),v=0,w=0;w<4;++w)for(let S=0;S<32;S+=8)I[v++]=this.g[w]>>>S&255;return I};function i(I,v){var w=l;return Object.prototype.hasOwnProperty.call(w,I)?w[I]:w[I]=v(I)}function o(I,v){this.h=v;const w=[];let S=!0;for(let A=I.length-1;A>=0;A--){const C=I[A]|0;S&&C==v||(w[A]=C,S=!1)}this.g=w}var l={};function c(I){return-128<=I&&I<128?i(I,function(v){return new o([v|0],v<0?-1:0)}):new o([I|0],I<0?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return f;if(I<0)return O(u(-I));const v=[];let w=1;for(let S=0;I>=w;S++)v[S]=I/w|0,w*=4294967296;return new o(v,0)}function h(I,v){if(I.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(I.charAt(0)=="-")return O(h(I.substring(1),v));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const w=u(Math.pow(v,8));let S=f;for(let C=0;C<I.length;C+=8){var A=Math.min(8,I.length-C);const T=parseInt(I.substring(C,C+A),v);A<8?(A=u(Math.pow(v,A)),S=S.j(A).add(u(T))):(S=S.j(w),S=S.add(u(T)))}return S}var f=c(0),m=c(1),_=c(16777216);n=o.prototype,n.m=function(){if(x(this))return-O(this).m();let I=0,v=1;for(let w=0;w<this.g.length;w++){const S=this.i(w);I+=(S>=0?S:4294967296+S)*v,v*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(R(this))return"0";if(x(this))return"-"+O(this).toString(I);const v=u(Math.pow(I,6));var w=this;let S="";for(;;){const A=P(w,v).g;w=$(w,A.j(v));let C=((w.g.length>0?w.g[0]:w.h)>>>0).toString(I);if(w=A,R(w))return C+S;for(;C.length<6;)C="0"+C;S=C+S}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function R(I){if(I.h!=0)return!1;for(let v=0;v<I.g.length;v++)if(I.g[v]!=0)return!1;return!0}function x(I){return I.h==-1}n.l=function(I){return I=$(this,I),x(I)?-1:R(I)?0:1};function O(I){const v=I.g.length,w=[];for(let S=0;S<v;S++)w[S]=~I.g[S];return new o(w,~I.h).add(m)}n.abs=function(){return x(this)?O(this):this},n.add=function(I){const v=Math.max(this.g.length,I.g.length),w=[];let S=0;for(let A=0;A<=v;A++){let C=S+(this.i(A)&65535)+(I.i(A)&65535),T=(C>>>16)+(this.i(A)>>>16)+(I.i(A)>>>16);S=T>>>16,C&=65535,T&=65535,w[A]=T<<16|C}return new o(w,w[w.length-1]&-2147483648?-1:0)};function $(I,v){return I.add(O(v))}n.j=function(I){if(R(this)||R(I))return f;if(x(this))return x(I)?O(this).j(O(I)):O(O(this).j(I));if(x(I))return O(this.j(O(I)));if(this.l(_)<0&&I.l(_)<0)return u(this.m()*I.m());const v=this.g.length+I.g.length,w=[];for(var S=0;S<2*v;S++)w[S]=0;for(S=0;S<this.g.length;S++)for(let A=0;A<I.g.length;A++){const C=this.i(S)>>>16,T=this.i(S)&65535,ue=I.i(A)>>>16,oe=I.i(A)&65535;w[2*S+2*A]+=T*oe,U(w,2*S+2*A),w[2*S+2*A+1]+=C*oe,U(w,2*S+2*A+1),w[2*S+2*A+1]+=T*ue,U(w,2*S+2*A+1),w[2*S+2*A+2]+=C*ue,U(w,2*S+2*A+2)}for(I=0;I<v;I++)w[I]=w[2*I+1]<<16|w[2*I];for(I=v;I<2*v;I++)w[I]=0;return new o(w,0)};function U(I,v){for(;(I[v]&65535)!=I[v];)I[v+1]+=I[v]>>>16,I[v]&=65535,v++}function D(I,v){this.g=I,this.h=v}function P(I,v){if(R(v))throw Error("division by zero");if(R(I))return new D(f,f);if(x(I))return v=P(O(I),v),new D(O(v.g),O(v.h));if(x(v))return v=P(I,O(v)),new D(O(v.g),v.h);if(I.g.length>30){if(x(I)||x(v))throw Error("slowDivide_ only works with positive integers.");for(var w=m,S=v;S.l(I)<=0;)w=j(w),S=j(S);var A=Y(w,1),C=Y(S,1);for(S=Y(S,2),w=Y(w,2);!R(S);){var T=C.add(S);T.l(I)<=0&&(A=A.add(w),C=T),S=Y(S,1),w=Y(w,1)}return v=$(I,A.j(v)),new D(A,v)}for(A=f;I.l(v)>=0;){for(w=Math.max(1,Math.floor(I.m()/v.m())),S=Math.ceil(Math.log(w)/Math.LN2),S=S<=48?1:Math.pow(2,S-48),C=u(w),T=C.j(v);x(T)||T.l(I)>0;)w-=S,C=u(w),T=C.j(v);R(C)&&(C=m),A=A.add(C),I=$(I,T)}return new D(A,I)}n.B=function(I){return P(this,I).h},n.and=function(I){const v=Math.max(this.g.length,I.g.length),w=[];for(let S=0;S<v;S++)w[S]=this.i(S)&I.i(S);return new o(w,this.h&I.h)},n.or=function(I){const v=Math.max(this.g.length,I.g.length),w=[];for(let S=0;S<v;S++)w[S]=this.i(S)|I.i(S);return new o(w,this.h|I.h)},n.xor=function(I){const v=Math.max(this.g.length,I.g.length),w=[];for(let S=0;S<v;S++)w[S]=this.i(S)^I.i(S);return new o(w,this.h^I.h)};function j(I){const v=I.g.length+1,w=[];for(let S=0;S<v;S++)w[S]=I.i(S)<<1|I.i(S-1)>>>31;return new o(w,I.h)}function Y(I,v){const w=v>>5;v%=32;const S=I.g.length-w,A=[];for(let C=0;C<S;C++)A[C]=v>0?I.i(C+w)>>>v|I.i(C+w+1)<<32-v:I.i(C+w);return new o(A,I.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,uv=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,$s=o}).apply(typeof gm<"u"?gm:typeof self<"u"?self:typeof window<"u"?window:{});var Za=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var hv,bo,dv,gl,dh,fv,pv,mv;(function(){var n,e=Object.defineProperty;function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Za=="object"&&Za];for(var d=0;d<a.length;++d){var p=a[d];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var s=t(this);function r(a,d){if(d)e:{var p=s;a=a.split(".");for(var y=0;y<a.length-1;y++){var V=a[y];if(!(V in p))break e;p=p[V]}a=a[a.length-1],y=p[a],d=d(y),d!=y&&d!=null&&e(p,a,{configurable:!0,writable:!0,value:d})}}r("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(a){return a||function(d){var p=[],y;for(y in d)Object.prototype.hasOwnProperty.call(d,y)&&p.push([y,d[y]]);return p}});var i=i||{},o=this||self;function l(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function c(a,d,p){return a.call.apply(a.bind,arguments)}function u(a,d,p){return u=c,u.apply(null,arguments)}function h(a,d){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function f(a,d){function p(){}p.prototype=d.prototype,a.Z=d.prototype,a.prototype=new p,a.prototype.constructor=a,a.Ob=function(y,V,M){for(var X=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)X[Ae-2]=arguments[Ae];return d.prototype[V].apply(y,X)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function _(a){const d=a.length;if(d>0){const p=Array(d);for(let y=0;y<d;y++)p[y]=a[y];return p}return[]}function R(a,d){for(let y=1;y<arguments.length;y++){const V=arguments[y];var p=typeof V;if(p=p!="object"?p:V?Array.isArray(V)?"array":p:"null",p=="array"||p=="object"&&typeof V.length=="number"){p=a.length||0;const M=V.length||0;a.length=p+M;for(let X=0;X<M;X++)a[p+X]=V[X]}else a.push(V)}}class x{constructor(d,p){this.i=d,this.j=p,this.h=0,this.g=null}get(){let d;return this.h>0?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function O(a){o.setTimeout(()=>{throw a},0)}function $(){var a=I;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class U{constructor(){this.h=this.g=null}add(d,p){const y=D.get();y.set(d,p),this.h?this.h.next=y:this.g=y,this.h=y}}var D=new x(()=>new P,a=>a.reset());class P{constructor(){this.next=this.g=this.h=null}set(d,p){this.h=d,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let j,Y=!1,I=new U,v=()=>{const a=Promise.resolve(void 0);j=()=>{a.then(w)}};function w(){for(var a;a=$();){try{a.h.call(a.g)}catch(p){O(p)}var d=D;d.j(a),d.h<100&&(d.h++,a.next=d.g,d.g=a)}Y=!1}function S(){this.u=this.u,this.C=this.C}S.prototype.u=!1,S.prototype.dispose=function(){this.u||(this.u=!0,this.N())},S.prototype[Symbol.dispose]=function(){this.dispose()},S.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function A(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var C=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const p=()=>{};o.addEventListener("test",p,d),o.removeEventListener("test",p,d)}catch{}return a})();function T(a){return/^[\s\xa0]*$/.test(a)}function ue(a,d){A.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,d)}f(ue,A),ue.prototype.init=function(a,d){const p=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget,d||(p=="mouseover"?d=a.fromElement:p=="mouseout"&&(d=a.toElement)),this.relatedTarget=d,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&ue.Z.h.call(this)},ue.prototype.h=function(){ue.Z.h.call(this);const a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var oe="closure_listenable_"+(Math.random()*1e6|0),Ve=0;function Oe(a,d,p,y,V){this.listener=a,this.proxy=null,this.src=d,this.type=p,this.capture=!!y,this.ha=V,this.key=++Ve,this.da=this.fa=!1}function Re(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Tt(a,d,p){for(const y in a)d.call(p,a[y],y,a)}function an(a,d){for(const p in a)d.call(void 0,a[p],p,a)}function Ut(a){const d={};for(const p in a)d[p]=a[p];return d}const ft="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ie(a,d){let p,y;for(let V=1;V<arguments.length;V++){y=arguments[V];for(p in y)a[p]=y[p];for(let M=0;M<ft.length;M++)p=ft[M],Object.prototype.hasOwnProperty.call(y,p)&&(a[p]=y[p])}}function Z(a){this.src=a,this.g={},this.h=0}Z.prototype.add=function(a,d,p,y,V){const M=a.toString();a=this.g[M],a||(a=this.g[M]=[],this.h++);const X=Ge(a,d,y,V);return X>-1?(d=a[X],p||(d.fa=!1)):(d=new Oe(d,this.src,M,!!y,V),d.fa=p,a.push(d)),d};function se(a,d){const p=d.type;if(p in a.g){var y=a.g[p],V=Array.prototype.indexOf.call(y,d,void 0),M;(M=V>=0)&&Array.prototype.splice.call(y,V,1),M&&(Re(d),a.g[p].length==0&&(delete a.g[p],a.h--))}}function Ge(a,d,p,y){for(let V=0;V<a.length;++V){const M=a[V];if(!M.da&&M.listener==d&&M.capture==!!p&&M.ha==y)return V}return-1}var B="closure_lm_"+(Math.random()*1e6|0),le={};function te(a,d,p,y,V){if(Array.isArray(d)){for(let M=0;M<d.length;M++)te(a,d[M],p,y,V);return null}return p=ee(p),a&&a[oe]?a.J(d,p,l(y)?!!y.capture:!1,V):de(a,d,p,!1,y,V)}function de(a,d,p,y,V,M){if(!d)throw Error("Invalid event type");const X=l(V)?!!V.capture:!!V;let Ae=K(a);if(Ae||(a[B]=Ae=new Z(a)),p=Ae.add(d,p,y,X,M),p.proxy)return p;if(y=Ce(),p.proxy=y,y.src=a,y.listener=p,a.addEventListener)C||(V=X),V===void 0&&(V=!1),a.addEventListener(d.toString(),y,V);else if(a.attachEvent)a.attachEvent(k(d.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Ce(){function a(p){return d.call(a.src,a.listener,p)}const d=L;return a}function E(a,d,p,y,V){if(Array.isArray(d))for(var M=0;M<d.length;M++)E(a,d[M],p,y,V);else y=l(y)?!!y.capture:!!y,p=ee(p),a&&a[oe]?(a=a.i,M=String(d).toString(),M in a.g&&(d=a.g[M],p=Ge(d,p,y,V),p>-1&&(Re(d[p]),Array.prototype.splice.call(d,p,1),d.length==0&&(delete a.g[M],a.h--)))):a&&(a=K(a))&&(d=a.g[d.toString()],a=-1,d&&(a=Ge(d,p,y,V)),(p=a>-1?d[a]:null)&&b(p))}function b(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[oe])se(d.i,a);else{var p=a.type,y=a.proxy;d.removeEventListener?d.removeEventListener(p,y,a.capture):d.detachEvent?d.detachEvent(k(p),y):d.addListener&&d.removeListener&&d.removeListener(y),(p=K(d))?(se(p,a),p.h==0&&(p.src=null,d[B]=null)):Re(a)}}}function k(a){return a in le?le[a]:le[a]="on"+a}function L(a,d){if(a.da)a=!0;else{d=new ue(d,this);const p=a.listener,y=a.ha||a.src;a.fa&&b(a),a=p.call(y,d)}return a}function K(a){return a=a[B],a instanceof Z?a:null}var F="__closure_events_fn_"+(Math.random()*1e9>>>0);function ee(a){return typeof a=="function"?a:(a[F]||(a[F]=function(d){return a.handleEvent(d)}),a[F])}function H(){S.call(this),this.i=new Z(this),this.M=this,this.G=null}f(H,S),H.prototype[oe]=!0,H.prototype.removeEventListener=function(a,d,p,y){E(this,a,d,p,y)};function z(a,d){var p,y=a.G;if(y)for(p=[];y;y=y.G)p.push(y);if(a=a.M,y=d.type||d,typeof d=="string")d=new A(d,a);else if(d instanceof A)d.target=d.target||a;else{var V=d;d=new A(y,a),ie(d,V)}V=!0;let M,X;if(p)for(X=p.length-1;X>=0;X--)M=d.g=p[X],V=G(M,y,!0,d)&&V;if(M=d.g=a,V=G(M,y,!0,d)&&V,V=G(M,y,!1,d)&&V,p)for(X=0;X<p.length;X++)M=d.g=p[X],V=G(M,y,!1,d)&&V}H.prototype.N=function(){if(H.Z.N.call(this),this.i){var a=this.i;for(const d in a.g){const p=a.g[d];for(let y=0;y<p.length;y++)Re(p[y]);delete a.g[d],a.h--}}this.G=null},H.prototype.J=function(a,d,p,y){return this.i.add(String(a),d,!1,p,y)},H.prototype.K=function(a,d,p,y){return this.i.add(String(a),d,!0,p,y)};function G(a,d,p,y){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();let V=!0;for(let M=0;M<d.length;++M){const X=d[M];if(X&&!X.da&&X.capture==p){const Ae=X.listener,pt=X.ha||X.src;X.fa&&se(a.i,X),V=Ae.call(pt,y)!==!1&&V}}return V&&!y.defaultPrevented}function ge(a,d){if(typeof a!="function")if(a&&typeof a.handleEvent=="function")a=u(a.handleEvent,a);else throw Error("Invalid listener argument");return Number(d)>2147483647?-1:o.setTimeout(a,d||0)}function re(a){a.g=ge(()=>{a.g=null,a.i&&(a.i=!1,re(a))},a.l);const d=a.h;a.h=null,a.m.apply(null,d)}class fe extends S{constructor(d,p){super(),this.m=d,this.l=p,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:re(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ye(a){S.call(this),this.h=a,this.g={}}f(ye,S);var Pe=[];function je(a){Tt(a.g,function(d,p){this.g.hasOwnProperty(p)&&b(d)},a),a.g={}}ye.prototype.N=function(){ye.Z.N.call(this),je(this)},ye.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xe=o.JSON.stringify,Pt=o.JSON.parse,Ct=class{stringify(a){return o.JSON.stringify(a,void 0)}parse(a){return o.JSON.parse(a,void 0)}};function Jt(){}function Xt(){}var pn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function jr(){A.call(this,"d")}f(jr,A);function wt(){A.call(this,"c")}f(wt,A);var vt={},Qi=null;function Xs(){return Qi=Qi||new H}vt.Ia="serverreachability";function Ef(a){A.call(this,vt.Ia,a)}f(Ef,A);function Yi(a){const d=Xs();z(d,new Ef(d))}vt.STAT_EVENT="statevent";function If(a,d){A.call(this,vt.STAT_EVENT,a),this.stat=d}f(If,A);function Bt(a){const d=Xs();z(d,new If(d,a))}vt.Ja="timingevent";function Tf(a,d){A.call(this,vt.Ja,a),this.size=d}f(Tf,A);function Ji(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){a()},d)}function Xi(){this.g=!0}Xi.prototype.ua=function(){this.g=!1};function fT(a,d,p,y,V,M){a.info(function(){if(a.g)if(M){var X="",Ae=M.split("&");for(let We=0;We<Ae.length;We++){var pt=Ae[We].split("=");if(pt.length>1){const Et=pt[0];pt=pt[1];const Cn=Et.split("_");X=Cn.length>=2&&Cn[1]=="type"?X+(Et+"="+pt+"&"):X+(Et+"=redacted&")}}}else X=null;else X=M;return"XMLHTTP REQ ("+y+") [attempt "+V+"]: "+d+`
`+p+`
`+X})}function pT(a,d,p,y,V,M,X){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+V+"]: "+d+`
`+p+`
`+M+" "+X})}function qr(a,d,p,y){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+gT(a,p)+(y?" "+y:"")})}function mT(a,d){a.info(function(){return"TIMEOUT: "+d})}Xi.prototype.info=function(){};function gT(a,d){if(!a.g)return d;if(!d)return null;try{const M=JSON.parse(d);if(M){for(a=0;a<M.length;a++)if(Array.isArray(M[a])){var p=M[a];if(!(p.length<2)){var y=p[1];if(Array.isArray(y)&&!(y.length<1)){var V=y[0];if(V!="noop"&&V!="stop"&&V!="close")for(let X=1;X<y.length;X++)y[X]=""}}}}return xe(M)}catch{return d}}var Fa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},wf={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},bf;function tu(){}f(tu,Jt),tu.prototype.g=function(){return new XMLHttpRequest},bf=new tu;function Zi(a){return encodeURIComponent(String(a))}function _T(a){var d=1;a=a.split(":");const p=[];for(;d>0&&a.length;)p.push(a.shift()),d--;return a.length&&p.push(a.join(":")),p}function ms(a,d,p,y){this.j=a,this.i=d,this.l=p,this.S=y||1,this.V=new ye(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Af}function Af(){this.i=null,this.g="",this.h=!1}var Sf={},nu={};function su(a,d,p){a.M=1,a.A=Ba(Pn(d)),a.u=p,a.R=!0,Rf(a,null)}function Rf(a,d){a.F=Date.now(),Ua(a),a.B=Pn(a.A);var p=a.B,y=a.S;Array.isArray(y)||(y=[String(y)]),Bf(p.i,"t",y),a.C=0,p=a.j.L,a.h=new Af,a.g=rp(a.j,p?d:null,!a.u),a.P>0&&(a.O=new fe(u(a.Y,a,a.g),a.P)),d=a.V,p=a.g,y=a.ba;var V="readystatechange";Array.isArray(V)||(V&&(Pe[0]=V.toString()),V=Pe);for(let M=0;M<V.length;M++){const X=te(p,V[M],y||d.handleEvent,!1,d.h||d);if(!X)break;d.g[X.key]=X}d=a.J?Ut(a.J):{},a.u?(a.v||(a.v="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,d)):(a.v="GET",a.g.ea(a.B,a.v,null,d)),Yi(),fT(a.i,a.v,a.B,a.l,a.S,a.u)}ms.prototype.ba=function(a){a=a.target;const d=this.O;d&&ys(a)==3?d.j():this.Y(a)},ms.prototype.Y=function(a){try{if(a==this.g)e:{const Ae=ys(this.g),pt=this.g.ya(),We=this.g.ca();if(!(Ae<3)&&(Ae!=3||this.g&&(this.h.h||this.g.la()||Hf(this.g)))){this.K||Ae!=4||pt==7||(pt==8||We<=0?Yi(3):Yi(2)),ru(this);var d=this.g.ca();this.X=d;var p=yT(this);if(this.o=d==200,pT(this.i,this.v,this.B,this.l,this.S,Ae,d),this.o){if(this.U&&!this.L){t:{if(this.g){var y,V=this.g;if((y=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(y)){var M=y;break t}}M=null}if(a=M)qr(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,iu(this,a);else{this.o=!1,this.m=3,Bt(12),Zs(this),eo(this);break e}}if(this.R){a=!0;let Et;for(;!this.K&&this.C<p.length;)if(Et=vT(this,p),Et==nu){Ae==4&&(this.m=4,Bt(14),a=!1),qr(this.i,this.l,null,"[Incomplete Response]");break}else if(Et==Sf){this.m=4,Bt(15),qr(this.i,this.l,p,"[Invalid Chunk]"),a=!1;break}else qr(this.i,this.l,Et,null),iu(this,Et);if(Pf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ae!=4||p.length!=0||this.h.h||(this.m=1,Bt(16),a=!1),this.o=this.o&&a,!a)qr(this.i,this.l,p,"[Invalid Chunked Response]"),Zs(this),eo(this);else if(p.length>0&&!this.W){this.W=!0;var X=this.j;X.g==this&&X.aa&&!X.P&&(X.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),fu(X),X.P=!0,Bt(11))}}else qr(this.i,this.l,p,null),iu(this,p);Ae==4&&Zs(this),this.o&&!this.K&&(Ae==4?ep(this.j,this):(this.o=!1,Ua(this)))}else VT(this.g),d==400&&p.indexOf("Unknown SID")>0?(this.m=3,Bt(12)):(this.m=0,Bt(13)),Zs(this),eo(this)}}}catch{}};function yT(a){if(!Pf(a))return a.g.la();const d=Hf(a.g);if(d==="")return"";let p="";const y=d.length,V=ys(a.g)==4;if(!a.h.i){if(typeof TextDecoder>"u")return Zs(a),eo(a),"";a.h.i=new o.TextDecoder}for(let M=0;M<y;M++)a.h.h=!0,p+=a.h.i.decode(d[M],{stream:!(V&&M==y-1)});return d.length=0,a.h.g+=p,a.C=0,a.h.g}function Pf(a){return a.g?a.v=="GET"&&a.M!=2&&a.j.Aa:!1}function vT(a,d){var p=a.C,y=d.indexOf(`
`,p);return y==-1?nu:(p=Number(d.substring(p,y)),isNaN(p)?Sf:(y+=1,y+p>d.length?nu:(d=d.slice(y,y+p),a.C=y+p,d)))}ms.prototype.cancel=function(){this.K=!0,Zs(this)};function Ua(a){a.T=Date.now()+a.H,Cf(a,a.H)}function Cf(a,d){if(a.D!=null)throw Error("WatchDog timer not null");a.D=Ji(u(a.aa,a),d)}function ru(a){a.D&&(o.clearTimeout(a.D),a.D=null)}ms.prototype.aa=function(){this.D=null;const a=Date.now();a-this.T>=0?(mT(this.i,this.B),this.M!=2&&(Yi(),Bt(17)),Zs(this),this.m=2,eo(this)):Cf(this,this.T-a)};function eo(a){a.j.I==0||a.K||ep(a.j,a)}function Zs(a){ru(a);var d=a.O;d&&typeof d.dispose=="function"&&d.dispose(),a.O=null,je(a.V),a.g&&(d=a.g,a.g=null,d.abort(),d.dispose())}function iu(a,d){try{var p=a.j;if(p.I!=0&&(p.g==a||ou(p.h,a))){if(!a.L&&ou(p.h,a)&&p.I==3){try{var y=p.Ba.g.parse(d)}catch{y=null}if(Array.isArray(y)&&y.length==3){var V=y;if(V[0]==0){e:if(!p.v){if(p.g)if(p.g.F+3e3<a.F)Ga(p),qa(p);else break e;du(p),Bt(18)}}else p.xa=V[1],0<p.xa-p.K&&V[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=Ji(u(p.Va,p),6e3));Df(p.h)<=1&&p.ta&&(p.ta=void 0)}else tr(p,11)}else if((a.L||p.g==a)&&Ga(p),!T(d))for(V=p.Ba.g.parse(d),d=0;d<V.length;d++){let We=V[d];const Et=We[0];if(!(Et<=p.K))if(p.K=Et,We=We[1],p.I==2)if(We[0]=="c"){p.M=We[1],p.ba=We[2];const Cn=We[3];Cn!=null&&(p.ka=Cn,p.j.info("VER="+p.ka));const nr=We[4];nr!=null&&(p.za=nr,p.j.info("SVER="+p.za));const vs=We[5];vs!=null&&typeof vs=="number"&&vs>0&&(y=1.5*vs,p.O=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;const Es=a.g;if(Es){const Ha=Es.g?Es.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ha){var M=y.h;M.g||Ha.indexOf("spdy")==-1&&Ha.indexOf("quic")==-1&&Ha.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(au(M,M.h),M.h=null))}if(y.G){const pu=Es.g?Es.g.getResponseHeader("X-HTTP-Session-Id"):null;pu&&(y.wa=pu,et(y.J,y.G,pu))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-a.F,p.j.info("Handshake RTT: "+p.T+"ms")),y=p;var X=a;if(y.na=sp(y,y.L?y.ba:null,y.W),X.L){Vf(y.h,X);var Ae=X,pt=y.O;pt&&(Ae.H=pt),Ae.D&&(ru(Ae),Ua(Ae)),y.g=X}else Xf(y);p.i.length>0&&Ka(p)}else We[0]!="stop"&&We[0]!="close"||tr(p,7);else p.I==3&&(We[0]=="stop"||We[0]=="close"?We[0]=="stop"?tr(p,7):hu(p):We[0]!="noop"&&p.l&&p.l.qa(We),p.A=0)}}Yi(4)}catch{}}var ET=class{constructor(a,d){this.g=a,this.map=d}};function kf(a){this.l=a||10,o.PerformanceNavigationTiming?(a=o.performance.getEntriesByType("navigation"),a=a.length>0&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Nf(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Df(a){return a.h?1:a.g?a.g.size:0}function ou(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function au(a,d){a.g?a.g.add(d):a.h=d}function Vf(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}kf.prototype.cancel=function(){if(this.i=xf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function xf(a){if(a.h!=null)return a.i.concat(a.h.G);if(a.g!=null&&a.g.size!==0){let d=a.i;for(const p of a.g.values())d=d.concat(p.G);return d}return _(a.i)}var Of=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function IT(a,d){if(a){a=a.split("&");for(let p=0;p<a.length;p++){const y=a[p].indexOf("=");let V,M=null;y>=0?(V=a[p].substring(0,y),M=a[p].substring(y+1)):V=a[p],d(V,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function gs(a){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let d;a instanceof gs?(this.l=a.l,to(this,a.j),this.o=a.o,this.g=a.g,no(this,a.u),this.h=a.h,lu(this,$f(a.i)),this.m=a.m):a&&(d=String(a).match(Of))?(this.l=!1,to(this,d[1]||"",!0),this.o=so(d[2]||""),this.g=so(d[3]||"",!0),no(this,d[4]),this.h=so(d[5]||"",!0),lu(this,d[6]||"",!0),this.m=so(d[7]||"")):(this.l=!1,this.i=new io(null,this.l))}gs.prototype.toString=function(){const a=[];var d=this.j;d&&a.push(ro(d,Mf,!0),":");var p=this.g;return(p||d=="file")&&(a.push("//"),(d=this.o)&&a.push(ro(d,Mf,!0),"@"),a.push(Zi(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&a.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&a.push("/"),a.push(ro(p,p.charAt(0)=="/"?bT:wT,!0))),(p=this.i.toString())&&a.push("?",p),(p=this.m)&&a.push("#",ro(p,ST)),a.join("")},gs.prototype.resolve=function(a){const d=Pn(this);let p=!!a.j;p?to(d,a.j):p=!!a.o,p?d.o=a.o:p=!!a.g,p?d.g=a.g:p=a.u!=null;var y=a.h;if(p)no(d,a.u);else if(p=!!a.h){if(y.charAt(0)!="/")if(this.g&&!this.h)y="/"+y;else{var V=d.h.lastIndexOf("/");V!=-1&&(y=d.h.slice(0,V+1)+y)}if(V=y,V==".."||V==".")y="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){y=V.lastIndexOf("/",0)==0,V=V.split("/");const M=[];for(let X=0;X<V.length;){const Ae=V[X++];Ae=="."?y&&X==V.length&&M.push(""):Ae==".."?((M.length>1||M.length==1&&M[0]!="")&&M.pop(),y&&X==V.length&&M.push("")):(M.push(Ae),y=!0)}y=M.join("/")}else y=V}return p?d.h=y:p=a.i.toString()!=="",p?lu(d,$f(a.i)):p=!!a.m,p&&(d.m=a.m),d};function Pn(a){return new gs(a)}function to(a,d,p){a.j=p?so(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function no(a,d){if(d){if(d=Number(d),isNaN(d)||d<0)throw Error("Bad port number "+d);a.u=d}else a.u=null}function lu(a,d,p){d instanceof io?(a.i=d,RT(a.i,a.l)):(p||(d=ro(d,AT)),a.i=new io(d,a.l))}function et(a,d,p){a.i.set(d,p)}function Ba(a){return et(a,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),a}function so(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function ro(a,d,p){return typeof a=="string"?(a=encodeURI(a).replace(d,TT),p&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function TT(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Mf=/[#\/\?@]/g,wT=/[#\?:]/g,bT=/[#\?]/g,AT=/[#\?@]/g,ST=/#/g;function io(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function er(a){a.g||(a.g=new Map,a.h=0,a.i&&IT(a.i,function(d,p){a.add(decodeURIComponent(d.replace(/\+/g," ")),p)}))}n=io.prototype,n.add=function(a,d){er(this),this.i=null,a=Kr(this,a);let p=this.g.get(a);return p||this.g.set(a,p=[]),p.push(d),this.h+=1,this};function Lf(a,d){er(a),d=Kr(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function Ff(a,d){return er(a),d=Kr(a,d),a.g.has(d)}n.forEach=function(a,d){er(this),this.g.forEach(function(p,y){p.forEach(function(V){a.call(d,V,y,this)},this)},this)};function Uf(a,d){er(a);let p=[];if(typeof d=="string")Ff(a,d)&&(p=p.concat(a.g.get(Kr(a,d))));else for(a=Array.from(a.g.values()),d=0;d<a.length;d++)p=p.concat(a[d]);return p}n.set=function(a,d){return er(this),this.i=null,a=Kr(this,a),Ff(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},n.get=function(a,d){return a?(a=Uf(this,a),a.length>0?String(a[0]):d):d};function Bf(a,d,p){Lf(a,d),p.length>0&&(a.i=null,a.g.set(Kr(a,d),_(p)),a.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],d=Array.from(this.g.keys());for(let y=0;y<d.length;y++){var p=d[y];const V=Zi(p);p=Uf(this,p);for(let M=0;M<p.length;M++){let X=V;p[M]!==""&&(X+="="+Zi(p[M])),a.push(X)}}return this.i=a.join("&")};function $f(a){const d=new io;return d.i=a.i,a.g&&(d.g=new Map(a.g),d.h=a.h),d}function Kr(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function RT(a,d){d&&!a.j&&(er(a),a.i=null,a.g.forEach(function(p,y){const V=y.toLowerCase();y!=V&&(Lf(this,y),Bf(this,V,p))},a)),a.j=d}function PT(a,d){const p=new Xi;if(o.Image){const y=new Image;y.onload=h(_s,p,"TestLoadImage: loaded",!0,d,y),y.onerror=h(_s,p,"TestLoadImage: error",!1,d,y),y.onabort=h(_s,p,"TestLoadImage: abort",!1,d,y),y.ontimeout=h(_s,p,"TestLoadImage: timeout",!1,d,y),o.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else d(!1)}function CT(a,d){const p=new Xi,y=new AbortController,V=setTimeout(()=>{y.abort(),_s(p,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:y.signal}).then(M=>{clearTimeout(V),M.ok?_s(p,"TestPingServer: ok",!0,d):_s(p,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(V),_s(p,"TestPingServer: error",!1,d)})}function _s(a,d,p,y,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),y(p)}catch{}}function kT(){this.g=new Ct}function cu(a){this.i=a.Sb||null,this.h=a.ab||!1}f(cu,Jt),cu.prototype.g=function(){return new $a(this.i,this.h)};function $a(a,d){H.call(this),this.H=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}f($a,H),n=$a.prototype,n.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=d,this.readyState=1,ao(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const d={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(d.body=a),(this.H||o).fetch(new Request(this.D,d)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,oo(this)),this.readyState=0},n.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,ao(this)),this.g&&(this.readyState=3,ao(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;jf(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))};function jf(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}n.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.B.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?oo(this):ao(this),this.readyState==3&&jf(this)}},n.Oa=function(a){this.g&&(this.response=this.responseText=a,oo(this))},n.Na=function(a){this.g&&(this.response=a,oo(this))},n.ga=function(){this.g&&oo(this)};function oo(a){a.readyState=4,a.l=null,a.j=null,a.B=null,ao(a)}n.setRequestHeader=function(a,d){this.A.append(a,d)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],d=this.h.entries();for(var p=d.next();!p.done;)p=p.value,a.push(p[0]+": "+p[1]),p=d.next();return a.join(`\r
`)};function ao(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty($a.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function qf(a){let d="";return Tt(a,function(p,y){d+=y,d+=":",d+=p,d+=`\r
`}),d}function uu(a,d,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=qf(p),typeof a=="string"?p!=null&&Zi(p):et(a,d,p))}function rt(a){H.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}f(rt,H);var NT=/^https?$/i,DT=["POST","PUT"];n=rt.prototype,n.Fa=function(a){this.H=a},n.ea=function(a,d,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():bf.g(),this.g.onreadystatechange=m(u(this.Ca,this));try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(M){Kf(this,M);return}if(a=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var V in y)p.set(V,y[V]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const M of y.keys())p.set(M,y.get(M));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(M=>M.toLowerCase()=="content-type"),V=o.FormData&&a instanceof o.FormData,!(Array.prototype.indexOf.call(DT,d,void 0)>=0)||y||V||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,X]of p)this.g.setRequestHeader(M,X);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(M){Kf(this,M)}};function Kf(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.o=5,Gf(a),ja(a)}function Gf(a){a.A||(a.A=!0,z(a,"complete"),z(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,z(this,"complete"),z(this,"abort"),ja(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ja(this,!0)),rt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?zf(this):this.Xa())},n.Xa=function(){zf(this)};function zf(a){if(a.h&&typeof i<"u"){if(a.v&&ys(a)==4)setTimeout(a.Ca.bind(a),0);else if(z(a,"readystatechange"),ys(a)==4){a.h=!1;try{const M=a.ca();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var p;if(!(p=d)){var y;if(y=M===0){let X=String(a.D).match(Of)[1]||null;!X&&o.self&&o.self.location&&(X=o.self.location.protocol.slice(0,-1)),y=!NT.test(X?X.toLowerCase():"")}p=y}if(p)z(a,"complete"),z(a,"success");else{a.o=6;try{var V=ys(a)>2?a.g.statusText:""}catch{V=""}a.l=V+" ["+a.ca()+"]",Gf(a)}}finally{ja(a)}}}}function ja(a,d){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);const p=a.g;a.g=null,d||z(a,"ready");try{p.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ys(a){return a.g?a.g.readyState:0}n.ca=function(){try{return ys(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),Pt(d)}};function Hf(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function VT(a){const d={};a=(a.g&&ys(a)>=2&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(T(a[y]))continue;var p=_T(a[y]);const V=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const M=d[V]||[];d[V]=M,M.push(p)}an(d,function(y){return y.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function lo(a,d,p){return p&&p.internalChannelParams&&p.internalChannelParams[a]||d}function Wf(a){this.za=0,this.i=[],this.j=new Xi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=lo("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=lo("baseRetryDelayMs",5e3,a),this.Za=lo("retryDelaySeedMs",1e4,a),this.Ta=lo("forwardChannelMaxRetries",2,a),this.va=lo("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new kf(a&&a.concurrentRequestLimit),this.Ba=new kT,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Wf.prototype,n.ka=8,n.I=1,n.connect=function(a,d,p,y){Bt(0),this.W=a,this.H=d||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.J=sp(this,null,this.W),Ka(this)};function hu(a){if(Qf(a),a.I==3){var d=a.V++,p=Pn(a.J);if(et(p,"SID",a.M),et(p,"RID",d),et(p,"TYPE","terminate"),co(a,p),d=new ms(a,a.j,d),d.M=2,d.A=Ba(Pn(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(d.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=d.A,p=!0),p||(d.g=rp(d.j,null),d.g.ea(d.A)),d.F=Date.now(),Ua(d)}np(a)}function qa(a){a.g&&(fu(a),a.g.cancel(),a.g=null)}function Qf(a){qa(a),a.v&&(o.clearTimeout(a.v),a.v=null),Ga(a),a.h.cancel(),a.m&&(typeof a.m=="number"&&o.clearTimeout(a.m),a.m=null)}function Ka(a){if(!Nf(a.h)&&!a.m){a.m=!0;var d=a.Ea;j||v(),Y||(j(),Y=!0),I.add(d,a),a.D=0}}function xT(a,d){return Df(a.h)>=a.h.j-(a.m?1:0)?!1:a.m?(a.i=d.G.concat(a.i),!0):a.I==1||a.I==2||a.D>=(a.Sa?0:a.Ta)?!1:(a.m=Ji(u(a.Ea,a,d),tp(a,a.D)),a.D++,!0)}n.Ea=function(a){if(this.m)if(this.m=null,this.I==1){if(!a){this.V=Math.floor(Math.random()*1e5),a=this.V++;const V=new ms(this,this.j,a);let M=this.o;if(this.U&&(M?(M=Ut(M),ie(M,this.U)):M=this.U),this.u!==null||this.R||(V.J=M,M=null),this.S)e:{for(var d=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(d+=y,d>4096){d=p;break e}if(d===4096||p===this.i.length-1){d=p+1;break e}}d=1e3}else d=1e3;d=Jf(this,V,d),p=Pn(this.J),et(p,"RID",a),et(p,"CVER",22),this.G&&et(p,"X-HTTP-Session-Id",this.G),co(this,p),M&&(this.R?d="headers="+Zi(qf(M))+"&"+d:this.u&&uu(p,this.u,M)),au(this.h,V),this.Ra&&et(p,"TYPE","init"),this.S?(et(p,"$req",d),et(p,"SID","null"),V.U=!0,su(V,p,null)):su(V,p,d),this.I=2}}else this.I==3&&(a?Yf(this,a):this.i.length==0||Nf(this.h)||Yf(this))};function Yf(a,d){var p;d?p=d.l:p=a.V++;const y=Pn(a.J);et(y,"SID",a.M),et(y,"RID",p),et(y,"AID",a.K),co(a,y),a.u&&a.o&&uu(y,a.u,a.o),p=new ms(a,a.j,p,a.D+1),a.u===null&&(p.J=a.o),d&&(a.i=d.G.concat(a.i)),d=Jf(a,p,1e3),p.H=Math.round(a.va*.5)+Math.round(a.va*.5*Math.random()),au(a.h,p),su(p,y,d)}function co(a,d){a.H&&Tt(a.H,function(p,y){et(d,y,p)}),a.l&&Tt({},function(p,y){et(d,y,p)})}function Jf(a,d,p){p=Math.min(a.i.length,p);const y=a.l?u(a.l.Ka,a.l,a):null;e:{var V=a.i;let Ae=-1;for(;;){const pt=["count="+p];Ae==-1?p>0?(Ae=V[0].g,pt.push("ofs="+Ae)):Ae=0:pt.push("ofs="+Ae);let We=!0;for(let Et=0;Et<p;Et++){var M=V[Et].g;const Cn=V[Et].map;if(M-=Ae,M<0)Ae=Math.max(0,V[Et].g-100),We=!1;else try{M="req"+M+"_"||"";try{var X=Cn instanceof Map?Cn:Object.entries(Cn);for(const[nr,vs]of X){let Es=vs;l(vs)&&(Es=xe(vs)),pt.push(M+nr+"="+encodeURIComponent(Es))}}catch(nr){throw pt.push(M+"type="+encodeURIComponent("_badmap")),nr}}catch{y&&y(Cn)}}if(We){X=pt.join("&");break e}}X=void 0}return a=a.i.splice(0,p),d.G=a,X}function Xf(a){if(!a.g&&!a.v){a.Y=1;var d=a.Da;j||v(),Y||(j(),Y=!0),I.add(d,a),a.A=0}}function du(a){return a.g||a.v||a.A>=3?!1:(a.Y++,a.v=Ji(u(a.Da,a),tp(a,a.A)),a.A++,!0)}n.Da=function(){if(this.v=null,Zf(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=Ji(u(this.Wa,this),a)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Bt(10),qa(this),Zf(this))};function fu(a){a.B!=null&&(o.clearTimeout(a.B),a.B=null)}function Zf(a){a.g=new ms(a,a.j,"rpc",a.Y),a.u===null&&(a.g.J=a.o),a.g.P=0;var d=Pn(a.na);et(d,"RID","rpc"),et(d,"SID",a.M),et(d,"AID",a.K),et(d,"CI",a.F?"0":"1"),!a.F&&a.ia&&et(d,"TO",a.ia),et(d,"TYPE","xmlhttp"),co(a,d),a.u&&a.o&&uu(d,a.u,a.o),a.O&&(a.g.H=a.O);var p=a.g;a=a.ba,p.M=1,p.A=Ba(Pn(d)),p.u=null,p.R=!0,Rf(p,a)}n.Va=function(){this.C!=null&&(this.C=null,qa(this),du(this),Bt(19))};function Ga(a){a.C!=null&&(o.clearTimeout(a.C),a.C=null)}function ep(a,d){var p=null;if(a.g==d){Ga(a),fu(a),a.g=null;var y=2}else if(ou(a.h,d))p=d.G,Vf(a.h,d),y=1;else return;if(a.I!=0){if(d.o)if(y==1){p=d.u?d.u.length:0,d=Date.now()-d.F;var V=a.D;y=Xs(),z(y,new Tf(y,p)),Ka(a)}else Xf(a);else if(V=d.m,V==3||V==0&&d.X>0||!(y==1&&xT(a,d)||y==2&&du(a)))switch(p&&p.length>0&&(d=a.h,d.i=d.i.concat(p)),V){case 1:tr(a,5);break;case 4:tr(a,10);break;case 3:tr(a,6);break;default:tr(a,2)}}}function tp(a,d){let p=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(p*=2),p*d}function tr(a,d){if(a.j.info("Error code "+d),d==2){var p=u(a.bb,a),y=a.Ua;const V=!y;y=new gs(y||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||to(y,"https"),Ba(y),V?PT(y.toString(),p):CT(y.toString(),p)}else Bt(2);a.I=0,a.l&&a.l.pa(d),np(a),Qf(a)}n.bb=function(a){a?(this.j.info("Successfully pinged google.com"),Bt(2)):(this.j.info("Failed to ping google.com"),Bt(1))};function np(a){if(a.I=0,a.ja=[],a.l){const d=xf(a.h);(d.length!=0||a.i.length!=0)&&(R(a.ja,d),R(a.ja,a.i),a.h.i.length=0,_(a.i),a.i.length=0),a.l.oa()}}function sp(a,d,p){var y=p instanceof gs?Pn(p):new gs(p);if(y.g!="")d&&(y.g=d+"."+y.g),no(y,y.u);else{var V=o.location;y=V.protocol,d=d?d+"."+V.hostname:V.hostname,V=+V.port;const M=new gs(null);y&&to(M,y),d&&(M.g=d),V&&no(M,V),p&&(M.h=p),y=M}return p=a.G,d=a.wa,p&&d&&et(y,p,d),et(y,"VER",a.ka),co(a,y),y}function rp(a,d,p){if(d&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Aa&&!a.ma?new rt(new cu({ab:p})):new rt(a.ma),d.Fa(a.L),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ip(){}n=ip.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function za(){}za.prototype.g=function(a,d){return new Zt(a,d)};function Zt(a,d){H.call(this),this.g=new Wf(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.sa&&(a?a["X-WebChannel-Client-Profile"]=d.sa:a={"X-WebChannel-Client-Profile":d.sa}),this.g.U=a,(a=d&&d.Qb)&&!T(a)&&(this.g.u=a),this.A=d&&d.supportsCrossDomainXhr||!1,this.v=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!T(d)&&(this.g.G=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new Gr(this)}f(Zt,H),Zt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Zt.prototype.close=function(){hu(this.g)},Zt.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var p={};p.__data__=a,a=p}else this.v&&(p={},p.__data__=xe(a),a=p);d.i.push(new ET(d.Ya++,a)),d.I==3&&Ka(d)},Zt.prototype.N=function(){this.g.l=null,delete this.j,hu(this.g),delete this.g,Zt.Z.N.call(this)};function op(a){jr.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){e:{for(const p in d){a=p;break e}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}f(op,jr);function ap(){wt.call(this),this.status=1}f(ap,wt);function Gr(a){this.g=a}f(Gr,ip),Gr.prototype.ra=function(){z(this.g,"a")},Gr.prototype.qa=function(a){z(this.g,new op(a))},Gr.prototype.pa=function(a){z(this.g,new ap)},Gr.prototype.oa=function(){z(this.g,"b")},za.prototype.createWebChannel=za.prototype.g,Zt.prototype.send=Zt.prototype.o,Zt.prototype.open=Zt.prototype.m,Zt.prototype.close=Zt.prototype.close,mv=function(){return new za},pv=function(){return Xs()},fv=vt,dh={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Fa.NO_ERROR=0,Fa.TIMEOUT=8,Fa.HTTP_ERROR=6,gl=Fa,wf.COMPLETE="complete",dv=wf,Xt.EventType=pn,pn.OPEN="a",pn.CLOSE="b",pn.ERROR="c",pn.MESSAGE="d",H.prototype.listen=H.prototype.J,bo=Xt,rt.prototype.listenOnce=rt.prototype.K,rt.prototype.getLastError=rt.prototype.Ha,rt.prototype.getLastErrorCode=rt.prototype.ya,rt.prototype.getStatus=rt.prototype.ca,rt.prototype.getResponseJson=rt.prototype.La,rt.prototype.getResponseText=rt.prototype.la,rt.prototype.send=rt.prototype.ea,rt.prototype.setWithCredentials=rt.prototype.Fa,hv=rt}).apply(typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{});const _m="@firebase/firestore",ym="4.9.3";class qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qt.UNAUTHENTICATED=new qt(null),qt.GOOGLE_CREDENTIALS=new qt("google-credentials-uid"),qt.FIRST_PARTY=new qt("first-party-uid"),qt.MOCK_USER=new qt("mock-user");let Ki="12.7.0";const Cr=new ud("@firebase/firestore");function ei(){return Cr.logLevel}function Q(n,...e){if(Cr.logLevel<=ke.DEBUG){const t=e.map(wd);Cr.debug(`Firestore (${Ki}): ${n}`,...t)}}function Gt(n,...e){if(Cr.logLevel<=ke.ERROR){const t=e.map(wd);Cr.error(`Firestore (${Ki}): ${n}`,...t)}}function na(n,...e){if(Cr.logLevel<=ke.WARN){const t=e.map(wd);Cr.warn(`Firestore (${Ki}): ${n}`,...t)}}function wd(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function ce(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,gv(n,s,t)}function gv(n,e,t){let s=`FIRESTORE (${Ki}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Gt(s),new Error(s)}function he(n,e,t,s){let r="Unexpected state";typeof t=="string"?r=t:s=t,n||gv(e,r,s)}function Te(n,e){return n}const q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ae extends fs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ns{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class G0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class z0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(qt.UNAUTHENTICATED)))}shutdown(){}}class H0{constructor(e){this.t=e,this.currentUser=qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){he(this.o===void 0,42304);let s=this.i;const r=c=>this.i!==s?(s=this.i,t(c)):Promise.resolve();let i=new ns;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ns,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const c=i;e.enqueueRetryable((async()=>{await c.promise,await r(this.currentUser)}))},l=c=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>l(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ns)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(he(typeof s.accessToken=="string",31837,{l:s}),new G0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return he(e===null||typeof e=="string",2055,{h:e}),new qt(e)}}class W0{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=qt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Q0{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new W0(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(qt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class vm{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Y0{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_n(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){he(this.o===void 0,3512);const s=i=>{i.error!=null&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>s(i)))};const r=i=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>r(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new vm(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(he(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new vm(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function J0(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}class bd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=J0(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<t&&(s+=e.charAt(r[i]%62))}return s}}function Ie(n,e){return n<e?-1:n>e?1:0}function fh(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=n.charAt(s),i=e.charAt(s);if(r!==i)return Du(r)===Du(i)?Ie(r,i):Du(r)?1:-1}return Ie(n.length,e.length)}const X0=55296,Z0=57343;function Du(n){const e=n.charCodeAt(0);return e>=X0&&e<=Z0}function bi(n,e,t){return n.length===e.length&&n.every(((s,r)=>t(s,e[r])))}function _v(n){return n+"\0"}const Em="__name__";class Dn{constructor(e,t,s){t===void 0?t=0:t>e.length&&ce(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&ce(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Dn.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Dn?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let r=0;r<s;r++){const i=Dn.compareSegments(e.get(r),t.get(r));if(i!==0)return i}return Ie(e.length,t.length)}static compareSegments(e,t){const s=Dn.isNumericId(e),r=Dn.isNumericId(t);return s&&!r?-1:!s&&r?1:s&&r?Dn.extractNumericId(e).compare(Dn.extractNumericId(t)):fh(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $s.fromString(e.substring(4,e.length-2))}}class ze extends Dn{construct(e,t,s){return new ze(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new ae(q.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((r=>r.length>0)))}return new ze(t)}static emptyPath(){return new ze([])}}const e1=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class st extends Dn{construct(e,t,s){return new st(e,t,s)}static isValidIdentifier(e){return e1.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),st.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Em}static keyField(){return new st([Em])}static fromServerFormat(e){const t=[];let s="",r=0;const i=()=>{if(s.length===0)throw new ae(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new ae(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ae(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(s+=l,r++):(i(),r++)}if(i(),o)throw new ae(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new st(t)}static emptyPath(){return new st([])}}class ne{constructor(e){this.path=e}static fromPath(e){return new ne(ze.fromString(e))}static fromName(e){return new ne(ze.fromString(e).popFirst(5))}static empty(){return new ne(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ne(new ze(e.slice()))}}function t1(n,e,t){if(!t)throw new ae(q.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function n1(n,e,t,s){if(e===!0&&s===!0)throw new ae(q.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Im(n){if(!ne.isDocumentKey(n))throw new ae(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function yv(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Ad(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ce(12329,{type:typeof n})}function js(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ae(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ad(n);throw new ae(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ut(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ra(n,e){if(!yv(n))throw new ae(q.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const o=n[s];if(r&&typeof o!==r){t=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${s}' field to equal '${i.value}'`;break}}if(t)throw new ae(q.INVALID_ARGUMENT,t);return!0}const Tm=-62135596800,wm=1e6;class qe{static now(){return qe.fromMillis(Date.now())}static fromDate(e){return qe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*wm);return new qe(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ae(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ae(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Tm)throw new ae(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ae(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wm}_compareTo(e){return this.seconds===e.seconds?Ie(this.nanoseconds,e.nanoseconds):Ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ra(e,qe._jsonSchema))return new qe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Tm;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qe._jsonSchemaVersion="firestore/timestamp/1.0",qe._jsonSchema={type:ut("string",qe._jsonSchemaVersion),seconds:ut("number"),nanoseconds:ut("number")};class me{static fromTimestamp(e){return new me(e)}static min(){return new me(new qe(0,0))}static max(){return new me(new qe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const sa=-1;class Gl{constructor(e,t,s,r){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=r}}function ph(n){return n.fields.find((e=>e.kind===2))}function lr(n){return n.fields.filter((e=>e.kind!==2))}Gl.UNKNOWN_ID=-1;class _l{constructor(e,t){this.fieldPath=e,this.kind=t}}class ra{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ra(0,on.min())}}function s1(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,r=me.fromTimestamp(s===1e9?new qe(t+1,0):new qe(t,s));return new on(r,ne.empty(),e)}function vv(n){return new on(n.readTime,n.key,sa)}class on{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new on(me.min(),ne.empty(),sa)}static max(){return new on(me.max(),ne.empty(),sa)}}function Sd(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ne.comparator(n.documentKey,e.documentKey),t!==0?t:Ie(n.largestBatchId,e.largestBatchId))}const Ev="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Iv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Fr(n){if(n.code!==q.FAILED_PRECONDITION||n.message!==Ev)throw n;Q("LocalStore","Unexpectedly lost primary lease")}class N{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ce(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new N(((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(t,i).next(s,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof N?t:N.resolve(t)}catch(t){return N.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):N.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):N.reject(t)}static resolve(e){return new N(((t,s)=>{t(e)}))}static reject(e){return new N(((t,s)=>{s(e)}))}static waitFor(e){return new N(((t,s)=>{let r=0,i=0,o=!1;e.forEach((l=>{++r,l.next((()=>{++i,o&&i===r&&t()}),(c=>s(c)))})),o=!0,i===r&&t()}))}static or(e){let t=N.resolve(!1);for(const s of e)t=t.next((r=>r?N.resolve(r):s()));return t}static forEach(e,t){const s=[];return e.forEach(((r,i)=>{s.push(t.call(this,r,i))})),this.waitFor(s)}static mapArray(e,t){return new N(((s,r)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;t(e[u]).next((h=>{o[u]=h,++l,l===i&&s(o)}),(h=>r(h)))}}))}static doWhile(e,t){return new N(((s,r)=>{const i=()=>{e()===!0?t().next((()=>{i()}),r):s()};i()}))}}const tn="SimpleDb";class Nc{static open(e,t,s,r){try{return new Nc(t,e.transaction(r,s))}catch(i){throw new Fo(t,i)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ns,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Fo(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const r=Rd(s.target.error);this.S.reject(new Fo(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Q(tn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new i1(t)}}class qs{static delete(e){return Q(tn,"Removing database:",e),ur(Iy().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Py())return!1;if(qs.F())return!0;const e=_t(),t=qs.M(e),s=0<t&&t<10,r=Tv(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,qs.M(_t())===12.2&&Gt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Q(tn,"Opening database:",this.name),this.db=await new Promise(((t,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;t(o)},r.onblocked=()=>{s(new Fo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new ae(q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new ae(q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new Fo(e,o))},r.onupgradeneeded=i=>{Q(tn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,r.transaction,i.oldVersion,this.version).next((()=>{Q(tn,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,r){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const l=Nc.open(this.db,e,i?"readonly":"readwrite",s),c=r(l).next((u=>(l.C(),u))).catch((u=>(l.abort(u),N.reject(u)))).toPromise();return c.catch((()=>{})),await l.D,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Q(tn,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Tv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class r1{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ur(this.U.delete())}}class Fo extends ae{constructor(e,t){super(q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ws(n){return n.name==="IndexedDbTransactionError"}class i1{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(Q(tn,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(Q(tn,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),ur(s)}add(e){return Q(tn,"ADD",this.store.name,e,e),ur(this.store.add(e))}get(e){return ur(this.store.get(e)).next((t=>(t===void 0&&(t=null),Q(tn,"GET",this.store.name,e,t),t)))}delete(e){return Q(tn,"DELETE",this.store.name,e),ur(this.store.delete(e))}count(){return Q(tn,"COUNT",this.store.name),ur(this.store.count())}J(e,t){const s=this.options(e,t),r=s.index?this.store.index(s.index):this.store;if(typeof r.getAll=="function"){const i=r.getAll(s.range);return new N(((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}}))}{const i=this.cursor(s),o=[];return this.H(i,((l,c)=>{o.push(c)})).next((()=>o))}}Y(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new N(((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}}))}Z(e,t){Q(tn,"DELETE ALL",this.store.name);const s=this.options(e,t);s.X=!1;const r=this.cursor(s);return this.H(r,((i,o,l)=>l.delete()))}ee(e,t){let s;t?s=e:(s={},t=e);const r=this.cursor(s);return this.H(r,t)}te(e){const t=this.cursor({});return new N(((s,r)=>{t.onerror=i=>{const o=Rd(i.target.error);r(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next((l=>{l?o.continue():s()})):s()}}))}H(e,t){const s=[];return new N(((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const c=new r1(l),u=t(l.primaryKey,l.value,c);if(u instanceof N){const h=u.catch((f=>(c.done(),N.reject(f))));s.push(h)}c.isDone?r():c.G===null?l.continue():l.continue(c.G)}})).next((()=>N.waitFor(s)))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ur(n){return new N(((e,t)=>{n.onsuccess=s=>{const r=s.target.result;e(r)},n.onerror=s=>{const r=Rd(s.target.error);t(r)}}))}let bm=!1;function Rd(n){const e=qs.M(_t());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new ae("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return bm||(bm=!0,setTimeout((()=>{throw s}),0)),s}}return n}const Uo="IndexBackfiller";class o1{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Q(Uo,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Q(Uo,`Documents written: ${t}`)}catch(t){Ws(t)?Q(Uo,"Ignoring IndexedDB error during index backfill: ",t):await Fr(t)}await this.re(6e4)}))}}class a1{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const s=new Set;let r=t,i=!0;return N.doWhile((()=>i===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!s.has(o))return Q(Uo,`Processing collection: ${o}`),this.oe(e,o,r).next((l=>{r-=l,s.add(o)}));i=!1})))).next((()=>t-r))}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,s).next((i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(r,i))).next((l=>(Q(Uo,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l)))).next((()=>o.size))}))))}_e(e,t){let s=e;return t.changes.forEach(((r,i)=>{const o=vv(i);Sd(o,s)>0&&(s=o)})),new on(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}class cn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}cn.ce=-1;const Ir=-1;function Dc(n){return n==null}function ia(n){return n===0&&1/n==-1/0}function l1(n){return typeof n=="number"&&Number.isInteger(n)&&!ia(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const zl="";function Mt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Am(e)),e=c1(n.get(t),e);return Am(e)}function c1(n,e){let t=e;const s=n.length;for(let r=0;r<s;r++){const i=n.charAt(r);switch(i){case"\0":t+="";break;case zl:t+="";break;default:t+=i}}return t}function Am(n){return n+zl+""}function xn(n){const e=n.length;if(he(e>=2,64408,{path:n}),e===2)return he(n.charAt(0)===zl&&n.charAt(1)==="",56145,{path:n}),ze.emptyPath();const t=e-2,s=[];let r="";for(let i=0;i<e;){const o=n.indexOf(zl,i);switch((o<0||o>t)&&ce(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(i,o);let c;r.length===0?c=l:(r+=l,c=r,r=""),s.push(c);break;case"":r+=n.substring(i,o),r+="\0";break;case"":r+=n.substring(i,o+1);break;default:ce(61167,{path:n})}i=o+2}return new ze(s)}const cr="remoteDocuments",Pa="owner",Hr="owner",oa="mutationQueues",u1="userId",gn="mutations",Sm="batchId",mr="userMutationsIndex",Rm=["userId","batchId"];function yl(n,e){return[n,Mt(e)]}function wv(n,e,t){return[n,Mt(e),t]}const h1={},Ai="documentMutations",Hl="remoteDocumentsV14",d1=["prefixPath","collectionGroup","readTime","documentId"],vl="documentKeyIndex",f1=["prefixPath","collectionGroup","documentId"],bv="collectionGroupIndex",p1=["collectionGroup","readTime","prefixPath","documentId"],aa="remoteDocumentGlobal",mh="remoteDocumentGlobalKey",Si="targets",Av="queryTargetsIndex",m1=["canonicalId","targetId"],Ri="targetDocuments",g1=["targetId","path"],Pd="documentTargetsIndex",_1=["path","targetId"],Wl="targetGlobalKey",Tr="targetGlobal",la="collectionParents",y1=["collectionId","parent"],Pi="clientMetadata",v1="clientId",Vc="bundles",E1="bundleId",xc="namedQueries",I1="name",Cd="indexConfiguration",T1="indexId",gh="collectionGroupIndex",w1="collectionGroup",Bo="indexState",b1=["indexId","uid"],Sv="sequenceNumberIndex",A1=["uid","sequenceNumber"],$o="indexEntries",S1=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Rv="documentKeyIndex",R1=["indexId","uid","orderedDocumentKey"],Oc="documentOverlays",P1=["userId","collectionPath","documentId"],_h="collectionPathOverlayIndex",C1=["userId","collectionPath","largestBatchId"],Pv="collectionGroupOverlayIndex",k1=["userId","collectionGroup","largestBatchId"],kd="globals",N1="name",Cv=[oa,gn,Ai,cr,Si,Pa,Tr,Ri,Pi,aa,la,Vc,xc],D1=[...Cv,Oc],kv=[oa,gn,Ai,Hl,Si,Pa,Tr,Ri,Pi,aa,la,Vc,xc,Oc],Nv=kv,Nd=[...Nv,Cd,Bo,$o],V1=Nd,Dv=[...Nd,kd],x1=Dv;class yh extends Iv{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function yt(n,e){const t=Te(n);return qs.O(t.le,e)}function Pm(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ur(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Vv(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class nt{constructor(e,t){this.comparator=e,this.root=t||bt.EMPTY}insert(e,t){return new nt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,bt.BLACK,null,null))}remove(e){return new nt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return t+s.left.size;r<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new el(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new el(this.root,e,this.comparator,!1)}getReverseIterator(){return new el(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new el(this.root,e,this.comparator,!0)}}class el{constructor(e,t,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?s(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class bt{constructor(e,t,s,r,i){this.key=e,this.value=t,this.color=s??bt.RED,this.left=r??bt.EMPTY,this.right=i??bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,r,i){return new bt(e??this.key,t??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,s),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return bt.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ce(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ce(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ce(27949);return e+(this.isRed()?0:1)}}bt.EMPTY=null,bt.RED=!0,bt.BLACK=!1;bt.EMPTY=new class{constructor(){this.size=0}get key(){throw ce(57766)}get value(){throw ce(16141)}get color(){throw ce(16727)}get left(){throw ce(29726)}get right(){throw ce(36894)}copy(e,t,s,r,i){return this}insert(e,t,s){return new bt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ke{constructor(e){this.comparator=e,this.data=new nt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Cm(this.data.getIterator())}getIteratorFrom(e){return new Cm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Ke)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ke(this.comparator);return t.data=e,t}}class Cm{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Wr(n){return n.hasNext()?n.getNext():void 0}class un{constructor(e){this.fields=e,e.sort(st.comparator)}static empty(){return new un([])}unionWith(e){let t=new Ke(st.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new un(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return bi(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}class xv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class dt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new xv("Invalid base64 string: "+i):i}})(e);return new dt(t)}static fromUint8Array(e){const t=(function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i})(e);return new dt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}dt.EMPTY_BYTE_STRING=new dt("");const O1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function us(n){if(he(!!n,39018),typeof n=="string"){let e=0;const t=O1.exec(n);if(he(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:tt(n.seconds),nanos:tt(n.nanos)}}function tt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function hs(n){return typeof n=="string"?dt.fromBase64String(n):dt.fromUint8Array(n)}const Ov="server_timestamp",Mv="__type__",Lv="__previous_value__",Fv="__local_write_time__";function Dd(n){return(n?.mapValue?.fields||{})[Mv]?.stringValue===Ov}function Mc(n){const e=n.mapValue.fields[Lv];return Dd(e)?Mc(e):e}function ca(n){const e=us(n.mapValue.fields[Fv].timestampValue);return new qe(e.seconds,e.nanos)}class M1{constructor(e,t,s,r,i,o,l,c,u,h){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const Ql="(default)";class kr{constructor(e,t){this.projectId=e,this.database=t||Ql}static empty(){return new kr("","")}get isDefaultDatabase(){return this.database===Ql}isEqual(e){return e instanceof kr&&e.projectId===this.projectId&&e.database===this.database}}const Vd="__type__",Uv="__max__",Ms={mapValue:{fields:{__type__:{stringValue:Uv}}}},xd="__vector__",Ci="value",El={nullValue:"NULL_VALUE"};function Ks(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Dd(n)?4:Bv(n)?9007199254740991:Lc(n)?10:11:ce(28295,{value:n})}function Kn(n,e){if(n===e)return!0;const t=Ks(n);if(t!==Ks(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ca(n).isEqual(ca(e));case 3:return(function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=us(r.timestampValue),l=us(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,i){return hs(r.bytesValue).isEqual(hs(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,i){return tt(r.geoPointValue.latitude)===tt(i.geoPointValue.latitude)&&tt(r.geoPointValue.longitude)===tt(i.geoPointValue.longitude)})(n,e);case 2:return(function(r,i){if("integerValue"in r&&"integerValue"in i)return tt(r.integerValue)===tt(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=tt(r.doubleValue),l=tt(i.doubleValue);return o===l?ia(o)===ia(l):isNaN(o)&&isNaN(l)}return!1})(n,e);case 9:return bi(n.arrayValue.values||[],e.arrayValue.values||[],Kn);case 10:case 11:return(function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(Pm(o)!==Pm(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Kn(o[c],l[c])))return!1;return!0})(n,e);default:return ce(52216,{left:n})}}function ua(n,e){return(n.values||[]).find((t=>Kn(t,e)))!==void 0}function Gs(n,e){if(n===e)return 0;const t=Ks(n),s=Ks(e);if(t!==s)return Ie(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ie(n.booleanValue,e.booleanValue);case 2:return(function(i,o){const l=tt(i.integerValue||i.doubleValue),c=tt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1})(n,e);case 3:return km(n.timestampValue,e.timestampValue);case 4:return km(ca(n),ca(e));case 5:return fh(n.stringValue,e.stringValue);case 6:return(function(i,o){const l=hs(i),c=hs(o);return l.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=Ie(l[u],c[u]);if(h!==0)return h}return Ie(l.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,o){const l=Ie(tt(i.latitude),tt(o.latitude));return l!==0?l:Ie(tt(i.longitude),tt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Nm(n.arrayValue,e.arrayValue);case 10:return(function(i,o){const l=i.fields||{},c=o.fields||{},u=l[Ci]?.arrayValue,h=c[Ci]?.arrayValue,f=Ie(u?.values?.length||0,h?.values?.length||0);return f!==0?f:Nm(u,h)})(n.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Ms.mapValue&&o===Ms.mapValue)return 0;if(i===Ms.mapValue)return 1;if(o===Ms.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){const m=fh(c[f],h[f]);if(m!==0)return m;const _=Gs(l[c[f]],u[h[f]]);if(_!==0)return _}return Ie(c.length,h.length)})(n.mapValue,e.mapValue);default:throw ce(23264,{he:t})}}function km(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ie(n,e);const t=us(n),s=us(e),r=Ie(t.seconds,s.seconds);return r!==0?r:Ie(t.nanos,s.nanos)}function Nm(n,e){const t=n.values||[],s=e.values||[];for(let r=0;r<t.length&&r<s.length;++r){const i=Gs(t[r],s[r]);if(i)return i}return Ie(t.length,s.length)}function ki(n){return vh(n)}function vh(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=us(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return hs(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ne.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",r=!0;for(const i of t.values||[])r?r=!1:s+=",",s+=vh(i);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${vh(t.fields[o])}`;return r+"}"})(n.mapValue):ce(61005,{value:n})}function Il(n){switch(Ks(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Mc(n);return e?16+Il(e):16;case 5:return 2*n.stringValue.length;case 6:return hs(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((r,i)=>r+Il(i)),0)})(n.arrayValue);case 10:case 11:return(function(s){let r=0;return Ur(s.fields,((i,o)=>{r+=i.length+Il(o)})),r})(n.mapValue);default:throw ce(13486,{value:n})}}function Od(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Eh(n){return!!n&&"integerValue"in n}function ha(n){return!!n&&"arrayValue"in n}function Dm(n){return!!n&&"nullValue"in n}function Vm(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Tl(n){return!!n&&"mapValue"in n}function Lc(n){return(n?.mapValue?.fields||{})[Vd]?.stringValue===xd}function jo(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ur(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=jo(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=jo(n.arrayValue.values[t]);return e}return{...n}}function Bv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Uv}const $v={mapValue:{fields:{[Vd]:{stringValue:xd},[Ci]:{arrayValue:{}}}}};function L1(n){return"nullValue"in n?El:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Od(kr.empty(),ne.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Lc(n)?$v:{mapValue:{}}:ce(35942,{value:n})}function F1(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Od(kr.empty(),ne.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?$v:"mapValue"in n?Lc(n)?{mapValue:{}}:Ms:ce(61959,{value:n})}function xm(n,e){const t=Gs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Om(n,e){const t=Gs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Wt{constructor(e){this.value=e}static empty(){return new Wt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Tl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=jo(t)}setAll(e){let t=st.emptyPath(),s={},r=[];e.forEach(((o,l)=>{if(!t.isImmediateParentOf(l)){const c=this.getFieldsMap(t);this.applyChanges(c,s,r),s={},r=[],t=l.popLast()}o?s[l.lastSegment()]=jo(o):r.push(l.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,s,r)}delete(e){const t=this.field(e.popLast());Tl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Kn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=t.mapValue.fields[e.get(s)];Tl(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,s){Ur(t,((r,i)=>e[r]=i));for(const r of s)delete e[r]}clone(){return new Wt(jo(this.value))}}function jv(n){const e=[];return Ur(n.fields,((t,s)=>{const r=new st([t]);if(Tl(s)){const i=jv(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)})),new un(e)}class ot{constructor(e,t,s,r,i,o,l){this.key=e,this.documentType=t,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ot(e,0,me.min(),me.min(),me.min(),Wt.empty(),0)}static newFoundDocument(e,t,s,r){return new ot(e,1,t,me.min(),s,r,0)}static newNoDocument(e,t){return new ot(e,2,t,me.min(),me.min(),Wt.empty(),0)}static newUnknownDocument(e,t){return new ot(e,3,t,me.min(),me.min(),Wt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ot&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ot(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ni{constructor(e,t){this.position=e,this.inclusive=t}}function Mm(n,e,t){let s=0;for(let r=0;r<n.position.length;r++){const i=e[r],o=n.position[r];if(i.field.isKeyField()?s=ne.comparator(ne.fromName(o.referenceValue),t.key):s=Gs(o,t.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function Lm(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Kn(n.position[t],e.position[t]))return!1;return!0}class Yl{constructor(e,t="asc"){this.field=e,this.dir=t}}function U1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class qv{}class Ne extends qv{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new B1(e,t,s):t==="array-contains"?new q1(e,s):t==="in"?new Qv(e,s):t==="not-in"?new K1(e,s):t==="array-contains-any"?new G1(e,s):new Ne(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new $1(e,s):new j1(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Gs(t,this.value)):t!==null&&Ks(this.value)===Ks(t)&&this.matchesComparison(Gs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ce(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class He extends qv{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new He(e,t)}matches(e){return Di(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Di(n){return n.op==="and"}function Ih(n){return n.op==="or"}function Md(n){return Kv(n)&&Di(n)}function Kv(n){for(const e of n.filters)if(e instanceof He)return!1;return!0}function Th(n){if(n instanceof Ne)return n.field.canonicalString()+n.op.toString()+ki(n.value);if(Md(n))return n.filters.map((e=>Th(e))).join(",");{const e=n.filters.map((t=>Th(t))).join(",");return`${n.op}(${e})`}}function Gv(n,e){return n instanceof Ne?(function(s,r){return r instanceof Ne&&s.op===r.op&&s.field.isEqual(r.field)&&Kn(s.value,r.value)})(n,e):n instanceof He?(function(s,r){return r instanceof He&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce(((i,o,l)=>i&&Gv(o,r.filters[l])),!0):!1})(n,e):void ce(19439)}function zv(n,e){const t=n.filters.concat(e);return He.create(t,n.op)}function Hv(n){return n instanceof Ne?(function(t){return`${t.field.canonicalString()} ${t.op} ${ki(t.value)}`})(n):n instanceof He?(function(t){return t.op.toString()+" {"+t.getFilters().map(Hv).join(" ,")+"}"})(n):"Filter"}class B1 extends Ne{constructor(e,t,s){super(e,t,s),this.key=ne.fromName(s.referenceValue)}matches(e){const t=ne.comparator(e.key,this.key);return this.matchesComparison(t)}}class $1 extends Ne{constructor(e,t){super(e,"in",t),this.keys=Wv("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class j1 extends Ne{constructor(e,t){super(e,"not-in",t),this.keys=Wv("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Wv(n,e){return(e.arrayValue?.values||[]).map((t=>ne.fromName(t.referenceValue)))}class q1 extends Ne{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ha(t)&&ua(t.arrayValue,this.value)}}class Qv extends Ne{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ua(this.value.arrayValue,t)}}class K1 extends Ne{constructor(e,t){super(e,"not-in",t)}matches(e){if(ua(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ua(this.value.arrayValue,t)}}class G1 extends Ne{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ha(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>ua(this.value.arrayValue,s)))}}class z1{constructor(e,t=null,s=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function wh(n,e=null,t=[],s=[],r=null,i=null,o=null){return new z1(n,e,t,s,r,i,o)}function Nr(n){const e=Te(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Th(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(i){return i.field.canonicalString()+i.dir})(s))).join(","),Dc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>ki(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>ki(s))).join(",")),e.Te=t}return e.Te}function Ca(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!U1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Gv(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Lm(n.startAt,e.startAt)&&Lm(n.endAt,e.endAt)}function Jl(n){return ne.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Xl(n,e){return n.filters.filter((t=>t instanceof Ne&&t.field.isEqual(e)))}function Fm(n,e,t){let s=El,r=!0;for(const i of Xl(n,e)){let o=El,l=!0;switch(i.op){case"<":case"<=":o=L1(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=El}xm({value:s,inclusive:r},{value:o,inclusive:l})<0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];xm({value:s,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}function Um(n,e,t){let s=Ms,r=!0;for(const i of Xl(n,e)){let o=Ms,l=!0;switch(i.op){case">=":case">":o=F1(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Ms}Om({value:s,inclusive:r},{value:o,inclusive:l})>0&&(s=o,r=l)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];Om({value:s,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(s=o,r=t.inclusive);break}}return{value:s,inclusive:r}}class Fc{constructor(e,t=null,s=[],r=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function H1(n,e,t,s,r,i,o,l){return new Fc(n,e,t,s,r,i,o,l)}function ka(n){return new Fc(n)}function Bm(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function W1(n){return n.collectionGroup!==null}function qo(n){const e=Te(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ke(st.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((u=>{u.isInequality()&&(l=l.add(u.field))}))})),l})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Yl(i,s))})),t.has(st.keyField().canonicalString())||e.Ie.push(new Yl(st.keyField(),s))}return e.Ie}function dn(n){const e=Te(n);return e.Ee||(e.Ee=Q1(e,qo(n))),e.Ee}function Q1(n,e){if(n.limitType==="F")return wh(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const i=r.dir==="desc"?"asc":"desc";return new Yl(r.field,i)}));const t=n.endAt?new Ni(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Ni(n.startAt.position,n.startAt.inclusive):null;return wh(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function bh(n,e,t){return new Fc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Uc(n,e){return Ca(dn(n),dn(e))&&n.limitType===e.limitType}function Yv(n){return`${Nr(dn(n))}|lt:${n.limitType}`}function ti(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((r=>Hv(r))).join(", ")}]`),Dc(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((r=>ki(r))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((r=>ki(r))).join(",")),`Target(${s})`})(dn(n))}; limitType=${n.limitType})`}function Na(n,e){return e.isFoundDocument()&&(function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):ne.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)})(n,e)&&(function(s,r){for(const i of qo(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0})(n,e)&&(function(s,r){return!(s.startAt&&!(function(o,l,c){const u=Mm(o,l,c);return o.inclusive?u<=0:u<0})(s.startAt,qo(s),r)||s.endAt&&!(function(o,l,c){const u=Mm(o,l,c);return o.inclusive?u>=0:u>0})(s.endAt,qo(s),r))})(n,e)}function Y1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Jv(n){return(e,t)=>{let s=!1;for(const r of qo(n)){const i=J1(r,e,t);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function J1(n,e,t){const s=n.field.isKeyField()?ne.comparator(e.key,t.key):(function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Gs(c,u):ce(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return ce(19790,{direction:n.dir})}}class ps{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[t]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ur(this.inner,((t,s)=>{for(const[r,i]of s)e(r,i)}))}isEmpty(){return Vv(this.inner)}size(){return this.innerSize}}const X1=new nt(ne.comparator);function sn(){return X1}const Xv=new nt(ne.comparator);function Ao(...n){let e=Xv;for(const t of n)e=e.insert(t.key,t);return e}function Zv(n){let e=Xv;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function On(){return Ko()}function eE(){return Ko()}function Ko(){return new ps((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Z1=new nt(ne.comparator),eP=new Ke(ne.comparator);function Se(...n){let e=eP;for(const t of n)e=e.add(t);return e}const tP=new Ke(Ie);function nP(){return tP}function Ld(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ia(e)?"-0":e}}function tE(n){return{integerValue:""+n}}function sP(n,e){return l1(e)?tE(e):Ld(n,e)}class Bc{constructor(){this._=void 0}}function rP(n,e,t){return n instanceof Vi?(function(r,i){const o={fields:{[Mv]:{stringValue:Ov},[Fv]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Dd(i)&&(i=Mc(i)),i&&(o.fields[Lv]=i),{mapValue:o}})(t,e):n instanceof xi?sE(n,e):n instanceof Oi?rE(n,e):(function(r,i){const o=nE(r,i),l=$m(o)+$m(r.Ae);return Eh(o)&&Eh(r.Ae)?tE(l):Ld(r.serializer,l)})(n,e)}function iP(n,e,t){return n instanceof xi?sE(n,e):n instanceof Oi?rE(n,e):t}function nE(n,e){return n instanceof da?(function(s){return Eh(s)||(function(i){return!!i&&"doubleValue"in i})(s)})(e)?e:{integerValue:0}:null}class Vi extends Bc{}class xi extends Bc{constructor(e){super(),this.elements=e}}function sE(n,e){const t=iE(e);for(const s of n.elements)t.some((r=>Kn(r,s)))||t.push(s);return{arrayValue:{values:t}}}class Oi extends Bc{constructor(e){super(),this.elements=e}}function rE(n,e){let t=iE(e);for(const s of n.elements)t=t.filter((r=>!Kn(r,s)));return{arrayValue:{values:t}}}class da extends Bc{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function $m(n){return tt(n.integerValue||n.doubleValue)}function iE(n){return ha(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class oE{constructor(e,t){this.field=e,this.transform=t}}function oP(n,e){return n.field.isEqual(e.field)&&(function(s,r){return s instanceof xi&&r instanceof xi||s instanceof Oi&&r instanceof Oi?bi(s.elements,r.elements,Kn):s instanceof da&&r instanceof da?Kn(s.Ae,r.Ae):s instanceof Vi&&r instanceof Vi})(n.transform,e.transform)}class aP{constructor(e,t){this.version=e,this.transformResults=t}}class Qt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Qt}static exists(e){return new Qt(void 0,e)}static updateTime(e){return new Qt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class $c{}function aE(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new jc(n.key,Qt.none()):new Gi(n.key,n.data,Qt.none());{const t=n.data,s=Wt.empty();let r=new Ke(st.comparator);for(let i of e.fields)if(!r.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new Qs(n.key,s,new un(r.toArray()),Qt.none())}}function lP(n,e,t){n instanceof Gi?(function(r,i,o){const l=r.value.clone(),c=qm(r.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):n instanceof Qs?(function(r,i,o){if(!wl(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=qm(r.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(lE(r)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Go(n,e,t,s){return n instanceof Gi?(function(i,o,l,c){if(!wl(i.precondition,o))return l;const u=i.value.clone(),h=Km(i.fieldTransforms,c,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null})(n,e,t,s):n instanceof Qs?(function(i,o,l,c){if(!wl(i.precondition,o))return l;const u=Km(i.fieldTransforms,c,o),h=o.data;return h.setAll(lE(i)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((f=>f.field)))})(n,e,t,s):(function(i,o,l){return wl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,e,t)}function cP(n,e){let t=null;for(const s of n.fieldTransforms){const r=e.data.field(s.field),i=nE(s.transform,r||null);i!=null&&(t===null&&(t=Wt.empty()),t.set(s.field,i))}return t||null}function jm(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&bi(s,r,((i,o)=>oP(i,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Gi extends $c{constructor(e,t,s,r=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Qs extends $c{constructor(e,t,s,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function lE(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function qm(n,e,t){const s=new Map;he(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const i=n[r],o=i.transform,l=e.data.field(i.field);s.set(i.field,iP(o,l,t[r]))}return s}function Km(n,e,t){const s=new Map;for(const r of n){const i=r.transform,o=t.data.field(r.field);s.set(r.field,rP(i,o,e))}return s}class jc extends $c{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class cE extends $c{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Fd{constructor(e,t,s,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&lP(i,e,s[r])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Go(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Go(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=eE();return this.mutations.forEach((r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=t.has(r.key)?null:l;const c=aE(o,l);c!==null&&s.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(me.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Se())}isEqual(e){return this.batchId===e.batchId&&bi(this.mutations,e.mutations,((t,s)=>jm(t,s)))&&bi(this.baseMutations,e.baseMutations,((t,s)=>jm(t,s)))}}class Ud{constructor(e,t,s,r){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=r}static from(e,t,s){he(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=(function(){return Z1})();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new Ud(e,t,s,r)}}class Bd{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class uP{constructor(e,t){this.count=e,this.unchangedNames=t}}var ct,De;function hP(n){switch(n){case q.OK:return ce(64938);case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0;default:return ce(15467,{code:n})}}function uE(n){if(n===void 0)return Gt("GRPC error has no .code"),q.UNKNOWN;switch(n){case ct.OK:return q.OK;case ct.CANCELLED:return q.CANCELLED;case ct.UNKNOWN:return q.UNKNOWN;case ct.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case ct.INTERNAL:return q.INTERNAL;case ct.UNAVAILABLE:return q.UNAVAILABLE;case ct.UNAUTHENTICATED:return q.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case ct.NOT_FOUND:return q.NOT_FOUND;case ct.ALREADY_EXISTS:return q.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return q.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case ct.ABORTED:return q.ABORTED;case ct.OUT_OF_RANGE:return q.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return q.UNIMPLEMENTED;case ct.DATA_LOSS:return q.DATA_LOSS;default:return ce(39323,{code:n})}}(De=ct||(ct={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";function dP(){return new TextEncoder}const fP=new $s([4294967295,4294967295],0);function Gm(n){const e=dP().encode(n),t=new uv;return t.update(e),new Uint8Array(t.digest())}function zm(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new $s([t,s],0),new $s([r,i],0)]}class $d{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new So(`Invalid padding: ${t}`);if(s<0)throw new So(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new So(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new So(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=$s.fromNumber(this.ge)}ye(e,t,s){let r=e.add(t.multiply($s.fromNumber(s)));return r.compare(fP)===1&&(r=new $s([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Gm(e),[s,r]=zm(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,t,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new $d(i,r,t);return s.forEach((l=>o.insert(l))),o}insert(e){if(this.ge===0)return;const t=Gm(e),[s,r]=zm(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class So extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class qc{constructor(e,t,s,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const r=new Map;return r.set(e,Da.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new qc(me.min(),r,new nt(Ie),sn(),Se())}}class Da{constructor(e,t,s,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Da(s,t,Se(),Se(),Se())}}class bl{constructor(e,t,s,r){this.be=e,this.removedTargetIds=t,this.key=s,this.De=r}}class hE{constructor(e,t){this.targetId=e,this.Ce=t}}class dE{constructor(e,t,s=dt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=r}}class Hm{constructor(){this.ve=0,this.Fe=Wm(),this.Me=dt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Se(),t=Se(),s=Se();return this.Fe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:s=s.add(r);break;default:ce(38017,{changeType:i})}})),new Da(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=Wm()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,he(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class pP{constructor(e){this.Ge=e,this.ze=new Map,this.je=sn(),this.Je=tl(),this.He=tl(),this.Ye=new nt(Ie)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:ce(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,s=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(Jl(i))if(s===0){const o=new ne(i.path);this.et(t,o,ot.newNoDocument(o,me.min()))}else he(s===1,20013,{expectedCount:s});else{const o=this._t(t);if(o!==s){const l=this.ut(e),c=l?this.ct(l,e,o):1;if(c!==0){this.it(t);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,u)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=t;let o,l;try{o=hs(s).toUint8Array()}catch(c){if(c instanceof xv)return na("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new $d(o,r,i)}catch(c){return na(c instanceof So?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let r=0;return s.forEach((i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(t,i,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((i,o)=>{const l=this.ot(o);if(l){if(i.current&&Jl(l.target)){const c=new ne(l.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,ot.newNoDocument(c,e))}i.Be&&(t.set(o,i.ke()),i.qe())}}));let s=Se();this.He.forEach(((i,o)=>{let l=!0;o.forEachWhile((c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(s=s.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const r=new qc(e,t,this.Ye,this.je,s);return this.je=sn(),this.Je=tl(),this.He=tl(),this.Ye=new nt(Ie),r}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Hm,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ke(Ie),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ke(Ie),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Q("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Hm),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function tl(){return new nt(ne.comparator)}function Wm(){return new nt(ne.comparator)}const mP={asc:"ASCENDING",desc:"DESCENDING"},gP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_P={and:"AND",or:"OR"};class yP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ah(n,e){return n.useProto3Json||Dc(e)?e:{value:e}}function Mi(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fE(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function vP(n,e){return Mi(n,e.toTimestamp())}function zt(n){return he(!!n,49232),me.fromTimestamp((function(t){const s=us(t);return new qe(s.seconds,s.nanos)})(n))}function jd(n,e){return Sh(n,e).canonicalString()}function Sh(n,e){const t=(function(r){return new ze(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function pE(n){const e=ze.fromString(n);return he(wE(e),10190,{key:e.toString()}),e}function Zl(n,e){return jd(n.databaseId,e.path)}function wr(n,e){const t=pE(e);if(t.get(1)!==n.databaseId.projectId)throw new ae(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ae(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ne(_E(t))}function mE(n,e){return jd(n.databaseId,e)}function gE(n){const e=pE(n);return e.length===4?ze.emptyPath():_E(e)}function Rh(n){return new ze(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function _E(n){return he(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Qm(n,e,t){return{name:Zl(n,e),fields:t.value.mapValue.fields}}function EP(n,e,t){const s=wr(n,e.name),r=zt(e.updateTime),i=e.createTime?zt(e.createTime):me.min(),o=new Wt({mapValue:{fields:e.fields}}),l=ot.newFoundDocument(s,r,i,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function IP(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ce(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=(function(u,h){return u.useProto3Json?(he(h===void 0||typeof h=="string",58123),dt.fromBase64String(h||"")):(he(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),dt.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&(function(u){const h=u.code===void 0?q.UNKNOWN:uE(u.code);return new ae(h,u.message||"")})(o);t=new dE(s,r,i,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=wr(n,s.document.name),i=zt(s.document.updateTime),o=s.document.createTime?zt(s.document.createTime):me.min(),l=new Wt({mapValue:{fields:s.document.fields}}),c=ot.newFoundDocument(r,i,o,l),u=s.targetIds||[],h=s.removedTargetIds||[];t=new bl(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=wr(n,s.document),i=s.readTime?zt(s.readTime):me.min(),o=ot.newNoDocument(r,i),l=s.removedTargetIds||[];t=new bl([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=wr(n,s.document),i=s.removedTargetIds||[];t=new bl([],i,r,null)}else{if(!("filter"in e))return ce(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new uP(r,i),l=s.targetId;t=new hE(l,o)}}return t}function ec(n,e){let t;if(e instanceof Gi)t={update:Qm(n,e.key,e.value)};else if(e instanceof jc)t={delete:Zl(n,e.key)};else if(e instanceof Qs)t={update:Qm(n,e.key,e.data),updateMask:RP(e.fieldMask)};else{if(!(e instanceof cE))return ce(16599,{Vt:e.type});t={verify:Zl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(i,o){const l=o.transform;if(l instanceof Vi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof xi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Oi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof da)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw ce(20930,{transform:o.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(r,i){return i.updateTime!==void 0?{updateTime:vP(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ce(27497)})(n,e.precondition)),t}function Ph(n,e){const t=e.currentDocument?(function(i){return i.updateTime!==void 0?Qt.updateTime(zt(i.updateTime)):i.exists!==void 0?Qt.exists(i.exists):Qt.none()})(e.currentDocument):Qt.none(),s=e.updateTransforms?e.updateTransforms.map((r=>(function(o,l){let c=null;if("setToServerValue"in l)he(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new Vi;else if("appendMissingElements"in l){const h=l.appendMissingElements.values||[];c=new xi(h)}else if("removeAllFromArray"in l){const h=l.removeAllFromArray.values||[];c=new Oi(h)}else"increment"in l?c=new da(o,l.increment):ce(16584,{proto:l});const u=st.fromServerFormat(l.fieldPath);return new oE(u,c)})(n,r))):[];if(e.update){e.update.name;const r=wr(n,e.update.name),i=new Wt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(c){const u=c.fieldPaths||[];return new un(u.map((h=>st.fromServerFormat(h))))})(e.updateMask);return new Qs(r,i,o,t,s)}return new Gi(r,i,t,s)}if(e.delete){const r=wr(n,e.delete);return new jc(r,t)}if(e.verify){const r=wr(n,e.verify);return new cE(r,t)}return ce(1463,{proto:e})}function TP(n,e){return n&&n.length>0?(he(e!==void 0,14353),n.map((t=>(function(r,i){let o=r.updateTime?zt(r.updateTime):zt(i);return o.isEqual(me.min())&&(o=zt(i)),new aP(o,r.transformResults||[])})(t,e)))):[]}function yE(n,e){return{documents:[mE(n,e.path)]}}function vE(n,e){const t={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=mE(n,r);const i=(function(u){if(u.length!==0)return TE(He.create(u,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const o=(function(u){if(u.length!==0)return u.map((h=>(function(m){return{field:ni(m.field),direction:bP(m.dir)}})(h)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=Ah(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:t,parent:r}}function EE(n){let e=gE(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let r=null;if(s>0){he(s===1,65062);const h=t.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let i=[];t.where&&(i=(function(f){const m=IE(f);return m instanceof He&&Md(m)?m.getFilters():[m]})(t.where));let o=[];t.orderBy&&(o=(function(f){return f.map((m=>(function(R){return new Yl(si(R.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(R.direction))})(m)))})(t.orderBy));let l=null;t.limit&&(l=(function(f){let m;return m=typeof f=="object"?f.value:f,Dc(m)?null:m})(t.limit));let c=null;t.startAt&&(c=(function(f){const m=!!f.before,_=f.values||[];return new Ni(_,m)})(t.startAt));let u=null;return t.endAt&&(u=(function(f){const m=!f.before,_=f.values||[];return new Ni(_,m)})(t.endAt)),H1(e,r,o,i,l,"F",c,u)}function wP(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ce(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function IE(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=si(t.unaryFilter.field);return Ne.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=si(t.unaryFilter.field);return Ne.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=si(t.unaryFilter.field);return Ne.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=si(t.unaryFilter.field);return Ne.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ce(61313);default:return ce(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ne.create(si(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ce(58110);default:return ce(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return He.create(t.compositeFilter.filters.map((s=>IE(s))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ce(1026)}})(t.compositeFilter.op))})(n):ce(30097,{filter:n})}function bP(n){return mP[n]}function AP(n){return gP[n]}function SP(n){return _P[n]}function ni(n){return{fieldPath:n.canonicalString()}}function si(n){return st.fromServerFormat(n.fieldPath)}function TE(n){return n instanceof Ne?(function(t){if(t.op==="=="){if(Vm(t.value))return{unaryFilter:{field:ni(t.field),op:"IS_NAN"}};if(Dm(t.value))return{unaryFilter:{field:ni(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Vm(t.value))return{unaryFilter:{field:ni(t.field),op:"IS_NOT_NAN"}};if(Dm(t.value))return{unaryFilter:{field:ni(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ni(t.field),op:AP(t.op),value:t.value}}})(n):n instanceof He?(function(t){const s=t.getFilters().map((r=>TE(r)));return s.length===1?s[0]:{compositeFilter:{op:SP(t.op),filters:s}}})(n):ce(54877,{filter:n})}function RP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function wE(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class es{constructor(e,t,s,r,i=me.min(),o=me.min(),l=dt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new es(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new es(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new es(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new es(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class bE{constructor(e){this.yt=e}}function PP(n,e){let t;if(e.document)t=EP(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=ne.fromSegments(e.noDocument.path),r=Vr(e.noDocument.readTime);t=ot.newNoDocument(s,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ce(56709);{const s=ne.fromSegments(e.unknownDocument.path),r=Vr(e.unknownDocument.version);t=ot.newUnknownDocument(s,r)}}return e.readTime&&t.setReadTime((function(r){const i=new qe(r[0],r[1]);return me.fromTimestamp(i)})(e.readTime)),t}function Ym(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:tc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=(function(i,o){return{name:Zl(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Mi(i,o.version.toTimestamp()),createTime:Mi(i,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:Dr(e.version)};else{if(!e.isUnknownDocument())return ce(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:Dr(e.version)}}return s}function tc(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Dr(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Vr(n){const e=new qe(n.seconds,n.nanoseconds);return me.fromTimestamp(e)}function hr(n,e){const t=(e.baseMutations||[]).map((i=>Ph(n.yt,i)));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map((i=>Ph(n.yt,i))),r=qe.fromMillis(e.localWriteTimeMs);return new Fd(e.batchId,r,t,s)}function Ro(n){const e=Vr(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Vr(n.lastLimboFreeSnapshotVersion):me.min();let s;return s=(function(i){return i.documents!==void 0})(n.query)?(function(i){const o=i.documents.length;return he(o===1,1966,{count:o}),dn(ka(gE(i.documents[0])))})(n.query):(function(i){return dn(EE(i))})(n.query),new es(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,dt.fromBase64String(n.resumeToken))}function AE(n,e){const t=Dr(e.snapshotVersion),s=Dr(e.lastLimboFreeSnapshotVersion);let r;r=Jl(e.target)?yE(n.yt,e.target):vE(n.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Nr(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function SE(n){const e=EE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?bh(e,e.limit,"L"):e}function Vu(n,e){return new Bd(e.largestBatchId,Ph(n.yt,e.overlayMutation))}function Jm(n,e){const t=e.path.lastSegment();return[n,Mt(e.path.popLast()),t]}function Xm(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:Dr(s.readTime),documentKey:Mt(s.documentKey.path),largestBatchId:s.largestBatchId}}class CP{getBundleMetadata(e,t){return Zm(e).get(t).next((s=>{if(s)return(function(i){return{id:i.bundleId,createTime:Vr(i.createTime),version:i.version}})(s)}))}saveBundleMetadata(e,t){return Zm(e).put((function(r){return{bundleId:r.id,createTime:Dr(zt(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return eg(e).get(t).next((s=>{if(s)return(function(i){return{name:i.name,query:SE(i.bundledQuery),readTime:Vr(i.readTime)}})(s)}))}saveNamedQuery(e,t){return eg(e).put((function(r){return{name:r.name,readTime:Dr(zt(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function Zm(n){return yt(n,Vc)}function eg(n){return yt(n,xc)}class Kc{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new Kc(e,s)}getOverlay(e,t){return po(e).get(Jm(this.userId,t)).next((s=>s?Vu(this.serializer,s):null))}getOverlays(e,t){const s=On();return N.forEach(t,(r=>this.getOverlay(e,r).next((i=>{i!==null&&s.set(r,i)})))).next((()=>s))}saveOverlays(e,t,s){const r=[];return s.forEach(((i,o)=>{const l=new Bd(t,o);r.push(this.St(e,l))})),N.waitFor(r)}removeOverlaysForBatchId(e,t,s){const r=new Set;t.forEach((o=>r.add(Mt(o.getCollectionPath()))));const i=[];return r.forEach((o=>{const l=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(po(e).Z(_h,l))})),N.waitFor(i)}getOverlaysForCollection(e,t,s){const r=On(),i=Mt(t),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return po(e).J(_h,o).next((l=>{for(const c of l){const u=Vu(this.serializer,c);r.set(u.getKey(),u)}return r}))}getOverlaysForCollectionGroup(e,t,s,r){const i=On();let o;const l=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return po(e).ee({index:Pv,range:l},((c,u,h)=>{const f=Vu(this.serializer,u);i.size()<r||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):h.done()})).next((()=>i))}St(e,t){return po(e).put((function(r,i,o){const[l,c,u]=Jm(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:ec(r.yt,o.mutation)}})(this.serializer,this.userId,t))}}function po(n){return yt(n,Oc)}class kP{bt(e){return yt(e,kd)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const s=t?.value;return s?dt.fromUint8Array(s):dt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class dr{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(tt(e.integerValue));else if("doubleValue"in e){const s=tt(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),ia(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=us(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(hs(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?Bv(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Lc(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):ce(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const s=e.fields||{};this.Ft(t,55);for(const r of Object.keys(s))this.Ot(r,t),this.Ct(s[r],t)}kt(e,t){const s=e.fields||{};this.Ft(t,53);const r=Ci,i=s[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(tt(i)),this.Ot(r,t),this.Ct(s[r],t)}Qt(e,t){const s=e.values||[];this.Ft(t,50);for(const r of s)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),ne.fromName(e).path.forEach((s=>{this.Ft(t,60),this.Ut(s,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}dr.Kt=new dr;const Qr=255;function NP(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function tg(n){const e=64-(function(s){let r=0;for(let i=0;i<8;++i){const o=NP(255&s[i]);if(r+=o,o!==8)break}return r})(n);return Math.ceil(e/8)}class DP{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Jt(s.value),s=t.next();this.Ht()}Yt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),s=tg(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),s=tg(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let r=t.length-s;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Qr),this.sn(255)}_n(){this.an(Qr),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)})(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let r=1;r<t.length;++r)t[r]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Qr?(this.sn(Qr),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Qr?(this.an(Qr),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class VP{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class xP{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class mo{constructor(){this.cn=new DP,this.ln=new VP(this.cn),this.hn=new xP(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class fr{constructor(e,t,s,r){this.Tn=e,this.In=t,this.En=s,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.dn,0),t!==e?s.set([0],this.dn.length):++s[s.length-1],new fr(this.Tn,this.In,this.En,s)}Rn(e,t,s){return{indexId:this.Tn,uid:e,arrayValue:Al(this.En),directionalValue:Al(this.dn),orderedDocumentKey:Al(t),documentKey:s.path.toArray()}}Vn(e,t,s){const r=this.Rn(e,t,s);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Ts(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=ng(n.En,e.En),t!==0?t:(t=ng(n.dn,e.dn),t!==0?t:ne.comparator(n.In,e.In)))}function ng(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function Al(n){return Ry()?(function(t){let s="";for(let r=0;r<t.length;r++)s+=String.fromCharCode(t[r]);return s})(n):n}function sg(n){return typeof n!="string"?n:(function(t){const s=new Uint8Array(t.length);for(let r=0;r<t.length;r++)s[r]=t.charCodeAt(r);return s})(n)}class rg{constructor(e){this.mn=new Ke(((t,s)=>st.comparator(t.field,s.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const s=t;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(e){if(he(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=ph(e);if(t!==void 0&&!this.wn(t))return!1;const s=lr(e);let r=new Set,i=0,o=0;for(;i<s.length&&this.wn(s[i]);++i)r=r.add(s[i].fieldPath.canonicalString());if(i===s.length)return!0;if(this.mn.size>0){const l=this.mn.getIterator().getNext();if(!r.has(l.field.canonicalString())){const c=s[i];if(!this.Sn(l,c)||!this.bn(this.fn[o++],c))return!1}++i}for(;i<s.length;++i){const l=s[i];if(o>=this.fn.length||!this.bn(this.fn[o++],l))return!1}return!0}Dn(){if(this.pn)return null;let e=new Ke(st.comparator);const t=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new _l(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new _l(s.field,0))}for(const s of this.fn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new _l(s.field,s.dir==="asc"?0:1)));return new Gl(Gl.UNKNOWN_ID,this.collectionId,t,ra.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function RE(n){if(he(n instanceof Ne||n instanceof He,20012),n instanceof Ne){if(n instanceof Qv){const t=n.value.arrayValue?.values?.map((s=>Ne.create(n.field,"==",s)))||[];return He.create(t,"or")}return n}const e=n.filters.map((t=>RE(t)));return He.create(e,n.op)}function OP(n){if(n.getFilters().length===0)return[];const e=Nh(RE(n));return he(PE(e),7391),Ch(e)||kh(e)?[e]:e.getFilters()}function Ch(n){return n instanceof Ne}function kh(n){return n instanceof He&&Md(n)}function PE(n){return Ch(n)||kh(n)||(function(t){if(t instanceof He&&Ih(t)){for(const s of t.getFilters())if(!Ch(s)&&!kh(s))return!1;return!0}return!1})(n)}function Nh(n){if(he(n instanceof Ne||n instanceof He,34018),n instanceof Ne)return n;if(n.filters.length===1)return Nh(n.filters[0]);const e=n.filters.map((s=>Nh(s)));let t=He.create(e,n.op);return t=nc(t),PE(t)?t:(he(t instanceof He,64498),he(Di(t),40251),he(t.filters.length>1,57927),t.filters.reduce(((s,r)=>qd(s,r))))}function qd(n,e){let t;return he(n instanceof Ne||n instanceof He,38388),he(e instanceof Ne||e instanceof He,25473),t=n instanceof Ne?e instanceof Ne?(function(r,i){return He.create([r,i],"and")})(n,e):ig(n,e):e instanceof Ne?ig(e,n):(function(r,i){if(he(r.filters.length>0&&i.filters.length>0,48005),Di(r)&&Di(i))return zv(r,i.getFilters());const o=Ih(r)?r:i,l=Ih(r)?i:r,c=o.filters.map((u=>qd(u,l)));return He.create(c,"or")})(n,e),nc(t)}function ig(n,e){if(Di(e))return zv(e,n.getFilters());{const t=e.filters.map((s=>qd(n,s)));return He.create(t,"or")}}function nc(n){if(he(n instanceof Ne||n instanceof He,11850),n instanceof Ne)return n;const e=n.getFilters();if(e.length===1)return nc(e[0]);if(Kv(n))return n;const t=e.map((r=>nc(r))),s=[];return t.forEach((r=>{r instanceof Ne?s.push(r):r instanceof He&&(r.op===n.op?s.push(...r.filters):s.push(r))})),s.length===1?s[0]:He.create(s,n.op)}class MP{constructor(){this.Cn=new Kd}addToCollectionParentIndex(e,t){return this.Cn.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve(on.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve(on.min())}updateCollectionGroup(e,t,s){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}}class Kd{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t]||new Ke(ze.comparator),i=!r.has(s);return this.index[t]=r.add(s),i}has(e){const t=e.lastSegment(),s=e.popLast(),r=this.index[t];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Ke(ze.comparator)).toArray()}}const og="IndexedDbIndexManager",nl=new Uint8Array(0);class LP{constructor(e,t){this.databaseId=t,this.vn=new Kd,this.Fn=new ps((s=>Nr(s)),((s,r)=>Ca(s,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const s=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const i={collectionId:s,parent:Mt(r)};return ag(e).put(i)}return N.resolve()}getCollectionParents(e,t){const s=[],r=IDBKeyRange.bound([t,""],[_v(t),""],!1,!0);return ag(e).J(r).next((i=>{for(const o of i){if(o.collectionId!==t)break;s.push(xn(o.parent))}return s}))}addFieldIndex(e,t){const s=go(e),r=(function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map((c=>[c.fieldPath.canonicalString(),c.kind]))}})(t);delete r.indexId;const i=s.add(r);if(t.indexState){const o=Jr(e);return i.next((l=>{o.put(Xm(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const s=go(e),r=Jr(e),i=Yr(e);return s.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=go(e),s=Yr(e),r=Jr(e);return t.Z().next((()=>s.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return N.forEach(this.Mn(t),(s=>this.getIndexType(e,s).next((r=>{if(r===0||r===1){const i=new rg(s).Dn();if(i!=null)return this.addFieldIndex(e,i)}}))))}getDocumentsMatchingTarget(e,t){const s=Yr(e);let r=!0;const i=new Map;return N.forEach(this.Mn(t),(o=>this.xn(e,o).next((l=>{r&&(r=!!l),i.set(o,l)})))).next((()=>{if(r){let o=Se();const l=[];return N.forEach(i,((c,u)=>{Q(og,`Using index ${(function(D){return`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map((P=>`${P.fieldPath}:${P.kind}`)).join(",")}`})(c)} to execute ${Nr(t)}`);const h=(function(D,P){const j=ph(P);if(j===void 0)return null;for(const Y of Xl(D,j.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null})(u,c),f=(function(D,P){const j=new Map;for(const Y of lr(P))for(const I of Xl(D,Y.fieldPath))switch(I.op){case"==":case"in":j.set(Y.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return j.set(Y.fieldPath.canonicalString(),I.value),Array.from(j.values())}return null})(u,c),m=(function(D,P){const j=[];let Y=!0;for(const I of lr(P)){const v=I.kind===0?Fm(D,I.fieldPath,D.startAt):Um(D,I.fieldPath,D.startAt);j.push(v.value),Y&&(Y=v.inclusive)}return new Ni(j,Y)})(u,c),_=(function(D,P){const j=[];let Y=!0;for(const I of lr(P)){const v=I.kind===0?Um(D,I.fieldPath,D.endAt):Fm(D,I.fieldPath,D.endAt);j.push(v.value),Y&&(Y=v.inclusive)}return new Ni(j,Y)})(u,c),R=this.On(c,u,m),x=this.On(c,u,_),O=this.Nn(c,u,f),$=this.Bn(c.indexId,h,R,m.inclusive,x,_.inclusive,O);return N.forEach($,(U=>s.Y(U,t.limit).next((D=>{D.forEach((P=>{const j=ne.fromSegments(P.documentKey);o.has(j)||(o=o.add(j),l.push(j))}))}))))})).next((()=>l))}return N.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=OP(He.create(e.filters,"and")).map((s=>wh(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,s,r,i,o,l){const c=(t!=null?t.length:1)*Math.max(s.length,i.length),u=c/(t!=null?t.length:1),h=[];for(let f=0;f<c;++f){const m=t?this.Ln(t[f/u]):nl,_=this.kn(e,m,s[f%u],r),R=this.qn(e,m,i[f%u],o),x=l.map((O=>this.kn(e,m,O,!0)));h.push(...this.createRange(_,R,x))}return h}kn(e,t,s,r){const i=new fr(e,ne.empty(),t,s);return r?i:i.An()}qn(e,t,s,r){const i=new fr(e,ne.empty(),t,s);return r?i.An():i}xn(e,t){const s=new rg(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((i=>{let o=null;for(const l of i)s.yn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o}))}getIndexType(e,t){let s=2;const r=this.Mn(t);return N.forEach(r,(i=>this.xn(e,i).next((o=>{o?s!==0&&o.fields.length<(function(c){let u=new Ke(st.comparator),h=!1;for(const f of c.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:u=u.add(m.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(h?1:0)})(i)&&(s=1):s=0})))).next((()=>(function(o){return o.limit!==null})(t)&&r.length>1&&s===2?1:s))}Qn(e,t){const s=new mo;for(const r of lr(e)){const i=t.data.field(r.fieldPath);if(i==null)return null;const o=s.Pn(r.kind);dr.Kt.Dt(i,o)}return s.un()}Ln(e){const t=new mo;return dr.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const s=new mo;return dr.Kt.Dt(Od(this.databaseId,t),s.Pn((function(i){const o=lr(i);return o.length===0?0:o[o.length-1].kind})(e))),s.un()}Nn(e,t,s){if(s===null)return[];let r=[];r.push(new mo);let i=0;for(const o of lr(e)){const l=s[i++];for(const c of r)if(this.Un(t,o.fieldPath)&&ha(l))r=this.Kn(r,o,l);else{const u=c.Pn(o.kind);dr.Kt.Dt(l,u)}}return this.Wn(r)}On(e,t,s){return this.Nn(e,t,s.position)}Wn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Kn(e,t,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const l of r){const c=new mo;c.seed(l.un()),dr.Kt.Dt(o,c.Pn(t.kind)),i.push(c)}return i}Un(e,t){return!!e.filters.find((s=>s instanceof Ne&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in")))}getFieldIndexes(e,t){const s=go(e),r=Jr(e);return(t?s.J(gh,IDBKeyRange.bound(t,t)):s.J()).next((i=>{const o=[];return N.forEach(i,(l=>r.get([l.indexId,this.uid]).next((c=>{o.push((function(h,f){const m=f?new ra(f.sequenceNumber,new on(Vr(f.readTime),new ne(xn(f.documentKey)),f.largestBatchId)):ra.empty(),_=h.fields.map((([R,x])=>new _l(st.fromServerFormat(R),x)));return new Gl(h.indexId,h.collectionGroup,_,m)})(l,c))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:Ie(s.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,s){const r=go(e),i=Jr(e);return this.Gn(e).next((o=>r.J(gh,IDBKeyRange.bound(t,t)).next((l=>N.forEach(l,(c=>i.put(Xm(c.indexId,this.uid,o,s))))))))}updateIndexEntries(e,t){const s=new Map;return N.forEach(t,((r,i)=>{const o=s.get(r.collectionGroup);return(o?N.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next((l=>(s.set(r.collectionGroup,l),N.forEach(l,(c=>this.zn(e,r,c).next((u=>{const h=this.jn(i,c);return u.isEqual(h)?N.resolve():this.Jn(e,i,c,u,h)})))))))}))}Hn(e,t,s,r){return Yr(e).put(r.Rn(this.uid,this.$n(s,t.key),t.key))}Yn(e,t,s,r){return Yr(e).delete(r.Vn(this.uid,this.$n(s,t.key),t.key))}zn(e,t,s){const r=Yr(e);let i=new Ke(Ts);return r.ee({index:Rv,range:IDBKeyRange.only([s.indexId,this.uid,Al(this.$n(s,t))])},((o,l)=>{i=i.add(new fr(s.indexId,t,sg(l.arrayValue),sg(l.directionalValue)))})).next((()=>i))}jn(e,t){let s=new Ke(Ts);const r=this.Qn(t,e);if(r==null)return s;const i=ph(t);if(i!=null){const o=e.data.field(i.fieldPath);if(ha(o))for(const l of o.arrayValue.values||[])s=s.add(new fr(t.indexId,e.key,this.Ln(l),r))}else s=s.add(new fr(t.indexId,e.key,nl,r));return s}Jn(e,t,s,r,i){Q(og,"Updating index entries for document '%s'",t.key);const o=[];return(function(c,u,h,f,m){const _=c.getIterator(),R=u.getIterator();let x=Wr(_),O=Wr(R);for(;x||O;){let $=!1,U=!1;if(x&&O){const D=h(x,O);D<0?U=!0:D>0&&($=!0)}else x!=null?U=!0:$=!0;$?(f(O),O=Wr(R)):U?(m(x),x=Wr(_)):(x=Wr(_),O=Wr(R))}})(r,i,Ts,(l=>{o.push(this.Hn(e,t,s,l))}),(l=>{o.push(this.Yn(e,t,s,l))})),N.waitFor(o)}Gn(e){let t=1;return Jr(e).ee({index:Sv,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((s,r,i)=>{i.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,s){s=s.sort(((o,l)=>Ts(o,l))).filter(((o,l,c)=>!l||Ts(o,c[l-1])!==0));const r=[];r.push(e);for(const o of s){const l=Ts(o,e),c=Ts(o,t);if(l===0)r[0]=e.An();else if(l>0&&c<0)r.push(o),r.push(o.An());else if(c>0)break}r.push(t);const i=[];for(let o=0;o<r.length;o+=2){if(this.Zn(r[o],r[o+1]))return[];const l=r[o].Vn(this.uid,nl,ne.empty()),c=r[o+1].Vn(this.uid,nl,ne.empty());i.push(IDBKeyRange.bound(l,c))}return i}Zn(e,t){return Ts(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(lg)}getMinOffset(e,t){return N.mapArray(this.Mn(t),(s=>this.xn(e,s).next((r=>r||ce(44426))))).next(lg)}}function ag(n){return yt(n,la)}function Yr(n){return yt(n,$o)}function go(n){return yt(n,Cd)}function Jr(n){return yt(n,Bo)}function lg(n){he(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const r=n[s].indexState.offset;Sd(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new on(e.readTime,e.documentKey,t)}const cg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},CE=41943040;class Dt{static withCacheSize(e){return new Dt(e,Dt.DEFAULT_COLLECTION_PERCENTILE,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}function kE(n,e,t){const s=n.store(gn),r=n.store(Ai),i=[],o=IDBKeyRange.only(t.batchId);let l=0;const c=s.ee({range:o},((h,f,m)=>(l++,m.delete())));i.push(c.next((()=>{he(l===1,47070,{batchId:t.batchId})})));const u=[];for(const h of t.mutations){const f=wv(e,h.key.path,t.batchId);i.push(r.delete(f)),u.push(h.key)}return N.waitFor(i).next((()=>u))}function sc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ce(14731);e=n.noDocument}return JSON.stringify(e).length}Dt.DEFAULT_COLLECTION_PERCENTILE=10,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dt.DEFAULT=new Dt(CE,Dt.DEFAULT_COLLECTION_PERCENTILE,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dt.DISABLED=new Dt(-1,0,0);class Gc{constructor(e,t,s,r){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=r,this.Xn={}}static wt(e,t,s,r){he(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Gc(i,t,s,r)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ws(e).ee({index:mr,range:s},((r,i,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,s,r){const i=ri(e),o=ws(e);return o.add({}).next((l=>{he(typeof l=="number",49019);const c=new Fd(l,t,s,r),u=(function(_,R,x){const O=x.baseMutations.map((U=>ec(_.yt,U))),$=x.mutations.map((U=>ec(_.yt,U)));return{userId:R,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:O,mutations:$}})(this.serializer,this.userId,c),h=[];let f=new Ke(((m,_)=>Ie(m.canonicalString(),_.canonicalString())));for(const m of r){const _=wv(this.userId,m.key.path,l);f=f.add(m.key.path.popLast()),h.push(o.put(u)),h.push(i.put(_,h1))}return f.forEach((m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))})),e.addOnCommittedListener((()=>{this.Xn[l]=c.keys()})),N.waitFor(h).next((()=>c))}))}lookupMutationBatch(e,t){return ws(e).get(t).next((s=>s?(he(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),hr(this.serializer,s)):null))}er(e,t){return this.Xn[t]?N.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((s=>{if(s){const r=s.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return ws(e).ee({index:mr,range:r},((o,l,c)=>{l.userId===this.userId&&(he(l.batchId>=s,47524,{tr:s}),i=hr(this.serializer,l)),c.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=Ir;return ws(e).ee({index:mr,range:t,reverse:!0},((r,i,o)=>{s=i.batchId,o.done()})).next((()=>s))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ir],[this.userId,Number.POSITIVE_INFINITY]);return ws(e).J(mr,t).next((s=>s.map((r=>hr(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=yl(this.userId,t.path),r=IDBKeyRange.lowerBound(s),i=[];return ri(e).ee({range:r},((o,l,c)=>{const[u,h,f]=o,m=xn(h);if(u===this.userId&&t.path.isEqual(m))return ws(e).get(f).next((_=>{if(!_)throw ce(61480,{nr:o,batchId:f});he(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:f}),i.push(hr(this.serializer,_))}));c.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Ke(Ie);const r=[];return t.forEach((i=>{const o=yl(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=ri(e).ee({range:l},((u,h,f)=>{const[m,_,R]=u,x=xn(_);m===this.userId&&i.path.isEqual(x)?s=s.add(R):f.done()}));r.push(c)})),N.waitFor(r).next((()=>this.rr(e,s)))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1,i=yl(this.userId,s),o=IDBKeyRange.lowerBound(i);let l=new Ke(Ie);return ri(e).ee({range:o},((c,u,h)=>{const[f,m,_]=c,R=xn(m);f===this.userId&&s.isPrefixOf(R)?R.length===r&&(l=l.add(_)):h.done()})).next((()=>this.rr(e,l)))}rr(e,t){const s=[],r=[];return t.forEach((i=>{r.push(ws(e).get(i).next((o=>{if(o===null)throw ce(35274,{batchId:i});he(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),s.push(hr(this.serializer,o))})))})),N.waitFor(r).next((()=>s))}removeMutationBatch(e,t){return kE(e.le,this.userId,t).next((s=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),N.forEach(s,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return N.resolve();const s=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),r=[];return ri(e).ee({range:s},((i,o,l)=>{if(i[0]===this.userId){const c=xn(i[1]);r.push(c)}else l.done()})).next((()=>{he(r.length===0,56720,{sr:r.map((i=>i.canonicalString()))})}))}))}containsKey(e,t){return NE(e,this.userId,t)}_r(e){return DE(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ir,lastStreamToken:""}))}}function NE(n,e,t){const s=yl(e,t.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return ri(n).ee({range:i,X:!0},((l,c,u)=>{const[h,f,m]=l;h===e&&f===r&&(o=!0),u.done()})).next((()=>o))}function ws(n){return yt(n,gn)}function ri(n){return yt(n,Ai)}function DE(n){return yt(n,oa)}class xr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new xr(0)}static cr(){return new xr(-1)}}class FP{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const s=new xr(t.highestTargetId);return t.highestTargetId=s.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>me.fromTimestamp(new qe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,s){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((s=>(s.targetCount+=1,this.Tr(t,s),this.hr(e,s))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Xr(e).delete(t.targetId))).next((()=>this.lr(e))).next((s=>(he(s.targetCount>0,8065),s.targetCount-=1,this.hr(e,s))))}removeTargets(e,t,s){let r=0;const i=[];return Xr(e).ee(((o,l)=>{const c=Ro(l);c.sequenceNumber<=t&&s.get(c.targetId)===null&&(r++,i.push(this.removeTargetData(e,c)))})).next((()=>N.waitFor(i))).next((()=>r))}forEachTarget(e,t){return Xr(e).ee(((s,r)=>{const i=Ro(r);t(i)}))}lr(e){return ug(e).get(Wl).next((t=>(he(t!==null,2888),t)))}hr(e,t){return ug(e).put(Wl,t)}Pr(e,t){return Xr(e).put(AE(this.serializer,t))}Tr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const s=Nr(t),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return Xr(e).ee({range:r,index:Av},((o,l,c)=>{const u=Ro(l);Ca(t,u.target)&&(i=u,c.done())})).next((()=>i))}addMatchingKeys(e,t,s){const r=[],i=Os(e);return t.forEach((o=>{const l=Mt(o.path);r.push(i.put({targetId:s,path:l})),r.push(this.referenceDelegate.addReference(e,s,o))})),N.waitFor(r)}removeMatchingKeys(e,t,s){const r=Os(e);return N.forEach(t,(i=>{const o=Mt(i.path);return N.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])}))}removeMatchingKeysForTargetId(e,t){const s=Os(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),r=Os(e);let i=Se();return r.ee({range:s,X:!0},((o,l,c)=>{const u=xn(o[1]),h=new ne(u);i=i.add(h)})).next((()=>i))}containsKey(e,t){const s=Mt(t.path),r=IDBKeyRange.bound([s],[_v(s)],!1,!0);let i=0;return Os(e).ee({index:Pd,X:!0,range:r},(([o,l],c,u)=>{o!==0&&(i++,u.done())})).next((()=>i>0))}At(e,t){return Xr(e).get(t).next((s=>s?Ro(s):null))}}function Xr(n){return yt(n,Si)}function ug(n){return yt(n,Tr)}function Os(n){return yt(n,Ri)}const hg="LruGarbageCollector",VE=1048576;function dg([n,e],[t,s]){const r=Ie(n,t);return r===0?Ie(e,s):r}class UP{constructor(e){this.Ir=e,this.buffer=new Ke(dg),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();dg(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xE{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Q(hg,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ws(t)?Q(hg,"Ignoring IndexedDB error during garbage collection: ",t):await Fr(t)}await this.Vr(3e5)}))}}class BP{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return N.resolve(cn.ce);const s=new UP(t);return this.mr.forEachTarget(e,(r=>s.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>s.Ar(r))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Q("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(cg)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Q("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cg):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,r,i,o,l,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(Q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r)))).next((f=>(s=f,l=Date.now(),this.removeTargets(e,s,t)))).next((f=>(i=f,c=Date.now(),this.removeOrphanedDocuments(e,s)))).next((f=>(u=Date.now(),ei()<=ke.DEBUG&&Q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f}))))}}function OE(n,e){return new BP(n,e)}class $P{constructor(e,t){this.db=e,this.garbageCollector=OE(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((s=>t.next((r=>s+r))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((s,r)=>t(r)))}addReference(e,t,s){return sl(e,s)}removeReference(e,t,s){return sl(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return sl(e,t)}br(e,t){return(function(r,i){let o=!1;return DE(r).te((l=>NE(r,l,i).next((c=>(c&&(o=!0),N.resolve(!c)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Sr(e,((o,l)=>{if(l<=t){const c=this.br(e,o).next((u=>{if(!u)return i++,s.getEntry(e,o).next((()=>(s.removeEntry(o,me.min()),Os(e).delete((function(f){return[0,Mt(f.path)]})(o)))))}));r.push(c)}})).next((()=>N.waitFor(r))).next((()=>s.apply(e))).next((()=>i))}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return sl(e,t)}Sr(e,t){const s=Os(e);let r,i=cn.ce;return s.ee({index:Pd},(([o,l],{path:c,sequenceNumber:u})=>{o===0?(i!==cn.ce&&t(new ne(xn(r)),i),i=u,r=c):i=cn.ce})).next((()=>{i!==cn.ce&&t(new ne(xn(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function sl(n,e){return Os(n).put((function(s,r){return{targetId:0,path:Mt(s.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}class ME{constructor(){this.changes=new ps((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ot.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?N.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class jP{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return ir(e).put(s)}removeEntry(e,t,s){return ir(e).delete((function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],tc(o),l[l.length-1]]})(t,s))}updateMetadata(e,t){return this.getMetadata(e).next((s=>(s.byteSize+=t,this.Dr(e,s))))}getEntry(e,t){let s=ot.newInvalidDocument(t);return ir(e).ee({index:vl,range:IDBKeyRange.only(_o(t))},((r,i)=>{s=this.Cr(t,i)})).next((()=>s))}vr(e,t){let s={size:0,document:ot.newInvalidDocument(t)};return ir(e).ee({index:vl,range:IDBKeyRange.only(_o(t))},((r,i)=>{s={document:this.Cr(t,i),size:sc(i)}})).next((()=>s))}getEntries(e,t){let s=sn();return this.Fr(e,t,((r,i)=>{const o=this.Cr(r,i);s=s.insert(r,o)})).next((()=>s))}Mr(e,t){let s=sn(),r=new nt(ne.comparator);return this.Fr(e,t,((i,o)=>{const l=this.Cr(i,o);s=s.insert(i,l),r=r.insert(i,sc(o))})).next((()=>({documents:s,Or:r})))}Fr(e,t,s){if(t.isEmpty())return N.resolve();let r=new Ke(mg);t.forEach((c=>r=r.add(c)));const i=IDBKeyRange.bound(_o(r.first()),_o(r.last())),o=r.getIterator();let l=o.getNext();return ir(e).ee({index:vl,range:i},((c,u,h)=>{const f=ne.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&mg(l,f)<0;)s(l,null),l=o.getNext();l&&l.isEqual(f)&&(s(l,u),l=o.hasNext()?o.getNext():null),l?h.j(_o(l)):h.done()})).next((()=>{for(;l;)s(l,null),l=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,s,r,i){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),tc(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ir(e).J(IDBKeyRange.bound(l,c,!0)).next((u=>{i?.incrementDocumentReadCount(u.length);let h=sn();for(const f of u){const m=this.Cr(ne.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Na(t,m)||r.has(m.key))&&(h=h.insert(m.key,m))}return h}))}getAllFromCollectionGroup(e,t,s,r){let i=sn();const o=pg(t,s),l=pg(t,on.max());return ir(e).ee({index:bv,range:IDBKeyRange.bound(o,l,!0)},((c,u,h)=>{const f=this.Cr(ne.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(f.key,f),i.size===r&&h.done()})).next((()=>i))}newChangeBuffer(e){return new qP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return fg(e).get(mh).next((t=>(he(!!t,20021),t)))}Dr(e,t){return fg(e).put(mh,t)}Cr(e,t){if(t){const s=PP(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(me.min())))return s}return ot.newInvalidDocument(e)}}function LE(n){return new jP(n)}class qP extends ME{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ps((s=>s.toString()),((s,r)=>s.isEqual(r)))}applyChanges(e){const t=[];let s=0,r=new Ke(((i,o)=>Ie(i.canonicalString(),o.canonicalString())));return this.changes.forEach(((i,o)=>{const l=this.Br.get(i);if(t.push(this.Nr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=Ym(this.Nr.serializer,o);r=r.add(i.path.popLast());const u=sc(c);s+=u-l.size,t.push(this.Nr.addEntry(e,i,c))}else if(s-=l.size,this.trackRemovals){const c=Ym(this.Nr.serializer,o.convertToNoDocument(me.min()));t.push(this.Nr.addEntry(e,i,c))}})),r.forEach((i=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,i))})),t.push(this.Nr.updateMetadata(e,s)),N.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((s=>(this.Br.set(t,{size:s.size,readTime:s.document.readTime}),s.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:s,Or:r})=>(r.forEach(((i,o)=>{this.Br.set(i,{size:o,readTime:s.get(i).readTime})})),s)))}}function fg(n){return yt(n,aa)}function ir(n){return yt(n,Hl)}function _o(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function pg(n,e){const t=e.documentKey.path.toArray();return[n,tc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function mg(n,e){const t=n.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<t.length-2&&i<s.length-2;++i)if(r=Ie(t[i],s[i]),r)return r;return r=Ie(t.length,s.length),r||(r=Ie(t[t.length-2],s[s.length-2]),r||Ie(t[t.length-1],s[s.length-1]))}class KP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class FE{constructor(e,t,s,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(s=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(s!==null&&Go(s.mutation,r,un.empty(),qe.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,Se()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=Se()){const r=On();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,s).next((i=>{let o=Ao();return i.forEach(((l,c)=>{o=o.insert(l,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const s=On();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,Se())))}populateOverlays(e,t,s){const r=[];return s.forEach((i=>{t.has(i)||r.push(i)})),this.documentOverlayCache.getOverlays(e,r).next((i=>{i.forEach(((o,l)=>{t.set(o,l)}))}))}computeViews(e,t,s,r){let i=sn();const o=Ko(),l=(function(){return Ko()})();return t.forEach(((c,u)=>{const h=s.get(u.key);r.has(u.key)&&(h===void 0||h.mutation instanceof Qs)?i=i.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Go(h.mutation,u,h.mutation.getFieldMask(),qe.now())):o.set(u.key,un.empty())})),this.recalculateAndSaveOverlays(e,i).next((c=>(c.forEach(((u,h)=>o.set(u,h))),t.forEach(((u,h)=>l.set(u,new KP(h,o.get(u)??null)))),l)))}recalculateAndSaveOverlays(e,t){const s=Ko();let r=new nt(((o,l)=>o-l)),i=Se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const l of o)l.keys().forEach((c=>{const u=t.get(c);if(u===null)return;let h=s.get(c)||un.empty();h=l.applyToLocalView(u,h),s.set(c,h);const f=(r.get(l.batchId)||Se()).add(c);r=r.insert(l.batchId,f)}))})).next((()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,f=eE();h.forEach((m=>{if(!i.has(m)){const _=aE(t.get(m),s.get(m));_!==null&&f.set(m,_),i=i.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return N.waitFor(o)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,r){return(function(o){return ne.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):W1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,r):this.getDocumentsMatchingCollectionQuery(e,t,s,r)}getNextDocuments(e,t,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,r).next((i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,r-i.size):N.resolve(On());let l=sa,c=i;return o.next((u=>N.forEach(u,((h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(h)?N.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{c=c.insert(h,m)}))))).next((()=>this.populateOverlays(e,u,i))).next((()=>this.computeViews(e,c,u,Se()))).next((h=>({batchId:l,changes:Zv(h)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ne(t)).next((s=>{let r=Ao();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,r){const i=t.collectionGroup;let o=Ao();return this.indexManager.getCollectionParents(e,i).next((l=>N.forEach(l,(c=>{const u=(function(f,m){return new Fc(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,s,r).next((h=>{h.forEach(((f,m)=>{o=o.insert(f,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,i,r)))).next((o=>{i.forEach(((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,ot.newInvalidDocument(h)))}));let l=Ao();return o.forEach(((c,u)=>{const h=i.get(c);h!==void 0&&Go(h.mutation,u,un.empty(),qe.now()),Na(t,u)&&(l=l.insert(c,u))})),l}))}}class GP{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return N.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:zt(r.createTime)}})(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:SE(r.bundledQuery),readTime:zt(r.readTime)}})(t)),N.resolve()}}class zP{constructor(){this.overlays=new nt(ne.comparator),this.qr=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){const s=On();return N.forEach(t,(r=>this.getOverlay(e,r).next((i=>{i!==null&&s.set(r,i)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((r,i)=>{this.St(e,t,i)})),N.resolve()}removeOverlaysForBatchId(e,t,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(s)),N.resolve()}getOverlaysForCollection(e,t,s){const r=On(),i=t.length+1,o=new ne(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>s&&r.set(c.getKey(),c)}return N.resolve(r)}getOverlaysForCollectionGroup(e,t,s,r){let i=new nt(((u,h)=>u-h));const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>s){let h=i.get(u.largestBatchId);h===null&&(h=On(),i=i.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=On(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((u,h)=>l.set(u,h))),!(l.size()>=r)););return N.resolve(l)}St(e,t,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new Bd(t,s));let i=this.qr.get(t);i===void 0&&(i=Se(),this.qr.set(t,i)),this.qr.set(t,i.add(s.key))}}class HP{constructor(){this.sessionToken=dt.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,N.resolve()}}class Gd{constructor(){this.Qr=new Ke(It.$r),this.Ur=new Ke(It.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new It(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new It(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new ne(new ze([])),s=new It(t,e),r=new It(t,e+1),i=[];return this.Ur.forEachInRange([s,r],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ne(new ze([])),s=new It(t,e),r=new It(t,e+1);let i=Se();return this.Ur.forEachInRange([s,r],(o=>{i=i.add(o.key)})),i}containsKey(e){const t=new It(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class It{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ne.comparator(e.key,t.key)||Ie(e.Yr,t.Yr)}static Kr(e,t){return Ie(e.Yr,t.Yr)||ne.comparator(e.key,t.key)}}class WP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ke(It.$r)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Fd(i,t,s,r);this.mutationQueue.push(o);for(const l of r)this.Zr=this.Zr.add(new It(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return N.resolve(o)}lookupMutationBatch(e,t){return N.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,r=this.ei(s),i=r<0?0:r;return N.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?Ir:this.tr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new It(t,0),r=new It(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],(o=>{const l=this.Xr(o.Yr);i.push(l)})),N.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Ke(Ie);return t.forEach((r=>{const i=new It(r,0),o=new It(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(l=>{s=s.add(l.Yr)}))})),N.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,r=s.length+1;let i=s;ne.isDocumentKey(i)||(i=i.child(""));const o=new It(new ne(i),0);let l=new Ke(Ie);return this.Zr.forEachWhile((c=>{const u=c.key.path;return!!s.isPrefixOf(u)&&(u.length===r&&(l=l.add(c.Yr)),!0)}),o),N.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((s=>{const r=this.Xr(s);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){he(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return N.forEach(t.mutations,(r=>{const i=new It(r.key,t.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new It(t,0),r=this.Zr.firstAfterOrEqual(s);return N.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class QP{constructor(e){this.ri=e,this.docs=(function(){return new nt(ne.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return N.resolve(s?s.document.mutableCopy():ot.newInvalidDocument(t))}getEntries(e,t){let s=sn();return t.forEach((r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():ot.newInvalidDocument(r))})),N.resolve(s)}getDocumentsMatchingQuery(e,t,s,r){let i=sn();const o=t.path,l=new ne(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Sd(vv(h),s)<=0||(r.has(h.key)||Na(t,h))&&(i=i.insert(h.key,h.mutableCopy()))}return N.resolve(i)}getAllFromCollectionGroup(e,t,s,r){ce(9500)}ii(e,t){return N.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new YP(this)}getSize(e){return N.resolve(this.size)}}class YP extends ME{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)})),N.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class JP{constructor(e){this.persistence=e,this.si=new ps((t=>Nr(t)),Ca),this.lastRemoteSnapshotVersion=me.min(),this.highestTargetId=0,this.oi=0,this._i=new Gd,this.targetCount=0,this.ai=xr.ur()}forEachTarget(e,t){return this.si.forEach(((s,r)=>t(r))),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),N.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new xr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.Pr(t),N.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,s){let r=0;const i=[];return this.si.forEach(((o,l)=>{l.sequenceNumber<=t&&s.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)})),N.waitFor(i).next((()=>r))}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return N.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),N.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((o=>{i.push(r.markPotentiallyOrphaned(e,o))})),N.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),N.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return N.resolve(s)}containsKey(e,t){return N.resolve(this._i.containsKey(t))}}class zd{constructor(e,t){this.ui={},this.overlays={},this.ci=new cn(0),this.li=!1,this.li=!0,this.hi=new HP,this.referenceDelegate=e(this),this.Pi=new JP(this),this.indexManager=new MP,this.remoteDocumentCache=(function(r){return new QP(r)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new bE(t),this.Ii=new GP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new zP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new WP(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){Q("MemoryPersistence","Starting transaction:",e);const r=new XP(this.ci.next());return this.referenceDelegate.Ei(),s(r).next((i=>this.referenceDelegate.di(r).next((()=>i)))).toPromise().then((i=>(r.raiseOnCommittedEvent(),i)))}Ai(e,t){return N.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class XP extends Iv{constructor(e){super(),this.currentSequenceNumber=e}}class zc{constructor(e){this.persistence=e,this.Ri=new Gd,this.Vi=null}static mi(e){return new zc(e)}get fi(){if(this.Vi)return this.Vi;throw ce(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),N.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),N.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((i=>this.fi.add(i.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.fi,(s=>{const r=ne.fromPath(s);return this.gi(e,r).next((i=>{i||t.removeEntry(r,me.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return N.or([()=>N.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class rc{constructor(e,t){this.persistence=e,this.pi=new ps((s=>Mt(s.path)),((s,r)=>s.isEqual(r))),this.garbageCollector=OE(this,t)}static mi(e,t){return new rc(e,t)}Ei(){}di(e){return N.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((r=>s+r))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return N.forEach(this.pi,((s,r)=>this.br(e,s,r).next((i=>i?N.resolve():t(r)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,(o=>this.br(e,o,t).next((l=>{l||(s++,i.removeEntry(o,me.min()))})))).next((()=>i.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),N.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),N.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),N.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),N.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Il(e.data.value)),t}br(e,t,s){return N.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return N.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ZP{constructor(e){this.serializer=e}k(e,t,s,r){const i=new Nc("createOrUpgrade",t);s<1&&r>=1&&((function(c){c.createObjectStore(Pa)})(e),(function(c){c.createObjectStore(oa,{keyPath:u1}),c.createObjectStore(gn,{keyPath:Sm,autoIncrement:!0}).createIndex(mr,Rm,{unique:!0}),c.createObjectStore(Ai)})(e),gg(e),(function(c){c.createObjectStore(cr)})(e));let o=N.resolve();return s<3&&r>=3&&(s!==0&&((function(c){c.deleteObjectStore(Ri),c.deleteObjectStore(Si),c.deleteObjectStore(Tr)})(e),gg(e)),o=o.next((()=>(function(c){const u=c.store(Tr),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:me.min().toTimestamp(),targetCount:0};return u.put(Wl,h)})(i)))),s<4&&r>=4&&(s!==0&&(o=o.next((()=>(function(c,u){return u.store(gn).J().next((f=>{c.deleteObjectStore(gn),c.createObjectStore(gn,{keyPath:Sm,autoIncrement:!0}).createIndex(mr,Rm,{unique:!0});const m=u.store(gn),_=f.map((R=>m.put(R)));return N.waitFor(_)}))})(e,i)))),o=o.next((()=>{(function(c){c.createObjectStore(Pi,{keyPath:v1})})(e)}))),s<5&&r>=5&&(o=o.next((()=>this.yi(i)))),s<6&&r>=6&&(o=o.next((()=>((function(c){c.createObjectStore(aa)})(e),this.wi(i))))),s<7&&r>=7&&(o=o.next((()=>this.Si(i)))),s<8&&r>=8&&(o=o.next((()=>this.bi(e,i)))),s<9&&r>=9&&(o=o.next((()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)}))),s<10&&r>=10&&(o=o.next((()=>this.Di(i)))),s<11&&r>=11&&(o=o.next((()=>{(function(c){c.createObjectStore(Vc,{keyPath:E1})})(e),(function(c){c.createObjectStore(xc,{keyPath:I1})})(e)}))),s<12&&r>=12&&(o=o.next((()=>{(function(c){const u=c.createObjectStore(Oc,{keyPath:P1});u.createIndex(_h,C1,{unique:!1}),u.createIndex(Pv,k1,{unique:!1})})(e)}))),s<13&&r>=13&&(o=o.next((()=>(function(c){const u=c.createObjectStore(Hl,{keyPath:d1});u.createIndex(vl,f1),u.createIndex(bv,p1)})(e))).next((()=>this.Ci(e,i))).next((()=>e.deleteObjectStore(cr)))),s<14&&r>=14&&(o=o.next((()=>this.Fi(e,i)))),s<15&&r>=15&&(o=o.next((()=>(function(c){c.createObjectStore(Cd,{keyPath:T1,autoIncrement:!0}).createIndex(gh,w1,{unique:!1}),c.createObjectStore(Bo,{keyPath:b1}).createIndex(Sv,A1,{unique:!1}),c.createObjectStore($o,{keyPath:S1}).createIndex(Rv,R1,{unique:!1})})(e)))),s<16&&r>=16&&(o=o.next((()=>{t.objectStore(Bo).clear()})).next((()=>{t.objectStore($o).clear()}))),s<17&&r>=17&&(o=o.next((()=>{(function(c){c.createObjectStore(kd,{keyPath:N1})})(e)}))),s<18&&r>=18&&Ry()&&(o=o.next((()=>{t.objectStore(Bo).clear()})).next((()=>{t.objectStore($o).clear()}))),o}wi(e){let t=0;return e.store(cr).ee(((s,r)=>{t+=sc(r)})).next((()=>{const s={byteSize:t};return e.store(aa).put(mh,s)}))}yi(e){const t=e.store(oa),s=e.store(gn);return t.J().next((r=>N.forEach(r,(i=>{const o=IDBKeyRange.bound([i.userId,Ir],[i.userId,i.lastAcknowledgedBatchId]);return s.J(mr,o).next((l=>N.forEach(l,(c=>{he(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=hr(this.serializer,c);return kE(e,i.userId,u).next((()=>{}))}))))}))))}Si(e){const t=e.store(Ri),s=e.store(cr);return e.store(Tr).get(Wl).next((r=>{const i=[];return s.ee(((o,l)=>{const c=new ze(o),u=(function(f){return[0,Mt(f)]})(c);i.push(t.get(u).next((h=>h?N.resolve():(f=>t.put({targetId:0,path:Mt(f),sequenceNumber:r.highestListenSequenceNumber}))(c))))})).next((()=>N.waitFor(i)))}))}bi(e,t){e.createObjectStore(la,{keyPath:y1});const s=t.store(la),r=new Kd,i=o=>{if(r.add(o)){const l=o.lastSegment(),c=o.popLast();return s.put({collectionId:l,parent:Mt(c)})}};return t.store(cr).ee({X:!0},((o,l)=>{const c=new ze(o);return i(c.popLast())})).next((()=>t.store(Ai).ee({X:!0},(([o,l,c],u)=>{const h=xn(l);return i(h.popLast())}))))}Di(e){const t=e.store(Si);return t.ee(((s,r)=>{const i=Ro(r),o=AE(this.serializer,i);return t.put(o)}))}Ci(e,t){const s=t.store(cr),r=[];return s.ee(((i,o)=>{const l=t.store(Hl),c=(function(f){return f.document?new ne(ze.fromString(f.document.name).popFirst(5)):f.noDocument?ne.fromSegments(f.noDocument.path):f.unknownDocument?ne.fromSegments(f.unknownDocument.path):ce(36783)})(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(u))})).next((()=>N.waitFor(r)))}Fi(e,t){const s=t.store(gn),r=LE(this.serializer),i=new zd(zc.mi,this.serializer.yt);return s.J().next((o=>{const l=new Map;return o.forEach((c=>{let u=l.get(c.userId)??Se();hr(this.serializer,c).keys().forEach((h=>u=u.add(h))),l.set(c.userId,u)})),N.forEach(l,((c,u)=>{const h=new qt(u),f=Kc.wt(this.serializer,h),m=i.getIndexManager(h),_=Gc.wt(h,this.serializer,m,i.referenceDelegate);return new FE(r,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new yh(t,cn.ce),c).next()}))}))}}function gg(n){n.createObjectStore(Ri,{keyPath:g1}).createIndex(Pd,_1,{unique:!0}),n.createObjectStore(Si,{keyPath:"targetId"}).createIndex(Av,m1,{unique:!0}),n.createObjectStore(Tr)}const bs="IndexedDbPersistence",xu=18e5,Ou=5e3,Mu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",eC="main";class Hd{constructor(e,t,s,r,i,o,l,c,u,h,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Mi=i,this.window=o,this.document=l,this.xi=u,this.Oi=h,this.Ni=f,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=m=>Promise.resolve(),!Hd.v())throw new ae(q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new $P(this,r),this.$i=t+eC,this.serializer=new bE(c),this.Ui=new qs(this.$i,this.Ni,new ZP(this.serializer)),this.hi=new kP,this.Pi=new FP(this.referenceDelegate,this.serializer),this.remoteDocumentCache=LE(this.serializer),this.Ii=new CP,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,h===!1&&Gt(bs,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ae(q.FAILED_PRECONDITION,Mu);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new cn(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>rl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ws(e))return Q(bs,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Q(bs,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return yo(e).get(Hr).next((t=>N.resolve(this.es(t))))}ts(e){return rl(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,xu)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const s=yt(t,Pi);return s.J().next((r=>{const i=this.ss(r,xu),o=r.filter((l=>i.indexOf(l)===-1));return N.forEach(o,(l=>s.delete(l.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?N.resolve(!0):yo(e).get(Hr).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Ou)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ae(q.FAILED_PRECONDITION,Mu);return!1}}return!(!this.networkEnabled||!this.inForeground)||rl(e).J().next((s=>this.ss(s,Ou).find((r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(i||o&&l)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Q(bs,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Pa,Pi],(e=>{const t=new yh(e,cn.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((s=>this.rs(s.updateTimeMs,t)&&!this.us(s.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>rl(e).J().next((t=>this.ss(t,xu).map((s=>s.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return Gc.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new LP(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Kc.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,s){Q(bs,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",i=(function(c){return c===18?x1:c===17?Dv:c===16?V1:c===15?Nd:c===14?Nv:c===13?kv:c===12?D1:c===11?Cv:void ce(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,r,i,(l=>(o=new yh(l,this.ci?this.ci.next():cn.ce),t==="readwrite-primary"?this.Hi(o).next((c=>!!c||this.Yi(o))).next((c=>{if(!c)throw Gt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ae(q.FAILED_PRECONDITION,Ev);return s(o)})).next((c=>this.Xi(o).next((()=>c)))):this.Is(o).next((()=>s(o)))))).then((l=>(o.raiseOnCommittedEvent(),l)))}Is(e){return yo(e).get(Hr).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Ou)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ae(q.FAILED_PRECONDITION,Mu)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return yo(e).put(Hr,t)}static v(){return qs.v()}Zi(e){const t=yo(e);return t.get(Hr).next((s=>this.es(s)?(Q(bs,"Releasing primary lease."),t.delete(Hr)):N.resolve()))}rs(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(Gt(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;Sy()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return Q(bs,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Gt(bs,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Gt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function yo(n){return yt(n,Pa)}function rl(n){return yt(n,Pi)}function tC(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Wd{constructor(e,t,s,r){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=r}static As(e,t){let s=Se(),r=Se();for(const i of t.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Wd(e,t.fromCache,s,r)}}class nC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class UE{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Sy()?8:Tv(_t())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,r){const i={result:null};return this.ys(e,t).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,t,r,s).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new nC;return this.Ss(e,t,o).next((l=>{if(i.result=l,this.Vs)return this.bs(e,t,o,l.size)}))})).next((()=>i.result))}bs(e,t,s,r){return s.documentReadCount<this.fs?(ei()<=ke.DEBUG&&Q("QueryEngine","SDK will not create cache indexes for query:",ti(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),N.resolve()):(ei()<=ke.DEBUG&&Q("QueryEngine","Query:",ti(t),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(ei()<=ke.DEBUG&&Q("QueryEngine","The SDK decides to create cache indexes for query:",ti(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dn(t))):N.resolve())}ys(e,t){if(Bm(t))return N.resolve(null);let s=dn(t);return this.indexManager.getIndexType(e,s).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=bh(t,null,"F"),s=dn(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((i=>{const o=Se(...i);return this.ps.getDocuments(e,o).next((l=>this.indexManager.getMinOffset(e,s).next((c=>{const u=this.Ds(t,l);return this.Cs(t,u,o,c.readTime)?this.ys(e,bh(t,null,"F")):this.vs(e,u,t,c)}))))})))))}ws(e,t,s,r){return Bm(t)||r.isEqual(me.min())?N.resolve(null):this.ps.getDocuments(e,s).next((i=>{const o=this.Ds(t,i);return this.Cs(t,o,s,r)?N.resolve(null):(ei()<=ke.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ti(t)),this.vs(e,o,t,s1(r,sa)).next((l=>l)))}))}Ds(e,t){let s=new Ke(Jv(e));return t.forEach(((r,i)=>{Na(e,i)&&(s=s.add(i))})),s}Cs(e,t,s,r){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,s){return ei()<=ke.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",ti(t)),this.ps.getDocumentsMatchingQuery(e,t,on.min(),s)}vs(e,t,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next((i=>(t.forEach((o=>{i=i.insert(o.key,o)})),i)))}}const Qd="LocalStore",sC=3e8;class rC{constructor(e,t,s,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new nt(Ie),this.xs=new ps((i=>Nr(i)),Ca),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new FE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function BE(n,e,t,s){return new rC(n,e,t,s)}async function $E(n,e){const t=Te(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let r;return t.mutationQueue.getAllMutationBatches(s).next((i=>(r=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((i=>{const o=[],l=[];let c=Se();for(const u of r){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of i){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(s,c).next((u=>({Ls:u,removedBatchIds:o,addedBatchIds:l})))}))}))}function iC(n,e){const t=Te(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const r=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,c,u,h){const f=u.batch,m=f.keys();let _=N.resolve();return m.forEach((R=>{_=_.next((()=>h.getEntry(c,R))).next((x=>{const O=u.docVersions.get(R);he(O!==null,48541),x.version.compareTo(O)<0&&(f.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),h.addEntry(x)))}))})),_.next((()=>l.mutationQueue.removeMutationBatch(c,f)))})(t,s,e,i).next((()=>i.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(l){let c=Se();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c})(e)))).next((()=>t.localDocuments.getDocuments(s,r)))}))}function jE(n){const e=Te(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function oC(n,e){const t=Te(n),s=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const l=[];e.targetChanges.forEach(((h,f)=>{const m=r.get(f);if(!m)return;l.push(t.Pi.removeMatchingKeys(i,h.removedDocuments,f).next((()=>t.Pi.addMatchingKeys(i,h.addedDocuments,f))));let _=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(dt.EMPTY_BYTE_STRING,me.min()).withLastLimboFreeSnapshotVersion(me.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,s)),r=r.insert(f,_),(function(x,O,$){return x.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=sC?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0})(m,_,h)&&l.push(t.Pi.updateTargetData(i,_))}));let c=sn(),u=Se();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(i,h))})),l.push(aC(i,o,e.documentUpdates).next((h=>{c=h.ks,u=h.qs}))),!s.isEqual(me.min())){const h=t.Pi.getLastRemoteSnapshotVersion(i).next((f=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s)));l.push(h)}return N.waitFor(l).next((()=>o.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,c,u))).next((()=>c))})).then((i=>(t.Ms=r,i)))}function aC(n,e,t){let s=Se(),r=Se();return t.forEach((i=>s=s.add(i))),e.getEntries(n,s).next((i=>{let o=sn();return t.forEach(((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(l)),c.isNoDocument()&&c.version.isEqual(me.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Q(Qd,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)})),{ks:o,qs:r}}))}function lC(n,e){const t=Te(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Ir),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function cC(n,e){const t=Te(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let r;return t.Pi.getTargetData(s,e).next((i=>i?(r=i,N.resolve(r)):t.Pi.allocateTargetId(s).next((o=>(r=new es(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,r).next((()=>r)))))))})).then((s=>{const r=t.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function Dh(n,e,t){const s=Te(n),r=s.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",i,(o=>s.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Ws(o))throw o;Q(Qd,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function _g(n,e,t){const s=Te(n);let r=me.min(),i=Se();return s.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,u,h){const f=Te(c),m=f.xs.get(h);return m!==void 0?N.resolve(f.Ms.get(m)):f.Pi.getTargetData(u,h)})(s,o,dn(e)).next((l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,l.targetId).next((c=>{i=c}))})).next((()=>s.Fs.getDocumentsMatchingQuery(o,e,t?r:me.min(),t?i:Se()))).next((l=>(uC(s,Y1(e),l),{documents:l,Qs:i})))))}function uC(n,e,t){let s=n.Os.get(e)||me.min();t.forEach(((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)})),n.Os.set(e,s)}class yg{constructor(){this.activeTargetIds=nP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qE{constructor(){this.Mo=new yg,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new yg,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class hC{Oo(e){}shutdown(){}}const vg="ConnectivityMonitor";class Eg{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Q(vg,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Q(vg,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let il=null;function Vh(){return il===null?il=(function(){return 268435456+Math.round(2147483648*Math.random())})():il++,"0x"+il.toString(16)}const Lu="RestConnection",dC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class fC{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===Ql?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,t,s,r,i){const o=Vh(),l=this.zo(e,t.toUriEncodedString());Q(Lu,`Sending RPC '${e}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,r,i);const{host:u}=new URL(l),h=$i(u);return this.Jo(e,l,c,s,h).then((f=>(Q(Lu,`Received RPC '${e}' ${o}: `,f),f)),(f=>{throw na(Lu,`RPC '${e}' ${o} failed with error: `,f,"url: ",l,"request:",s),f}))}Ho(e,t,s,r,i,o){return this.Go(e,t,s,r,i)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ki})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,i)=>e[i]=r)),s&&s.headers.forEach(((r,i)=>e[i]=r))}zo(e,t){const s=dC[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}class pC{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const kt="WebChannelConnection";class mC extends fC{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,r,i){const o=Vh();return new Promise(((l,c)=>{const u=new hv;u.setWithCredentials(!0),u.listenOnce(dv.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case gl.NO_ERROR:const f=u.getResponseJson();Q(kt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),l(f);break;case gl.TIMEOUT:Q(kt,`RPC '${e}' ${o} timed out`),c(new ae(q.DEADLINE_EXCEEDED,"Request time out"));break;case gl.HTTP_ERROR:const m=u.getStatus();if(Q(kt,`RPC '${e}' ${o} failed with status:`,m,"response text:",u.getResponseText()),m>0){let _=u.getResponseJson();Array.isArray(_)&&(_=_[0]);const R=_?.error;if(R&&R.status&&R.message){const x=(function($){const U=$.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(U)>=0?U:q.UNKNOWN})(R.status);c(new ae(x,R.message))}else c(new ae(q.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new ae(q.UNAVAILABLE,"Connection failed."));break;default:ce(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Q(kt,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(r);Q(kt,`RPC '${e}' ${o} sending request:`,r),u.send(t,"POST",h,s,15)}))}T_(e,t,s){const r=Vh(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=mv(),l=pv(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,t,s),c.encodeInitMessageHeaders=!0;const h=i.join("");Q(kt,`Creating RPC '${e}' stream ${r}: ${h}`,c);const f=o.createWebChannel(h,c);this.I_(f);let m=!1,_=!1;const R=new pC({Yo:O=>{_?Q(kt,`Not sending because RPC '${e}' stream ${r} is closed:`,O):(m||(Q(kt,`Opening RPC '${e}' stream ${r} transport.`),f.open(),m=!0),Q(kt,`RPC '${e}' stream ${r} sending:`,O),f.send(O))},Zo:()=>f.close()}),x=(O,$,U)=>{O.listen($,(D=>{try{U(D)}catch(P){setTimeout((()=>{throw P}),0)}}))};return x(f,bo.EventType.OPEN,(()=>{_||(Q(kt,`RPC '${e}' stream ${r} transport opened.`),R.o_())})),x(f,bo.EventType.CLOSE,(()=>{_||(_=!0,Q(kt,`RPC '${e}' stream ${r} transport closed`),R.a_(),this.E_(f))})),x(f,bo.EventType.ERROR,(O=>{_||(_=!0,na(kt,`RPC '${e}' stream ${r} transport errored. Name:`,O.name,"Message:",O.message),R.a_(new ae(q.UNAVAILABLE,"The operation could not be completed")))})),x(f,bo.EventType.MESSAGE,(O=>{if(!_){const $=O.data[0];he(!!$,16349);const U=$,D=U?.error||U[0]?.error;if(D){Q(kt,`RPC '${e}' stream ${r} received error:`,D);const P=D.status;let j=(function(v){const w=ct[v];if(w!==void 0)return uE(w)})(P),Y=D.message;j===void 0&&(j=q.INTERNAL,Y="Unknown error status: "+P+" with message "+D.message),_=!0,R.a_(new ae(j,Y)),f.close()}else Q(kt,`RPC '${e}' stream ${r} received:`,$),R.u_($)}})),x(l,fv.STAT_EVENT,(O=>{O.stat===dh.PROXY?Q(kt,`RPC '${e}' stream ${r} detected buffering proxy`):O.stat===dh.NOPROXY&&Q(kt,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{R.__()}),0),R}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function gC(){return typeof window<"u"?window:null}function Sl(){return typeof document<"u"?document:null}function Hc(n){return new yP(n,!0)}class KE{constructor(e,t,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-s);r>0&&Q("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Ig="PersistentStream";class GE{constructor(e,t,s,r,i,o,l,c){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new KE(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===q.RESOURCE_EXHAUSTED?(Gt(t.toString()),Gt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,r])=>{this.D_===t&&this.G_(s,r)}),(s=>{e((()=>{const r=new ae(q.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{s((()=>this.z_(r)))})),this.stream.onMessage((r=>{s((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Q(Ig,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Q(Ig,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class _C extends GE{constructor(e,t,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=IP(this.serializer,e),s=(function(i){if(!("targetChange"in i))return me.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?me.min():o.readTime?zt(o.readTime):me.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=Rh(this.serializer),t.addTarget=(function(i,o){let l;const c=o.target;if(l=Jl(c)?{documents:yE(i,c)}:{query:vE(i,c).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=fE(i,o.resumeToken);const u=Ah(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(me.min())>0){l.readTime=Mi(i,o.snapshotVersion.toTimestamp());const u=Ah(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l})(this.serializer,e);const s=wP(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=Rh(this.serializer),t.removeTarget=e,this.q_(t)}}class yC extends GE{constructor(e,t,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return he(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,he(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){he(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=TP(e.writeResults,e.commitTime),s=zt(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=Rh(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>ec(this.serializer,s)))};this.q_(t)}}class vC{}class EC extends vC{constructor(e,t,s,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ae(q.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,Sh(t,s),r,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ae(q.UNKNOWN,i.toString())}))}Ho(e,t,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Ho(e,Sh(t,s),r,o,l,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ae(q.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class IC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Gt(t),this.aa=!1):Q("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Or="RemoteStore";class TC{constructor(e,t,s,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{s.enqueueAndForget((async()=>{Br(this)&&(Q(Or,"Restarting streams for network reachability change."),await(async function(c){const u=Te(c);u.Ea.add(4),await Va(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Wc(u)})(this))}))})),this.Ra=new IC(s,r)}}async function Wc(n){if(Br(n))for(const e of n.da)await e(!0)}async function Va(n){for(const e of n.da)await e(!1)}function zE(n,e){const t=Te(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Zd(t)?Xd(t):zi(t).O_()&&Jd(t,e))}function Yd(n,e){const t=Te(n),s=zi(t);t.Ia.delete(e),s.O_()&&HE(t,e),t.Ia.size===0&&(s.O_()?s.L_():Br(t)&&t.Ra.set("Unknown"))}function Jd(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(me.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}zi(n).Y_(e)}function HE(n,e){n.Va.Ue(e),zi(n).Z_(e)}function Xd(n){n.Va=new pP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),zi(n).start(),n.Ra.ua()}function Zd(n){return Br(n)&&!zi(n).x_()&&n.Ia.size>0}function Br(n){return Te(n).Ea.size===0}function WE(n){n.Va=void 0}async function wC(n){n.Ra.set("Online")}async function bC(n){n.Ia.forEach(((e,t)=>{Jd(n,e)}))}async function AC(n,e){WE(n),Zd(n)?(n.Ra.ha(e),Xd(n)):n.Ra.set("Unknown")}async function SC(n,e,t){if(n.Ra.set("Online"),e instanceof dE&&e.state===2&&e.cause)try{await(async function(r,i){const o=i.cause;for(const l of i.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.Ia.delete(l),r.Va.removeTarget(l))})(n,e)}catch(s){Q(Or,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await ic(n,s)}else if(e instanceof bl?n.Va.Ze(e):e instanceof hE?n.Va.st(e):n.Va.tt(e),!t.isEqual(me.min()))try{const s=await jE(n.localStore);t.compareTo(s)>=0&&await(function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach(((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.Ia.get(u);h&&i.Ia.set(u,h.withResumeToken(c.resumeToken,o))}})),l.targetMismatches.forEach(((c,u)=>{const h=i.Ia.get(c);if(!h)return;i.Ia.set(c,h.withResumeToken(dt.EMPTY_BYTE_STRING,h.snapshotVersion)),HE(i,c);const f=new es(h.target,c,u,h.sequenceNumber);Jd(i,f)})),i.remoteSyncer.applyRemoteEvent(l)})(n,t)}catch(s){Q(Or,"Failed to raise snapshot:",s),await ic(n,s)}}async function ic(n,e,t){if(!Ws(e))throw e;n.Ea.add(1),await Va(n),n.Ra.set("Offline"),t||(t=()=>jE(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Q(Or,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Wc(n)}))}function QE(n,e){return e().catch((t=>ic(n,t,e)))}async function xa(n){const e=Te(n),t=zs(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ir;for(;RC(e);)try{const r=await lC(e.localStore,s);if(r===null){e.Ta.length===0&&t.L_();break}s=r.batchId,PC(e,r)}catch(r){await ic(e,r)}YE(e)&&JE(e)}function RC(n){return Br(n)&&n.Ta.length<10}function PC(n,e){n.Ta.push(e);const t=zs(n);t.O_()&&t.X_&&t.ea(e.mutations)}function YE(n){return Br(n)&&!zs(n).x_()&&n.Ta.length>0}function JE(n){zs(n).start()}async function CC(n){zs(n).ra()}async function kC(n){const e=zs(n);for(const t of n.Ta)e.ea(t.mutations)}async function NC(n,e,t){const s=n.Ta.shift(),r=Ud.from(s,e,t);await QE(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await xa(n)}async function DC(n,e){e&&zs(n).X_&&await(async function(s,r){if((function(o){return hP(o)&&o!==q.ABORTED})(r.code)){const i=s.Ta.shift();zs(s).B_(),await QE(s,(()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r))),await xa(s)}})(n,e),YE(n)&&JE(n)}async function Tg(n,e){const t=Te(n);t.asyncQueue.verifyOperationInProgress(),Q(Or,"RemoteStore received new credentials");const s=Br(t);t.Ea.add(3),await Va(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Wc(t)}async function VC(n,e){const t=Te(n);e?(t.Ea.delete(2),await Wc(t)):e||(t.Ea.add(2),await Va(t),t.Ra.set("Unknown"))}function zi(n){return n.ma||(n.ma=(function(t,s,r){const i=Te(t);return i.sa(),new _C(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)})(n.datastore,n.asyncQueue,{Xo:wC.bind(null,n),t_:bC.bind(null,n),r_:AC.bind(null,n),H_:SC.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Zd(n)?Xd(n):n.Ra.set("Unknown")):(await n.ma.stop(),WE(n))}))),n.ma}function zs(n){return n.fa||(n.fa=(function(t,s,r){const i=Te(t);return i.sa(),new yC(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:CC.bind(null,n),r_:DC.bind(null,n),ta:kC.bind(null,n),na:NC.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await xa(n)):(await n.fa.stop(),n.Ta.length>0&&(Q(Or,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class ef{constructor(e,t,s,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new ns,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,r,i){const o=Date.now()+s,l=new ef(e,t,o,r,i);return l.start(s),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ae(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tf(n,e){if(Gt("AsyncQueue",`${e}: ${n}`),Ws(n))return new ae(q.UNAVAILABLE,`${e}: ${n}`);throw n}class pi{static emptySet(e){return new pi(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||ne.comparator(t.key,s.key):(t,s)=>ne.comparator(t.key,s.key),this.keyedMap=Ao(),this.sortedSet=new nt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof pi)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new pi;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}class wg{constructor(){this.ga=new nt(ne.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ce(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Li{constructor(e,t,s,r,i,o,l,c,u){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,s,r,i){const o=[];return t.forEach((l=>{o.push({type:0,doc:l})})),new Li(e,t,pi.emptySet(t),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==s[r].type||!t[r].doc.isEqual(s[r].doc))return!1;return!0}}class xC{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class OC{constructor(){this.queries=bg(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const r=Te(t),i=r.queries;r.queries=bg(),i.forEach(((o,l)=>{for(const c of l.Sa)c.onError(s)}))})(this,new ae(q.ABORTED,"Firestore shutting down"))}}function bg(){return new ps((n=>Yv(n)),Uc)}async function XE(n,e){const t=Te(n);let s=3;const r=e.query;let i=t.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new xC,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await t.onListen(r,!0);break;case 1:i.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const l=tf(o,`Initialization of query '${ti(e.query)}' failed`);return void e.onError(l)}t.queries.set(r,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&nf(t)}async function ZE(n,e){const t=Te(n),s=e.query;let r=3;const i=t.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function MC(n,e){const t=Te(n);let s=!1;for(const r of e){const i=r.query,o=t.queries.get(i);if(o){for(const l of o.Sa)l.Fa(r)&&(s=!0);o.wa=r}}s&&nf(t)}function LC(n,e,t){const s=Te(n),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(t);s.queries.delete(e)}function nf(n){n.Ca.forEach((e=>{e.next()}))}var xh,Ag;(Ag=xh||(xh={})).Ma="default",Ag.Cache="cache";class eI{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Li(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Li.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==xh.Cache}}class tI{constructor(e){this.key=e}}class nI{constructor(e){this.key=e}}class FC{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Se(),this.mutatedKeys=Se(),this.eu=Jv(e),this.tu=new pi(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new wg,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,l=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((h,f)=>{const m=r.get(h),_=Na(this.query,f)?f:null,R=!!m&&this.mutatedKeys.has(m.key),x=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let O=!1;m&&_?m.data.isEqual(_.data)?R!==x&&(s.track({type:3,doc:_}),O=!0):this.su(m,_)||(s.track({type:2,doc:_}),O=!0,(c&&this.eu(_,c)>0||u&&this.eu(_,u)<0)&&(l=!0)):!m&&_?(s.track({type:0,doc:_}),O=!0):m&&!_&&(s.track({type:1,doc:m}),O=!0,(c||u)&&(l=!0)),O&&(_?(o=o.add(_),i=x?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),s.track({type:1,doc:h})}return{tu:o,iu:s,Cs:l,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,f)=>(function(_,R){const x=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ce(20277,{Rt:O})}};return x(_)-x(R)})(h.type,f.type)||this.eu(h.doc,f.doc))),this.ou(s),r=r??!1;const l=t&&!r?this._u():[],c=this.Xa.size===0&&this.current&&!r?1:0,u=c!==this.Za;return this.Za=c,o.length!==0||u?{snapshot:new Li(this.query,e.tu,i,o,e.mutatedKeys,c===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new wg,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Se(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new nI(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new tI(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=Se();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Li.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const sf="SyncEngine";class UC{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class BC{constructor(e){this.key=e,this.hu=!1}}class $C{constructor(e,t,s,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ps((l=>Yv(l)),Uc),this.Iu=new Map,this.Eu=new Set,this.du=new nt(ne.comparator),this.Au=new Map,this.Ru=new Gd,this.Vu={},this.mu=new Map,this.fu=xr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function jC(n,e,t=!0){const s=lI(n);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await sI(s,e,t,!0),r}async function qC(n,e){const t=lI(n);await sI(t,e,!0,!1)}async function sI(n,e,t,s){const r=await cC(n.localStore,dn(e)),i=r.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let l;return s&&(l=await KC(n,e,i,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&zE(n.remoteStore,r),l}async function KC(n,e,t,s,r){n.pu=(f,m,_)=>(async function(x,O,$,U){let D=O.view.ru($);D.Cs&&(D=await _g(x.localStore,O.query,!1).then((({documents:I})=>O.view.ru(I,D))));const P=U&&U.targetChanges.get(O.targetId),j=U&&U.targetMismatches.get(O.targetId)!=null,Y=O.view.applyChanges(D,x.isPrimaryClient,P,j);return Rg(x,O.targetId,Y.au),Y.snapshot})(n,f,m,_);const i=await _g(n.localStore,e,!0),o=new FC(e,i.Qs),l=o.ru(i.documents),c=Da.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",r),u=o.applyChanges(l,n.isPrimaryClient,c);Rg(n,t,u.au);const h=new UC(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function GC(n,e,t){const s=Te(n),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter((o=>!Uc(o,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await Dh(s.localStore,r.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(r.targetId),t&&Yd(s.remoteStore,r.targetId),Oh(s,r.targetId)})).catch(Fr)):(Oh(s,r.targetId),await Dh(s.localStore,r.targetId,!0))}async function zC(n,e){const t=Te(n),s=t.Tu.get(e),r=t.Iu.get(s.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Yd(t.remoteStore,s.targetId))}async function HC(n,e,t){const s=cI(n);try{const r=await(function(o,l){const c=Te(o),u=qe.now(),h=l.reduce(((_,R)=>_.add(R.key)),Se());let f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",(_=>{let R=sn(),x=Se();return c.Ns.getEntries(_,h).next((O=>{R=O,R.forEach((($,U)=>{U.isValidDocument()||(x=x.add($))}))})).next((()=>c.localDocuments.getOverlayedDocuments(_,R))).next((O=>{f=O;const $=[];for(const U of l){const D=cP(U,f.get(U.key).overlayedDocument);D!=null&&$.push(new Qs(U.key,D,jv(D.value.mapValue),Qt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,u,$,l)})).next((O=>{m=O;const $=O.applyToLocalDocumentSet(f,x);return c.documentOverlayCache.saveOverlays(_,O.batchId,$)}))})).then((()=>({batchId:m.batchId,changes:Zv(f)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),(function(o,l,c){let u=o.Vu[o.currentUser.toKey()];u||(u=new nt(Ie)),u=u.insert(l,c),o.Vu[o.currentUser.toKey()]=u})(s,r.batchId,t),await Oa(s,r.changes),await xa(s.remoteStore)}catch(r){const i=tf(r,"Failed to persist write");t.reject(i)}}async function rI(n,e){const t=Te(n);try{const s=await oC(t.localStore,e);e.targetChanges.forEach(((r,i)=>{const o=t.Au.get(i);o&&(he(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?he(o.hu,14607):r.removedDocuments.size>0&&(he(o.hu,42227),o.hu=!1))})),await Oa(t,s,e)}catch(s){await Fr(s)}}function Sg(n,e,t){const s=Te(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const r=[];s.Tu.forEach(((i,o)=>{const l=o.view.va(e);l.snapshot&&r.push(l.snapshot)})),(function(o,l){const c=Te(o);c.onlineState=l;let u=!1;c.queries.forEach(((h,f)=>{for(const m of f.Sa)m.va(l)&&(u=!0)})),u&&nf(c)})(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function WC(n,e,t){const s=Te(n);s.sharedClientState.updateQueryState(e,"rejected",t);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new nt(ne.comparator);o=o.insert(i,ot.newNoDocument(i,me.min()));const l=Se().add(i),c=new qc(me.min(),new Map,new nt(Ie),o,l);await rI(s,c),s.du=s.du.remove(i),s.Au.delete(e),rf(s)}else await Dh(s.localStore,e,!1).then((()=>Oh(s,e,t))).catch(Fr)}async function QC(n,e){const t=Te(n),s=e.batch.batchId;try{const r=await iC(t.localStore,e);oI(t,s,null),iI(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Oa(t,r)}catch(r){await Fr(r)}}async function YC(n,e,t){const s=Te(n);try{const r=await(function(o,l){const c=Te(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next((f=>(he(f!==null,37113),h=f.keys(),c.mutationQueue.removeMutationBatch(u,f)))).next((()=>c.mutationQueue.performConsistencyCheck(u))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>c.localDocuments.getDocuments(u,h)))}))})(s.localStore,e);oI(s,e,t),iI(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Oa(s,r)}catch(r){await Fr(r)}}function iI(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function oI(n,e,t){const s=Te(n);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(t?i.reject(t):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function Oh(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||aI(n,s)}))}function aI(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Yd(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),rf(n))}function Rg(n,e,t){for(const s of t)s instanceof tI?(n.Ru.addReference(s.key,e),JC(n,s)):s instanceof nI?(Q(sf,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||aI(n,s.key)):ce(19791,{wu:s})}function JC(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(Q(sf,"New document in limbo: "+t),n.Eu.add(s),rf(n))}function rf(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ne(ze.fromString(e)),s=n.fu.next();n.Au.set(s,new BC(t)),n.du=n.du.insert(t,s),zE(n.remoteStore,new es(dn(ka(t.path)),s,"TargetPurposeLimboResolution",cn.ce))}}async function Oa(n,e,t){const s=Te(n),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach(((l,c)=>{o.push(s.pu(c,e,t).then((u=>{if((u||t)&&s.isPrimaryClient){const h=u?!u.fromCache:t?.targetChanges.get(c.targetId)?.current;s.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){r.push(u);const h=Wd.As(c.targetId,u);i.push(h)}})))})),await Promise.all(o),s.Pu.H_(r),await(async function(c,u){const h=Te(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>N.forEach(u,(m=>N.forEach(m.Es,(_=>h.persistence.referenceDelegate.addReference(f,m.targetId,_))).next((()=>N.forEach(m.ds,(_=>h.persistence.referenceDelegate.removeReference(f,m.targetId,_)))))))))}catch(f){if(!Ws(f))throw f;Q(Qd,"Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const _=h.Ms.get(m),R=_.snapshotVersion,x=_.withLastLimboFreeSnapshotVersion(R);h.Ms=h.Ms.insert(m,x)}}})(s.localStore,i))}async function XC(n,e){const t=Te(n);if(!t.currentUser.isEqual(e)){Q(sf,"User change. New user:",e.toKey());const s=await $E(t.localStore,e);t.currentUser=e,(function(i,o){i.mu.forEach((l=>{l.forEach((c=>{c.reject(new ae(q.CANCELLED,o))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Oa(t,s.Ls)}}function ZC(n,e){const t=Te(n),s=t.Au.get(e);if(s&&s.hu)return Se().add(s.key);{let r=Se();const i=t.Iu.get(e);if(!i)return r;for(const o of i){const l=t.Tu.get(o);r=r.unionWith(l.view.nu)}return r}}function lI(n){const e=Te(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=rI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ZC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=WC.bind(null,e),e.Pu.H_=MC.bind(null,e.eventManager),e.Pu.yu=LC.bind(null,e.eventManager),e}function cI(n){const e=Te(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=QC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=YC.bind(null,e),e}class fa{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hc(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return BE(this.persistence,new UE,e.initialUser,this.serializer)}Cu(e){return new zd(zc.mi,this.serializer)}Du(e){return new qE}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fa.provider={build:()=>new fa};class ek extends fa{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){he(this.persistence.referenceDelegate instanceof rc,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new xE(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new zd((s=>rc.mi(s,t)),this.serializer)}}class tk extends fa{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await cI(this.xu.syncEngine),await xa(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return BE(this.persistence,new UE,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new xE(s,e.asyncQueue,t)}Mu(e,t){const s=new a1(t,this.persistence);return new o1(e.asyncQueue,s)}Cu(e){const t=tC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new Hd(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,gC(),Sl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new qE}}class oc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Sg(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=XC.bind(null,this.syncEngine),await VC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new OC})()}createDatastore(e){const t=Hc(e.databaseInfo.databaseId),s=(function(i){return new mC(i)})(e.databaseInfo);return(function(i,o,l,c){return new EC(i,o,l,c)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,r,i,o,l){return new TC(s,r,i,o,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>Sg(this.syncEngine,t,0)),(function(){return Eg.v()?new Eg:new hC})())}createSyncEngine(e,t){return(function(r,i,o,l,c,u,h){const f=new $C(r,i,o,l,c,u);return h&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const s=Te(t);Q(Or,"RemoteStore shutting down."),s.Ea.add(5),await Va(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}oc.provider={build:()=>new oc};class uI{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Gt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Hs="FirestoreClient";class nk{constructor(e,t,s,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=r,this.user=qt.UNAUTHENTICATED,this.clientId=bd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,(async o=>{Q(Hs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(s,(o=>(Q(Hs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ns;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=tf(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function Fu(n,e){n.asyncQueue.verifyOperationInProgress(),Q(Hs,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async r=>{s.isEqual(r)||(await $E(e.localStore,r),s=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Pg(n,e){n.asyncQueue.verifyOperationInProgress();const t=await sk(n);Q(Hs,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Tg(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,r)=>Tg(e.remoteStore,r))),n._onlineComponents=e}async function sk(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Q(Hs,"Using user provided OfflineComponentProvider");try{await Fu(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===q.FAILED_PRECONDITION||r.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;na("Error using user provided cache. Falling back to memory cache: "+t),await Fu(n,new fa)}}else Q(Hs,"Using default OfflineComponentProvider"),await Fu(n,new ek(void 0));return n._offlineComponents}async function hI(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Q(Hs,"Using user provided OnlineComponentProvider"),await Pg(n,n._uninitializedComponentsProvider._online)):(Q(Hs,"Using default OnlineComponentProvider"),await Pg(n,new oc))),n._onlineComponents}function rk(n){return hI(n).then((e=>e.syncEngine))}async function Mh(n){const e=await hI(n),t=e.eventManager;return t.onListen=jC.bind(null,e.syncEngine),t.onUnlisten=GC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=qC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=zC.bind(null,e.syncEngine),t}function ik(n,e,t={}){const s=new ns;return n.asyncQueue.enqueueAndForget((async()=>(function(i,o,l,c,u){const h=new uI({next:m=>{h.Nu(),o.enqueueAndForget((()=>ZE(i,f)));const _=m.docs.has(l);!_&&m.fromCache?u.reject(new ae(q.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&c&&c.source==="server"?u.reject(new ae(q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new eI(ka(l.path),h,{includeMetadataChanges:!0,qa:!0});return XE(i,f)})(await Mh(n),n.asyncQueue,e,t,s))),s.promise}function dI(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const Cg=new Map;const ok="firestore.googleapis.com",kg=!0;class Ng{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ae(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ok,this.ssl=kg}else this.host=e.host,this.ssl=e.ssl??kg;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=CE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<VE)throw new ae(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}n1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dI(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ae(q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ae(q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ae(q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,r){return s.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fI{constructor(e,t,s,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ng({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ae(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ae(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ng(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new z0;switch(s.type){case"firstParty":return new Q0(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new ae(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=Cg.get(t);s&&(Q("ComponentProvider","Removing Datastore"),Cg.delete(t),s.terminate())})(this),Promise.resolve()}}class Qc{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Qc(this.firestore,e,this._query)}}class gt{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gt(this.firestore,e,this._key)}toJSON(){return{type:gt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Ra(t,gt._jsonSchema))return new gt(e,s||null,new ne(ze.fromString(t.referencePath)))}}gt._jsonSchemaVersion="firestore/documentReference/1.0",gt._jsonSchema={type:ut("string",gt._jsonSchemaVersion),referencePath:ut("string")};class pa extends Qc{constructor(e,t,s){super(e,t,ka(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gt(this.firestore,null,new ne(e))}withConverter(e){return new pa(this.firestore,e,this._path)}}function ac(n,e,...t){if(n=rn(n),arguments.length===1&&(e=bd.newId()),t1("doc","path",e),n instanceof fI){const s=ze.fromString(e,...t);return Im(s),new gt(n,null,new ne(s))}{if(!(n instanceof gt||n instanceof pa))throw new ae(q.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(ze.fromString(e,...t));return Im(s),new gt(n.firestore,n instanceof pa?n.converter:null,new ne(s))}}const Dg="AsyncQueue";class Vg{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new KE(this,"async_queue_retry"),this._c=()=>{const s=Sl();s&&Q(Dg,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=Sl();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Sl();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ns;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ws(e))throw e;Q(Dg,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Gt("INTERNAL UNHANDLED ERROR: ",xg(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=ef.createAndSchedule(this,e,t,s,(i=>this.hc(i)));return this.tc.push(r),r}uc(){this.nc&&ce(47125,{Pc:xg(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function xg(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Og(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const r=t;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1})(n,["next","error","complete"])}class Fi extends fI{constructor(e,t,s,r){super(e,t,s,r),this.type="firestore",this._queue=new Vg,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Vg(e),this._firestoreClient=void 0,await e}}}function ak(n,e,t){t||(t=Ql);const s=dd(n,"firestore");if(s.isInitialized(t)){const r=s.getImmediate({identifier:t}),i=s.getOptions(t);if(Sr(i,e))return r;throw new ae(q.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ae(q.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<VE)throw new ae(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&$i(e.host)&&by(e.host),s.initialize({options:e,instanceIdentifier:t})}function of(n){if(n._terminated)throw new ae(q.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||lk(n),n._firestoreClient}function lk(n){const e=n._freezeSettings(),t=(function(r,i,o,l){return new M1(r,i,o,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,dI(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new nk(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(r){const i=r?._online.build();return{_offline:r?._offline.build(i),_online:i}})(n._componentsProvider))}class ln{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ln(dt.fromBase64String(e))}catch(t){throw new ae(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ln(dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ln._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ra(e,ln._jsonSchema))return ln.fromBase64String(e.bytes)}}ln._jsonSchemaVersion="firestore/bytes/1.0",ln._jsonSchema={type:ut("string",ln._jsonSchemaVersion),bytes:ut("string")};class af{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ae(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class lf{constructor(e){this._methodName=e}}class Un{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ae(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ae(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ie(this._lat,e._lat)||Ie(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Un._jsonSchemaVersion}}static fromJSON(e){if(Ra(e,Un._jsonSchema))return new Un(e.latitude,e.longitude)}}Un._jsonSchemaVersion="firestore/geoPoint/1.0",Un._jsonSchema={type:ut("string",Un._jsonSchemaVersion),latitude:ut("number"),longitude:ut("number")};class Bn{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Bn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ra(e,Bn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Bn(e.vectorValues);throw new ae(q.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Bn._jsonSchemaVersion="firestore/vectorValue/1.0",Bn._jsonSchema={type:ut("string",Bn._jsonSchemaVersion),vectorValues:ut("object")};const ck=/^__.*__$/;class uk{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Qs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Gi(e,this.data,t,this.fieldTransforms)}}function pI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ce(40011,{Ac:n})}}class cf{constructor(e,t,s,r,i,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new cf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return lc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(pI(this.Ac)&&ck.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class hk{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Hc(e)}Cc(e,t,s,r=!1){return new cf({Ac:e,methodName:t,Dc:s,path:st.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function dk(n){const e=n._freezeSettings(),t=Hc(n._databaseId);return new hk(n._databaseId,!!e.ignoreUndefinedProperties,t)}function fk(n,e,t,s,r,i={}){const o=n.Cc(i.merge||i.mergeFields?2:0,e,t,r);yI("Data must be an object, but it was:",o,s);const l=gI(s,o);let c,u;if(i.merge)c=new un(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=pk(e,f,t);if(!o.contains(m))throw new ae(q.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);gk(h,m)||h.push(m)}c=new un(h),u=o.fieldTransforms.filter((f=>c.covers(f.field)))}else c=null,u=o.fieldTransforms;return new uk(new Wt(l),c,u)}class uf extends lf{_toFieldTransform(e){return new oE(e.path,new Vi)}isEqual(e){return e instanceof uf}}function mI(n,e){if(_I(n=rn(n)))return yI("Unsupported field value:",e,n),gI(n,e);if(n instanceof lf)return(function(s,r){if(!pI(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,r){const i=[];let o=0;for(const l of s){let c=mI(l,r.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}})(n,e)}return(function(s,r){if((s=rn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return sP(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=qe.fromDate(s);return{timestampValue:Mi(r.serializer,i)}}if(s instanceof qe){const i=new qe(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Mi(r.serializer,i)}}if(s instanceof Un)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ln)return{bytesValue:fE(r.serializer,s._byteString)};if(s instanceof gt){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:jd(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Bn)return(function(o,l){return{mapValue:{fields:{[Vd]:{stringValue:xd},[Ci]:{arrayValue:{values:o.toArray().map((u=>{if(typeof u!="number")throw l.Sc("VectorValues must only contain numeric values.");return Ld(l.serializer,u)}))}}}}}})(s,r);throw r.Sc(`Unsupported field value: ${Ad(s)}`)})(n,e)}function gI(n,e){const t={};return Vv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ur(n,((s,r)=>{const i=mI(r,e.mc(s));i!=null&&(t[s]=i)})),{mapValue:{fields:t}}}function _I(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qe||n instanceof Un||n instanceof ln||n instanceof gt||n instanceof lf||n instanceof Bn)}function yI(n,e,t){if(!_I(t)||!yv(t)){const s=Ad(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function pk(n,e,t){if((e=rn(e))instanceof af)return e._internalPath;if(typeof e=="string")return vI(n,e);throw lc("Field path arguments must be of type string or ",n,!1,void 0,t)}const mk=new RegExp("[~\\*/\\[\\]]");function vI(n,e,t){if(e.search(mk)>=0)throw lc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new af(...e.split("."))._internalPath}catch{throw lc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function lc(n,e,t,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new ae(q.INVALID_ARGUMENT,l+n+c)}function gk(n,e){return n.some((t=>t.isEqual(e)))}class EI{constructor(e,t,s,r,i){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new gt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _k(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(II("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class _k extends EI{data(){return super.data()}}function II(n,e){return typeof e=="string"?vI(n,e):e instanceof af?e._internalPath:e._delegate._internalPath}function yk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ae(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vk{convertValue(e,t="none"){switch(Ks(e)){case 0:return null;case 1:return e.booleanValue;case 2:return tt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(hs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ce(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Ur(e,((r,i)=>{s[r]=this.convertValue(i,t)})),s}convertVectorValue(e){const t=e.fields?.[Ci].arrayValue?.values?.map((s=>tt(s.doubleValue)));return new Bn(t)}convertGeoPoint(e){return new Un(tt(e.latitude),tt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Mc(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(ca(e));default:return null}}convertTimestamp(e){const t=us(e);return new qe(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=ze.fromString(e);he(wE(s),9688,{name:e});const r=new kr(s.get(1),s.get(3)),i=new ne(s.popFirst(5));return r.isEqual(t)||Gt(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Ek(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Po{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class br extends EI{constructor(e,t,s,r,i,o){super(e,t,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(II("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ae(q.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=br._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}br._jsonSchemaVersion="firestore/documentSnapshot/1.0",br._jsonSchema={type:ut("string",br._jsonSchemaVersion),bundleSource:ut("string","DocumentSnapshot"),bundleName:ut("string"),bundle:ut("string")};class Rl extends br{data(e={}){return super.data(e)}}class mi{constructor(e,t,s,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Po(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Rl(this._firestore,this._userDataWriter,s.key,s,new Po(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ae(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((l=>{const c=new Rl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Po(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((l=>i||l.type!==3)).map((l=>{const c=new Rl(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Po(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:Ik(l.type),doc:c,oldIndex:u,newIndex:h}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ae(q.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=mi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=bd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],r=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Ik(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ce(61501,{type:n})}}function Tk(n){n=js(n,gt);const e=js(n.firestore,Fi);return ik(of(e),n._key).then((t=>AI(e,n,t)))}mi._jsonSchemaVersion="firestore/querySnapshot/1.0",mi._jsonSchema={type:ut("string",mi._jsonSchemaVersion),bundleSource:ut("string","QuerySnapshot"),bundleName:ut("string"),bundle:ut("string")};class TI extends vk{constructor(e){super(),this.firestore=e}convertBytes(e){return new ln(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gt(this.firestore,null,t)}}function wI(n,e,t){n=js(n,gt);const s=js(n.firestore,Fi),r=Ek(n.converter,e,t);return bI(s,[fk(dk(s),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Qt.none())])}function wk(n){return bI(js(n.firestore,Fi),[new jc(n._key,Qt.none())])}function bk(n,...e){n=rn(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Og(e[s])||(t=e[s++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Og(e[s])){const c=e[s];e[s]=c.next?.bind(c),e[s+1]=c.error?.bind(c),e[s+2]=c.complete?.bind(c)}let i,o,l;if(n instanceof gt)o=js(n.firestore,Fi),l=ka(n._key.path),i={next:c=>{e[s]&&e[s](AI(o,n,c))},error:e[s+1],complete:e[s+2]};else{const c=js(n,Qc);o=js(c.firestore,Fi),l=c._query;const u=new TI(o);i={next:h=>{e[s]&&e[s](new mi(o,u,c,h))},error:e[s+1],complete:e[s+2]},yk(n._query)}return(function(u,h,f,m){const _=new uI(m),R=new eI(h,_,f);return u.asyncQueue.enqueueAndForget((async()=>XE(await Mh(u),R))),()=>{_.Nu(),u.asyncQueue.enqueueAndForget((async()=>ZE(await Mh(u),R)))}})(of(o),l,r,i)}function bI(n,e){return(function(s,r){const i=new ns;return s.asyncQueue.enqueueAndForget((async()=>HC(await rk(s),r,i))),i.promise})(of(n),e)}function AI(n,e,t){const s=t.docs.get(e._key),r=new TI(n);return new br(n,r,e._key,s,new Po(t.hasPendingWrites,t.fromCache),e.converter)}class Ak{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=SI(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function Sk(n){return new Ak(n)}class Rk{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=oc.provider,this._offlineComponentProvider={build:t=>new tk(t,e?.cacheSizeBytes,this.forceOwnership)}}}function SI(n){return new Rk(n?.forceOwnership)}function Lh(){return new uf("serverTimestamp")}(function(e,t=!0){(function(r){Ki=r})(ji),Ti(new Rr("firestore",((s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),l=new Fi(new H0(s.getProvider("auth-internal")),new Y0(o,s.getProvider("app-check-internal")),(function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ae(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kr(u.options.projectId,h)})(o,r),o);return i={useFetchStreams:t,...i},l._setSettings(i),l}),"PUBLIC").setMultipleInstances(!0)),Bs(_m,ym,e),Bs(_m,ym,"esm2020")})();const Pk={apiKey:"AIzaSyDMvSyTEhJGh7a0coyDWCDiAsWCgxE9QsU",authDomain:"realcitytransport.firebaseapp.com",databaseURL:"https://realcitytransport-default-rtdb.firebaseio.com",projectId:"realcitytransport",storageBucket:"realcitytransport.firebasestorage.app",messagingSenderId:"510805652928",appId:"1:510805652928:web:0559bdd8da50af10b7c425",measurementId:"G-JE98MMZMCW"},RI=Ny(Pk),Fh=$0(RI),cc=ak(RI,{localCache:Sk({tabManager:SI()})}),PI=be(null),vo=be(null),CI=be(!1);let Mg=!1;Mg||(CR(Fh,n=>{PI.value=n||null,CI.value=!0,n?.uid?console.log("   :  ",n.displayName||n.email):console.log("   :  ")}),Mg=!0);function Yc(){return{user:PI,authError:vo,authReady:CI,signInWithGoogle:async()=>{const t=new Jn;try{const s=await YR(Fh,t);return vo.value=null,console.log("useAuth:  !",s.user.displayName||s.user.email),s.user}catch(s){throw vo.value=s,console.error("useAuth:  :",s),s}},signOutUser:async()=>{try{return await kR(Fh),vo.value=null,console.log("useAuth:  !"),!0}catch(t){throw vo.value=t,console.error("useAuth:  :",t),t}}}}const lt=3600,Lg=60,Eo=8*lt,Ys=[{id:"sys_unlock_vehicle",type:"SYSTEM",domain:"vehicle",timePolicy:"FIXED",title:"  ",desc:"  . (  )",tier:1,durationSec:Eo,requires:[],revealAfter:[],enabled:!1,effects:[{type:"UNLOCK_FEATURE",featureKey:"vehicle"}]},{id:"sys_unlock_route",type:"SYSTEM",domain:"route",timePolicy:"FIXED",title:"  ",desc:"  . (  )",tier:1,durationSec:Eo,requires:[],revealAfter:[],enabled:!1,effects:[{type:"UNLOCK_FEATURE",featureKey:"route"}]},{id:"sys_unlock_construction",type:"SYSTEM",domain:"construction",timePolicy:"FIXED",title:"  ",desc:"  . (  )",tier:1,durationSec:Eo,requires:[],revealAfter:[],enabled:!1,effects:[{type:"UNLOCK_FEATURE",featureKey:"construction"}]},{id:"sys_unlock_finance",type:"SYSTEM",domain:"finance",timePolicy:"FIXED",title:"()  ",desc:"  . (  )",tier:1,durationSec:Eo,requires:[],revealAfter:[],enabled:!1,effects:[{type:"UNLOCK_FEATURE",featureKey:"finance"}]},{id:"sys_unlock_city",type:"SYSTEM",domain:"city",timePolicy:"FIXED",title:"  ",desc:"  . (  )",tier:1,durationSec:Eo,requires:[],revealAfter:[],enabled:!1,effects:[{type:"UNLOCK_FEATURE",featureKey:"city"}]},{id:"sys_preview_starter_vehicles",type:"REAL",domain:"vehicle",timePolicy:"SCALABLE",title:"  ",desc:' (//)    .   ""  ,     . (30,  )',tier:1,durationSec:30*Lg,requires:[],revealAfter:[],enabled:!0,effects:[{type:"UNLOCK_STARTER_FLEET_PREVIEW",transports:["bus","truck","rail"],runTimeMinSec:30*Lg,runTimeMaxSec:3*lt,countPerTransport:1,mode:"MANUAL"}]},{id:"sys_preview_auto_assign",type:"REAL",domain:"simulation",timePolicy:"SCALABLE",title:"  ",desc:"      . (1,  )",tier:1,durationSec:1*lt,requires:["sys_preview_starter_vehicles"],revealAfter:[],enabled:!0,effects:[{type:"UNLOCK_FEATURE",featureKey:"preview_auto_assign"},{type:"SET_PREVIEW_RUN_MODE",mode:"AUTO"}]},{id:"city_scale_region",type:"CITY",domain:"city",timePolicy:"SCALABLE",title:"  ",desc:'  ""  .',tier:1,durationSec:4*lt,requires:["sys_unlock_city"],revealAfter:["sys_unlock_city"],enabled:!0,effects:[{type:"SET_CITY_SCALE",scale:"REGION"}]},{id:"city_scale_city",type:"CITY",domain:"city",timePolicy:"SCALABLE",title:"  ",desc:'  ""  . (  )',tier:1,durationSec:8*lt,requires:["city_scale_region"],revealAfter:["sys_unlock_city"],enabled:!0,effects:[{type:"SET_CITY_SCALE",scale:"CITY"}]},{id:"city_scale_country",type:"CITY",domain:"city",timePolicy:"SCALABLE",title:"  ",desc:' ""  . ( / )',tier:1,durationSec:12*lt,requires:["city_scale_city"],revealAfter:["sys_unlock_city"],enabled:!0,effects:[{type:"SET_CITY_SCALE",scale:"COUNTRY"}]},{id:"city_scale_state",type:"CITY",domain:"city",timePolicy:"SCALABLE",title:"  ",desc:' ""  . (   )',tier:1,durationSec:16*lt,requires:["city_scale_country"],revealAfter:["sys_unlock_city"],enabled:!0,effects:[{type:"SET_CITY_SCALE",scale:"STATE"}]},{id:"city_scale_planet",type:"CITY",domain:"city",timePolicy:"SCALABLE",title:"  ",desc:' ""  . (   )',tier:1,durationSec:24*lt,requires:["city_scale_state"],revealAfter:["sys_unlock_city"],enabled:!0,effects:[{type:"SET_CITY_SCALE",scale:"PLANET"}]},{id:"unlock_bus_t1",type:"TRANSPORT",domain:"transport",timePolicy:"SCALABLE",title:"   ",desc:" (1) .",tier:1,durationSec:1*lt,requires:[],revealAfter:[],enabled:!0,effects:[{type:"UNLOCK_TRANSPORT_TIER",transportId:"bus",tier:1},{type:"GRANT_STARTER_VEHICLE",transportId:"bus",tier:1}]},{id:"unlock_truck_t1",type:"TRANSPORT",domain:"transport",timePolicy:"SCALABLE",title:"   ",desc:" (1) .",tier:1,durationSec:1*lt,requires:[],revealAfter:[],enabled:!0,effects:[{type:"UNLOCK_TRANSPORT_TIER",transportId:"truck",tier:1},{type:"GRANT_STARTER_VEHICLE",transportId:"truck",tier:1}]},{id:"unlock_rail_t1",type:"TRANSPORT",domain:"transport",timePolicy:"SCALABLE",title:"   ",desc:" (1) .",tier:1,durationSec:1*lt,requires:[],revealAfter:[],enabled:!0,effects:[{type:"UNLOCK_TRANSPORT_TIER",transportId:"rail",tier:1},{type:"GRANT_STARTER_VEHICLE",transportId:"rail",tier:1}]},{id:"unlock_plane_t1",type:"TRANSPORT",domain:"transport",timePolicy:"SCALABLE",title:"   ",desc:" (1) . ( :   )",tier:1,durationSec:2*lt,requires:["sys_unlock_city","city_scale_city"],revealAfter:["sys_unlock_city"],enabled:!0,effects:[{type:"UNLOCK_TRANSPORT_TIER",transportId:"plane",tier:1},{type:"GRANT_STARTER_VEHICLE",transportId:"plane",tier:1}]},{id:"unlock_ship_t1",type:"TRANSPORT",domain:"transport",timePolicy:"SCALABLE",title:"   ",desc:" (1) . ( :   )",tier:1,durationSec:2*lt,requires:["sys_unlock_city","city_scale_country"],revealAfter:["sys_unlock_city"],enabled:!0,effects:[{type:"UNLOCK_TRANSPORT_TIER",transportId:"ship",tier:1},{type:"GRANT_STARTER_VEHICLE",transportId:"ship",tier:1}]},{id:"unlock_spaceship_t1",type:"TRANSPORT",domain:"transport",timePolicy:"SCALABLE",title:"   ",desc:" (1) . ( :   )",tier:1,durationSec:3*lt,requires:["sys_unlock_city","city_scale_planet"],revealAfter:["sys_unlock_city"],enabled:!0,effects:[{type:"UNLOCK_TRANSPORT_TIER",transportId:"spaceship",tier:1},{type:"GRANT_STARTER_VEHICLE",transportId:"spaceship",tier:1}]},{id:"rs_1",type:"EFFICIENCY",domain:"research",timePolicy:"SCALABLE",title:"  I",desc:"     5% . (SYSTEM  8 )",tier:1,durationSec:1*lt,requires:[],revealAfter:[],enabled:!0,effects:[{type:"RESEARCH_SPEED_LEVEL",level:1}]},{id:"rs_2",type:"EFFICIENCY",domain:"research",timePolicy:"SCALABLE",title:"  II",desc:"     10% . (SYSTEM  8 )",tier:1,durationSec:2*lt,requires:["rs_1"],revealAfter:[],enabled:!0,effects:[{type:"RESEARCH_SPEED_LEVEL",level:2}]},{id:"rs_3",type:"EFFICIENCY",domain:"research",timePolicy:"SCALABLE",title:"  III",desc:"     15% . (SYSTEM  8 )",tier:1,durationSec:4*lt,requires:["rs_2"],revealAfter:[],enabled:!0,effects:[{type:"RESEARCH_SPEED_LEVEL",level:3}]},{id:"rs_4",type:"EFFICIENCY",domain:"research",timePolicy:"SCALABLE",title:"  IV",desc:"     20% . (SYSTEM  8 )",tier:1,durationSec:8*lt,requires:["rs_3"],revealAfter:[],enabled:!0,effects:[{type:"RESEARCH_SPEED_LEVEL",level:4}]},{id:"rs_5",type:"EFFICIENCY",domain:"research",timePolicy:"SCALABLE",title:"  V",desc:"     25% . (SYSTEM  8 )",tier:1,durationSec:16*lt,requires:["rs_4"],revealAfter:[],enabled:!0,effects:[{type:"RESEARCH_SPEED_LEVEL",level:5}]},{id:"t2_transport_foundation",type:"REAL",domain:"simulation",timePolicy:"SCALABLE",title:" 2  ()",desc:"2   .   .",tier:2,durationSec:12*lt,requires:[],revealAfter:[],enabled:!1,effects:[]}];function hf(n){return Ys.find(e=>e.id===n)||null}function Uu(n){return String(Math.max(0,Number(n)||0)).padStart(2,"0")}function Fg(n){const e=Math.max(0,Math.floor(Number(n)||0)),t=Math.floor(e/3600),s=Math.floor(e%3600/60),r=e%60;return{h:t,m:s,sec:r}}function Ug({h:n,m:e,sec:t}){return n>0?`${n}h ${Uu(e)}m ${Uu(t)}s`:e>0?`${e}m ${Uu(t)}s`:`${t}s`}function kI(){const n=r=>{const i=Math.max(0,Math.floor(Number(r||0)/1e3));return Ug(Fg(i))},e=r=>Ug(Fg(r));return{formatRemainMs:n,formatRemainSec:e,makeRemainLabelFromMs:r=>pe(()=>n(r.value)),makeRemainLabelFromSec:r=>pe(()=>e(r.value))}}const NI="rcts.research.saveEnabled",DI="rcts.research.autosave.enabled",VI="rcts.research.autosave.base",df="rcts.research.autosave.intervalMin",{kstDate:xI,isKstTimeReady:OI}=gy(),Ma=pe(()=>OI.value&&xI.value instanceof Date);function Jc(){return Ma.value?xI.value.getTime():Date.now()}const Ck=new Set(["sys_unlock_vehicle","sys_unlock_route","sys_unlock_construction","sys_unlock_finance","sys_unlock_city"]);function uc(n){return!n||!Ck.has(n)?!1:hf(n)?.enabled===!1}const Gn=be(null),Lt=be(new Set),Ye=be(null),Ze=be([]),MI=be({}),LI=be(1),ff=be(0),ma=be(1),Mr=be(1),hc=be("NONE"),dc=be({vehicle:!1,route:!1,construction:!1,finance:!1,city:!1}),Pl=be(!1),Uh=be(!1),$n=be(!1),Js=be(null);let Ht=null,ss=!1,Cl=null;const Ar=be(UI(NI,!0)),ga=be(UI(DI,!1)),pf=be(BI(VI,5)),_a=be(BI(df,10)),mf=be(!1),FI=be(0);let gr=null;function UI(n,e){const t=localStorage.getItem(n);return t===null?e:t==="1"}function BI(n,e){const t=localStorage.getItem(n),s=t==null?NaN:Number(t);return Number.isFinite(s)?s:e}function $I(n,e){localStorage.setItem(n,e?"1":"0")}function Bh(n,e){localStorage.setItem(n,String(e))}function Xc(n){const e=Math.max(1,Math.min(3,Number(n||1)));return e===1?1:e===2?3:5}function kk(n){Ar.value=!!n,$I(NI,Ar.value),Ar.value?La():(Ht&&(clearTimeout(Ht),Ht=null),yn())}function Nk(n){ga.value=!!n,$I(DI,ga.value),La()}function Dk(n){const e=Number(n)===10?10:5;pf.value=e,Bh(VI,e);const t=Number(_a.value)||e,s=Math.max(e,Math.round(t/e)*e);_a.value=s,Bh(df,s),La(!0)}function Vk(n){const e=Number(pf.value)===10?10:5,t=Number(n);if(!Number.isFinite(t)||t<=0)return;const s=Math.max(e,Math.round(t/e)*e);_a.value=s,Bh(df,s),La(!0)}function xk(n){const e=Number(n);if(!Number.isFinite(e)||e<=0)return 6e4;const t=e*60*1e3,s=540*60*1e3,r=Date.now()+s,o=(Math.floor(r/t)+1)*t-r;return Math.max(1e3,o)}function yn(){mf.value=!1,gr&&(clearTimeout(gr),gr=null)}function jI(){if(gr&&(clearTimeout(gr),gr=null),!ga.value||!Ar.value||!Js.value||!$n.value||ss)return yn();mf.value=!0;const n=Number(_a.value)||10,e=xk(n);gr=setTimeout(async()=>{try{await Sn({reason:"autosave"}),FI.value=Date.now()}catch(t){console.error("useResearch:  :",t)}finally{jI()}},e)}function La(n=!1){n&&yn(),ga.value&&Ar.value&&Js.value&&$n.value&&!ss?jI():yn()}function Ok(){Ht&&(clearTimeout(Ht),Ht=null),yn(),Js.value=null,$n.value=!1,ss=!1}function Mk(n){return(Array.isArray(n?.requires)?n.requires:[]).every(t=>Lt.value.has(t))}function qI(n){const e=Array.isArray(n?.revealAfter)?n.revealAfter:[];return e.length===0?!0:e.every(t=>Lt.value.has(t))}function gf(n){return Lt.value.has(n)}function Lk(n){return!n||Number(n.tier||1)!==1?!1:(n.effects||[]).some(e=>e?.type==="UNLOCK_TRANSPORT_TIER"&&Number(e?.tier||1)===1&&!!e?.transportId)}function KI(n){return n?n.timePolicy==="FIXED"?!0:n.type==="SYSTEM":!1}function Fk(n){return n?n.timePolicy==="SCALABLE"?!0:n.timePolicy==null?!KI(n):!1:!1}function fc(n){switch(String(n||"").toUpperCase()){case"REGION":return 1;case"CITY":return 2;case"COUNTRY":return 3;case"STATE":return 4;case"PLANET":return 5;default:return 0}}function Hi(){const n={};let e=1,t=0,s=1,r="NONE";const i={vehicle:!1,route:!1,construction:!1,finance:!1,city:!1};for(const c of Ys)if(Lt.value.has(c.id))for(const u of c.effects||[]){if(u.type==="UNLOCK_TRANSPORT_TIER"){const h=u.transportId,f=Number(u.tier||1);if(!h)continue;n[h]=Math.max(Number(n[h]||0),f)}if(u.type==="INCOME_MULTIPLIER"&&(e*=Number(u.value||1)),u.type==="RESEARCH_SPEED_LEVEL"){const h=Number(u.level||0);Number.isFinite(h)&&(t=Math.max(t,h))}if(u.type==="QUEUE_RESERVE_LEVEL"){const h=Number(u.level||1);Number.isFinite(h)&&(s=Math.max(s,h))}if(u.type==="UNLOCK_FEATURE"){const h=String(u.featureKey||"");h&&Object.prototype.hasOwnProperty.call(i,h)&&(i[h]=!0)}if(u.type==="SET_CITY_SCALE"){const h=String(u.scale||"").toUpperCase();fc(h)>fc(r)&&(r=h)}}MI.value=n,LI.value=e,ff.value=t;const o=1-.05*Math.max(0,t);ma.value=Math.max(.2,o),hc.value=r,dc.value=i,Mr.value=Math.max(1,Math.min(3,s));const l=Xc(Mr.value);Ze.value.length>l&&(Ze.value=Ze.value.slice(0,l))}const Uk=pe(()=>Ys.filter(n=>Number(n?.tier||1)>=2?!0:qI(n))),Bk=pe(()=>{const n=new Set;for(const e of Ys)if(Number(e.tier||1)===1)for(const t of e.effects||[])t.type==="UNLOCK_TRANSPORT_TIER"&&Number(t.tier||1)===1&&t.transportId&&n.add(t.transportId);return Array.from(n)}),$k=pe(()=>!Gn.value),jk=pe(()=>Bk.value.map(n=>({id:n})));function qk(){return Lt.value.has("unlock_bus_t1")||Lt.value.has("unlock_truck_t1")||Lt.value.has("unlock_rail_t1")}function _f(n){const e=hf(n);if(!e)return"unknown";const t=Number(e.tier||1);return t===1&&!qI(e)?"hidden":gf(n)?"done":Ye.value?.id===n?"active":Ze.value.includes(n)?"queued":e.enabled===!1?"comingSoon":n==="sys_preview_starter_vehicles"?!Gn.value||!qk()?"locked":"available":t===1&&Lk(e)&&Gn.value||Mk(e)?"available":"locked"}function GI(n){return Ys.find(t=>t.enabled!==!1&&Number(t.tier||1)===1&&(t.effects||[]).some(s=>s.type==="UNLOCK_TRANSPORT_TIER"&&s.transportId===n&&Number(s.tier||1)===1))?.id??null}function zI(){return!(!Js.value||!$n.value||ss)}function Kk(){return Ar.value?zI():!1}function HI(){const n=Xc(Mr.value);return{version:10,firstUnlockTransportId:Gn.value??null,completedResearchIds:Array.from(Lt.value),activeResearch:Ye.value?{id:Ye.value.id,startedAtMs:Ye.value.startedAtMs,endsAtMs:Ye.value.endsAtMs}:null,queuedResearchIds:Array.isArray(Ze.value)?Ze.value.slice(0,n):[]}}function Gk(n){Gn.value=typeof n?.firstUnlockTransportId=="string"?n.firstUnlockTransportId:typeof n?.firstUnlockId=="string"?n.firstUnlockId:null;const e=Array.isArray(n?.completedResearchIds)?n.completedResearchIds:[];Lt.value=new Set(e.filter(o=>typeof o=="string"));const t=n?.activeResearch;t&&typeof t=="object"&&typeof t.id=="string"?Ye.value={id:t.id,startedAtMs:Number(t.startedAtMs||0),endsAtMs:Number(t.endsAtMs||0)}:Ye.value=null;const s=Array.isArray(n?.queuedResearchIds)?n.queuedResearchIds.filter(o=>typeof o=="string"):[],r=typeof n?.queuedResearchId=="string"?n.queuedResearchId:null,i=[];for(const o of s)i.includes(o)||i.push(o);if(r&&!i.includes(r)&&i.push(r),Ze.value=i,Lt.value.size===0&&Array.isArray(n?.transports)){for(const o of n.transports)if(!(!o||typeof o.id!="string")&&o.locked===!1){const l=GI(o.id);l&&Lt.value.add(l)}}Hi()}async function Sn({reason:n="manual"}={}){if(zI()){Ht&&(clearTimeout(Ht),Ht=null);try{Uh.value=!0;const e={...HI(),updatedAt:Lh(),lastSaveReason:n},t=ac(cc,"users",Js.value,"research","state");await wI(t,e,{merge:!0})}catch(e){console.error("useResearch: Firebase  :",e)}finally{Uh.value=!1}}}const zk=()=>{Kk()&&(Ht&&clearTimeout(Ht),Ht=setTimeout(async()=>{await Sn({reason:"debounced"})},800))};function Hk(n){if(!n||Gn.value)return;const e=GI(n);e&&(Gn.value=n,Lt.value.add(e),Hi(),Sn({reason:"firstUnlock"}))}function WI(n){if(uc(n))return{ok:!1,reason:"COMING_SOON"};const e=hf(n);if(!e)return{ok:!1,reason:"UNKNOWN_RESEARCH"};if(!Gn.value)return{ok:!1,reason:"FIRST_UNLOCK_REQUIRED"};if(!Ma.value)return{ok:!1,reason:"KST_NOT_READY"};if(gf(n))return{ok:!1,reason:"ALREADY_DONE"};if(e.enabled===!1)return{ok:!1,reason:"COMING_SOON"};const t=_f(n);if(t!=="available")return{ok:!1,reason:t.toUpperCase()};const s=Jc(),r=Number(e.durationSec||0);let i=0;return r>0&&(KI(e)?i=Math.ceil(r):(Fk(e),i=Math.ceil(r*ma.value))),i<=0?(Lt.value.add(n),Hi(),Sn({reason:"instantComplete"}),{ok:!0,instant:!0}):(Ye.value={id:n,startedAtMs:s,endsAtMs:s+i*1e3},Sn({reason:"startResearch"}),{ok:!0,instant:!1})}function Wk(n){if(uc(n))return{ok:!1,reason:"COMING_SOON"};const e=Xc(Mr.value);if(gf(n))return{ok:!1,reason:"ALREADY_DONE"};if(Ye.value?.id===n)return{ok:!1,reason:"ALREADY_ACTIVE"};if(Ze.value.includes(n))return{ok:!0,queued:!0,alreadyQueued:!0};if(Ye.value){if(Ze.value.length>=e)return{ok:!1,reason:"QUEUE_FULL"};const t=_f(n);return t!=="available"?{ok:!1,reason:t.toUpperCase()}:(Ze.value=[...Ze.value,n].slice(0,e),Sn({reason:"queueAdd"}),{ok:!0,queued:!0})}return WI(n)}function Qk(n){const e=Ze.value.slice(),t=e.filter(s=>s!==n);t.length!==e.length&&(Ze.value=t,Sn({reason:"queueCancel"}))}function Yk(){Ze.value.length!==0&&(Ze.value=[],Sn({reason:"queueCancelAll"}))}function Jk(n){if(!Ye.value||Ye.value.id!==n||!Ma.value)return 0;const e=Ye.value.endsAtMs-Ye.value.startedAtMs;if(e<=0)return 0;const t=Jc()-Ye.value.startedAtMs;return Math.max(0,Math.min(100,t/e*100))}function Xk(n){const{formatRemainSec:e}=kI();if(!Ye.value||Ye.value.id!==n||!Ma.value)return"0s";const t=Math.max(0,Ye.value.endsAtMs-Jc()),s=Math.floor(t/1e3);return e(s)}function QI(){Cl&&(Cl(),Cl=null),Ht&&(clearTimeout(Ht),Ht=null),yn(),Js.value=null,$n.value=!1,ss=!1}function YI(n){if(!n)return;QI(),Js.value=n,Pl.value=!0,$n.value=!1;const e=ac(cc,"users",n,"research","state");Cl=bk(e,async t=>{ss=!0;try{if(t.exists())Gk(t.data());else{Hi();const s={...HI(),createdAt:Lh(),updatedAt:Lh(),lastSaveReason:"init"};await wI(e,s,{merge:!0})}}catch(s){console.error("useResearch: onSnapshot apply failed:",s)}finally{ss=!1,Pl.value=!1,$n.value=!0,La(!0)}},t=>{ss=!1,Pl.value=!1,$n.value=!1,yn(),console.error("useResearch: onSnapshot error:",t)})}async function Zk(n){YI(n)}function eN(){Ok(),Gn.value=null,Lt.value=new Set,Ye.value=null,Ze.value=[],hc.value="NONE",dc.value={vehicle:!1,route:!1,construction:!1,finance:!1,city:!1},ff.value=0,ma.value=1,Mr.value=1,Hi()}Do(()=>{if(ss)return;let n=!1;if(Ye.value?.id&&uc(Ye.value.id)&&(Ye.value=null,n=!0),Array.isArray(Ze.value)&&Ze.value.length>0){const e=Ze.value.filter(t=>!uc(t));e.length!==Ze.value.length&&(Ze.value=e,n=!0)}n&&Sn({reason:"hardLockCleanup"})});Do(()=>{if(!Ma.value)return;const n=Jc();if(Ye.value&&n>=Number(Ye.value.endsAtMs||0)){const e=Ye.value.id;if(Ye.value=null,Lt.value.add(e),Hi(),Ze.value.length>0){const[t,...s]=Ze.value;Ze.value=s;const r=WI(t);r?.ok||console.warn("useResearch: queued next start failed:",t,r?.reason)}Sn({reason:"researchComplete"})}});function $r(){const n=pe(()=>!Js.value||$n.value),e=pe(()=>Xc(Mr.value)),t=pe(()=>Ze.value.length),s=pe(()=>t.value>=e.value);return{catalog:Ys,visibleCatalog:Uk,firstUnlockTransportId:Gn,needsFirstUnlockSelection:$k,firstUnlockCandidates:jk,setFirstUnlockTransport:Hk,completedIds:Lt,activeResearch:Ye,queuedResearchIds:Ze,queueReserveLevel:Mr,queueLimit:e,queueCount:t,isQueueFull:s,unlockedTransportTiers:MI,incomeMultiplier:LI,researchSpeedLevel:ff,researchDurationMultiplier:ma,cityScale:hc,unlockedFeatures:dc,hasFeature:o=>!!dc.value?.[o],cityScaleAtLeast:o=>fc(hc.value)>=fc(o),getStatus:_f,startResearch:Wk,cancelQueuedResearch:Qk,cancelAllQueuedResearch:Yk,getResearchProgress:Jk,getResearchRemainingTime:Xk,isKstTimeReady:OI,subscribeForUser:YI,unsubscribe:QI,loadForUser:Zk,clearUserState:eN,saveNow:Sn,scheduleSave:zk,saveEnabled:Ar,setSaveEnabled:kk,autoSaveEnabled:ga,autoSaveBase:pf,autoSaveIntervalMin:_a,setAutoSaveEnabled:Nk,setAutoSaveBase:Dk,setAutoSaveIntervalMin:Vk,autoSaveRunning:mf,lastAutoSaveAtMs:FI,isLoadingFirebaseData:Pl,isSavingFirebaseData:Uh,isStateLoaded:$n,isHydrated:n}}let Bg=!1;function tN(){const{user:n,authReady:e}=Yc(),t=$r(),s=pe(()=>n.value?.uid||null);return{start:()=>{Bg||(Ln([e,s],async([i,o],[l,c])=>{i&&(c&&c!==o&&t.unsubscribe(),o?t.subscribeForUser(o):(t.unsubscribe(),t.clearUserState()))},{immediate:!0}),Bg=!0)}}}const nN={__name:"App",setup(n){return tN().start(),od(()=>{aA()}),(e,t)=>{const s=Yo("router-view");return W(),vi(s)}}};const ii=typeof document<"u";function JI(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function sN(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&JI(n.default)}const Le=Object.assign;function Bu(n,e){const t={};for(const s in e){const r=e[s];t[s]=Rn(r)?r.map(n):n(r)}return t}const zo=()=>{},Rn=Array.isArray;function $g(n,e){const t={};for(const s in n)t[s]=s in e?e[s]:n[s];return t}const XI=/#/g,rN=/&/g,iN=/\//g,oN=/=/g,aN=/\?/g,ZI=/\+/g,lN=/%5B/g,cN=/%5D/g,eT=/%5E/g,uN=/%60/g,tT=/%7B/g,hN=/%7C/g,nT=/%7D/g,dN=/%20/g;function yf(n){return n==null?"":encodeURI(""+n).replace(hN,"|").replace(lN,"[").replace(cN,"]")}function fN(n){return yf(n).replace(tT,"{").replace(nT,"}").replace(eT,"^")}function $h(n){return yf(n).replace(ZI,"%2B").replace(dN,"+").replace(XI,"%23").replace(rN,"%26").replace(uN,"`").replace(tT,"{").replace(nT,"}").replace(eT,"^")}function pN(n){return $h(n).replace(oN,"%3D")}function mN(n){return yf(n).replace(XI,"%23").replace(aN,"%3F")}function gN(n){return mN(n).replace(iN,"%2F")}function ya(n){if(n==null)return null;try{return decodeURIComponent(""+n)}catch{}return""+n}const _N=/\/$/,yN=n=>n.replace(_N,"");function $u(n,e,t="/"){let s,r={},i="",o="";const l=e.indexOf("#");let c=e.indexOf("?");return c=l>=0&&c>l?-1:c,c>=0&&(s=e.slice(0,c),i=e.slice(c,l>0?l:e.length),r=n(i.slice(1))),l>=0&&(s=s||e.slice(0,l),o=e.slice(l,e.length)),s=TN(s??e,t),{fullPath:s+i+o,path:s,query:r,hash:ya(o)}}function vN(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function jg(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function EN(n,e,t){const s=e.matched.length-1,r=t.matched.length-1;return s>-1&&s===r&&Ui(e.matched[s],t.matched[r])&&sT(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function Ui(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function sT(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(var t in n)if(!IN(n[t],e[t]))return!1;return!0}function IN(n,e){return Rn(n)?qg(n,e):Rn(e)?qg(e,n):n?.valueOf()===e?.valueOf()}function qg(n,e){return Rn(e)?n.length===e.length&&n.every((t,s)=>t===e[s]):n.length===1&&n[0]===e}function TN(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),s=n.split("/"),r=s[s.length-1];(r===".."||r===".")&&s.push("");let i=t.length-1,o,l;for(o=0;o<s.length;o++)if(l=s[o],l!==".")if(l==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+s.slice(o).join("/")}const As={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let jh=(function(n){return n.pop="pop",n.push="push",n})({}),ju=(function(n){return n.back="back",n.forward="forward",n.unknown="",n})({});function wN(n){if(!n)if(ii){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),yN(n)}const bN=/^[^#]+#/;function AN(n,e){return n.replace(bN,"#")+e}function SN(n,e){const t=document.documentElement.getBoundingClientRect(),s=n.getBoundingClientRect();return{behavior:e.behavior,left:s.left-t.left-(e.left||0),top:s.top-t.top-(e.top||0)}}const Zc=()=>({left:window.scrollX,top:window.scrollY});function RN(n){let e;if("el"in n){const t=n.el,s=typeof t=="string"&&t.startsWith("#"),r=typeof t=="string"?s?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!r)return;e=SN(r,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Kg(n,e){return(history.state?history.state.position-e:-1)+n}const qh=new Map;function PN(n,e){qh.set(n,e)}function CN(n){const e=qh.get(n);return qh.delete(n),e}function kN(n){return typeof n=="string"||n&&typeof n=="object"}function rT(n){return typeof n=="string"||typeof n=="symbol"}let it=(function(n){return n[n.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",n[n.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",n[n.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",n[n.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",n[n.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",n})({});const iT=Symbol("");it.MATCHER_NOT_FOUND+"",it.NAVIGATION_GUARD_REDIRECT+"",it.NAVIGATION_ABORTED+"",it.NAVIGATION_CANCELLED+"",it.NAVIGATION_DUPLICATED+"";function Bi(n,e){return Le(new Error,{type:n,[iT]:!0},e)}function Hn(n,e){return n instanceof Error&&iT in n&&(e==null||!!(n.type&e))}const NN=["params","query","hash"];function DN(n){if(typeof n=="string")return n;if(n.path!=null)return n.path;const e={};for(const t of NN)t in n&&(e[t]=n[t]);return JSON.stringify(e,null,2)}function VN(n){const e={};if(n===""||n==="?")return e;const t=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<t.length;++s){const r=t[s].replace(ZI," "),i=r.indexOf("="),o=ya(i<0?r:r.slice(0,i)),l=i<0?null:ya(r.slice(i+1));if(o in e){let c=e[o];Rn(c)||(c=e[o]=[c]),c.push(l)}else e[o]=l}return e}function Gg(n){let e="";for(let t in n){const s=n[t];if(t=pN(t),s==null){s!==void 0&&(e+=(e.length?"&":"")+t);continue}(Rn(s)?s.map(r=>r&&$h(r)):[s&&$h(s)]).forEach(r=>{r!==void 0&&(e+=(e.length?"&":"")+t,r!=null&&(e+="="+r))})}return e}function xN(n){const e={};for(const t in n){const s=n[t];s!==void 0&&(e[t]=Rn(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}const ON=Symbol(""),zg=Symbol(""),eu=Symbol(""),vf=Symbol(""),Kh=Symbol("");function Io(){let n=[];function e(s){return n.push(s),()=>{const r=n.indexOf(s);r>-1&&n.splice(r,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function ks(n,e,t,s,r,i=o=>o()){const o=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((l,c)=>{const u=m=>{m===!1?c(Bi(it.NAVIGATION_ABORTED,{from:t,to:e})):m instanceof Error?c(m):kN(m)?c(Bi(it.NAVIGATION_GUARD_REDIRECT,{from:e,to:m})):(o&&s.enterCallbacks[r]===o&&typeof m=="function"&&o.push(m),l())},h=i(()=>n.call(s&&s.instances[r],e,t,u));let f=Promise.resolve(h);n.length<3&&(f=f.then(u)),f.catch(m=>c(m))})}function qu(n,e,t,s,r=i=>i()){const i=[];for(const o of n)for(const l in o.components){let c=o.components[l];if(!(e!=="beforeRouteEnter"&&!o.instances[l]))if(JI(c)){const u=(c.__vccOpts||c)[e];u&&i.push(ks(u,t,s,o,l,r))}else{let u=c();i.push(()=>u.then(h=>{if(!h)throw new Error(`Couldn't resolve component "${l}" at "${o.path}"`);const f=sN(h)?h.default:h;o.mods[l]=h,o.components[l]=f;const m=(f.__vccOpts||f)[e];return m&&ks(m,t,s,o,l,r)()}))}}return i}function MN(n,e){const t=[],s=[],r=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const l=e.matched[o];l&&(n.matched.find(u=>Ui(u,l))?s.push(l):t.push(l));const c=n.matched[o];c&&(e.matched.find(u=>Ui(u,c))||r.push(c))}return[t,s,r]}let LN=()=>location.protocol+"//"+location.host;function oT(n,e){const{pathname:t,search:s,hash:r}=e,i=n.indexOf("#");if(i>-1){let o=r.includes(n.slice(i))?n.slice(i).length:1,l=r.slice(o);return l[0]!=="/"&&(l="/"+l),jg(l,"")}return jg(t,n)+s+r}function FN(n,e,t,s){let r=[],i=[],o=null;const l=({state:m})=>{const _=oT(n,location),R=t.value,x=e.value;let O=0;if(m){if(t.value=_,e.value=m,o&&o===R){o=null;return}O=x?m.position-x.position:0}else s(_);r.forEach($=>{$(t.value,R,{delta:O,type:jh.pop,direction:O?O>0?ju.forward:ju.back:ju.unknown})})};function c(){o=t.value}function u(m){r.push(m);const _=()=>{const R=r.indexOf(m);R>-1&&r.splice(R,1)};return i.push(_),_}function h(){if(document.visibilityState==="hidden"){const{history:m}=window;if(!m.state)return;m.replaceState(Le({},m.state,{scroll:Zc()}),"")}}function f(){for(const m of i)m();i=[],window.removeEventListener("popstate",l),window.removeEventListener("pagehide",h),document.removeEventListener("visibilitychange",h)}return window.addEventListener("popstate",l),window.addEventListener("pagehide",h),document.addEventListener("visibilitychange",h),{pauseListeners:c,listen:u,destroy:f}}function Hg(n,e,t,s=!1,r=!1){return{back:n,current:e,forward:t,replaced:s,position:window.history.length,scroll:r?Zc():null}}function UN(n){const{history:e,location:t}=window,s={value:oT(n,t)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,u,h){const f=n.indexOf("#"),m=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+c:LN()+n+c;try{e[h?"replaceState":"pushState"](u,"",m),r.value=u}catch(_){console.error(_),t[h?"replace":"assign"](m)}}function o(c,u){i(c,Le({},e.state,Hg(r.value.back,c,r.value.forward,!0),u,{position:r.value.position}),!0),s.value=c}function l(c,u){const h=Le({},r.value,e.state,{forward:c,scroll:Zc()});i(h.current,h,!0),i(c,Le({},Hg(s.value,c,null),{position:h.position+1},u),!1),s.value=c}return{location:s,state:r,push:l,replace:o}}function BN(n){n=wN(n);const e=UN(n),t=FN(n,e.state,e.location,e.replace);function s(i,o=!0){o||t.pauseListeners(),history.go(i)}const r=Le({location:"",base:n,go:s,createHref:AN.bind(null,n)},e,t);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}let _r=(function(n){return n[n.Static=0]="Static",n[n.Param=1]="Param",n[n.Group=2]="Group",n})({});var mt=(function(n){return n[n.Static=0]="Static",n[n.Param=1]="Param",n[n.ParamRegExp=2]="ParamRegExp",n[n.ParamRegExpEnd=3]="ParamRegExpEnd",n[n.EscapeNext=4]="EscapeNext",n})(mt||{});const $N={type:_r.Static,value:""},jN=/[a-zA-Z0-9_]/;function qN(n){if(!n)return[[]];if(n==="/")return[[$N]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(_){throw new Error(`ERR (${t})/"${u}": ${_}`)}let t=mt.Static,s=t;const r=[];let i;function o(){i&&r.push(i),i=[]}let l=0,c,u="",h="";function f(){u&&(t===mt.Static?i.push({type:_r.Static,value:u}):t===mt.Param||t===mt.ParamRegExp||t===mt.ParamRegExpEnd?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:_r.Param,value:u,regexp:h,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),u="")}function m(){u+=c}for(;l<n.length;){if(c=n[l++],c==="\\"&&t!==mt.ParamRegExp){s=t,t=mt.EscapeNext;continue}switch(t){case mt.Static:c==="/"?(u&&f(),o()):c===":"?(f(),t=mt.Param):m();break;case mt.EscapeNext:m(),t=s;break;case mt.Param:c==="("?t=mt.ParamRegExp:jN.test(c)?m():(f(),t=mt.Static,c!=="*"&&c!=="?"&&c!=="+"&&l--);break;case mt.ParamRegExp:c===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+c:t=mt.ParamRegExpEnd:h+=c;break;case mt.ParamRegExpEnd:f(),t=mt.Static,c!=="*"&&c!=="?"&&c!=="+"&&l--,h="";break;default:e("Unknown state");break}}return t===mt.ParamRegExp&&e(`Unfinished custom RegExp for param "${u}"`),f(),o(),r}const Wg="[^/]+?",KN={sensitive:!1,strict:!1,start:!0,end:!0};var jt=(function(n){return n[n._multiplier=10]="_multiplier",n[n.Root=90]="Root",n[n.Segment=40]="Segment",n[n.SubSegment=30]="SubSegment",n[n.Static=40]="Static",n[n.Dynamic=20]="Dynamic",n[n.BonusCustomRegExp=10]="BonusCustomRegExp",n[n.BonusWildcard=-50]="BonusWildcard",n[n.BonusRepeatable=-20]="BonusRepeatable",n[n.BonusOptional=-8]="BonusOptional",n[n.BonusStrict=.7000000000000001]="BonusStrict",n[n.BonusCaseSensitive=.25]="BonusCaseSensitive",n})(jt||{});const GN=/[.+*?^${}()[\]/\\]/g;function zN(n,e){const t=Le({},KN,e),s=[];let r=t.start?"^":"";const i=[];for(const u of n){const h=u.length?[]:[jt.Root];t.strict&&!u.length&&(r+="/");for(let f=0;f<u.length;f++){const m=u[f];let _=jt.Segment+(t.sensitive?jt.BonusCaseSensitive:0);if(m.type===_r.Static)f||(r+="/"),r+=m.value.replace(GN,"\\$&"),_+=jt.Static;else if(m.type===_r.Param){const{value:R,repeatable:x,optional:O,regexp:$}=m;i.push({name:R,repeatable:x,optional:O});const U=$||Wg;if(U!==Wg){_+=jt.BonusCustomRegExp;try{`${U}`}catch(P){throw new Error(`Invalid custom RegExp for param "${R}" (${U}): `+P.message)}}let D=x?`((?:${U})(?:/(?:${U}))*)`:`(${U})`;f||(D=O&&u.length<2?`(?:/${D})`:"/"+D),O&&(D+="?"),r+=D,_+=jt.Dynamic,O&&(_+=jt.BonusOptional),x&&(_+=jt.BonusRepeatable),U===".*"&&(_+=jt.BonusWildcard)}h.push(_)}s.push(h)}if(t.strict&&t.end){const u=s.length-1;s[u][s[u].length-1]+=jt.BonusStrict}t.strict||(r+="/?"),t.end?r+="$":t.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,t.sensitive?"":"i");function l(u){const h=u.match(o),f={};if(!h)return null;for(let m=1;m<h.length;m++){const _=h[m]||"",R=i[m-1];f[R.name]=_&&R.repeatable?_.split("/"):_}return f}function c(u){let h="",f=!1;for(const m of n){(!f||!h.endsWith("/"))&&(h+="/"),f=!1;for(const _ of m)if(_.type===_r.Static)h+=_.value;else if(_.type===_r.Param){const{value:R,repeatable:x,optional:O}=_,$=R in u?u[R]:"";if(Rn($)&&!x)throw new Error(`Provided param "${R}" is an array but it is not repeatable (* or + modifiers)`);const U=Rn($)?$.join("/"):$;if(!U)if(O)m.length<2&&(h.endsWith("/")?h=h.slice(0,-1):f=!0);else throw new Error(`Missing required param "${R}"`);h+=U}}return h||"/"}return{re:o,score:s,keys:i,parse:l,stringify:c}}function HN(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=e[t]-n[t];if(s)return s;t++}return n.length<e.length?n.length===1&&n[0]===jt.Static+jt.Segment?-1:1:n.length>e.length?e.length===1&&e[0]===jt.Static+jt.Segment?1:-1:0}function aT(n,e){let t=0;const s=n.score,r=e.score;for(;t<s.length&&t<r.length;){const i=HN(s[t],r[t]);if(i)return i;t++}if(Math.abs(r.length-s.length)===1){if(Qg(s))return 1;if(Qg(r))return-1}return r.length-s.length}function Qg(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const WN={strict:!1,end:!0,sensitive:!1};function QN(n,e,t){const s=zN(qN(n.path),t),r=Le(s,{record:n,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function YN(n,e){const t=[],s=new Map;e=$g(WN,e);function r(f){return s.get(f)}function i(f,m,_){const R=!_,x=Jg(f);x.aliasOf=_&&_.record;const O=$g(e,f),$=[x];if("alias"in f){const P=typeof f.alias=="string"?[f.alias]:f.alias;for(const j of P)$.push(Jg(Le({},x,{components:_?_.record.components:x.components,path:j,aliasOf:_?_.record:x})))}let U,D;for(const P of $){const{path:j}=P;if(m&&j[0]!=="/"){const Y=m.record.path,I=Y[Y.length-1]==="/"?"":"/";P.path=m.record.path+(j&&I+j)}if(U=QN(P,m,O),_?_.alias.push(U):(D=D||U,D!==U&&D.alias.push(U),R&&f.name&&!Xg(U)&&o(f.name)),lT(U)&&c(U),x.children){const Y=x.children;for(let I=0;I<Y.length;I++)i(Y[I],U,_&&_.children[I])}_=_||U}return D?()=>{o(D)}:zo}function o(f){if(rT(f)){const m=s.get(f);m&&(s.delete(f),t.splice(t.indexOf(m),1),m.children.forEach(o),m.alias.forEach(o))}else{const m=t.indexOf(f);m>-1&&(t.splice(m,1),f.record.name&&s.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function l(){return t}function c(f){const m=ZN(f,t);t.splice(m,0,f),f.record.name&&!Xg(f)&&s.set(f.record.name,f)}function u(f,m){let _,R={},x,O;if("name"in f&&f.name){if(_=s.get(f.name),!_)throw Bi(it.MATCHER_NOT_FOUND,{location:f});O=_.record.name,R=Le(Yg(m.params,_.keys.filter(D=>!D.optional).concat(_.parent?_.parent.keys.filter(D=>D.optional):[]).map(D=>D.name)),f.params&&Yg(f.params,_.keys.map(D=>D.name))),x=_.stringify(R)}else if(f.path!=null)x=f.path,_=t.find(D=>D.re.test(x)),_&&(R=_.parse(x),O=_.record.name);else{if(_=m.name?s.get(m.name):t.find(D=>D.re.test(m.path)),!_)throw Bi(it.MATCHER_NOT_FOUND,{location:f,currentLocation:m});O=_.record.name,R=Le({},m.params,f.params),x=_.stringify(R)}const $=[];let U=_;for(;U;)$.unshift(U.record),U=U.parent;return{name:O,path:x,params:R,matched:$,meta:XN($)}}n.forEach(f=>i(f));function h(){t.length=0,s.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:h,getRoutes:l,getRecordMatcher:r}}function Yg(n,e){const t={};for(const s of e)s in n&&(t[s]=n[s]);return t}function Jg(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:JN(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function JN(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const s in n.components)e[s]=typeof t=="object"?t[s]:t;return e}function Xg(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function XN(n){return n.reduce((e,t)=>Le(e,t.meta),{})}function ZN(n,e){let t=0,s=e.length;for(;t!==s;){const i=t+s>>1;aT(n,e[i])<0?s=i:t=i+1}const r=eD(n);return r&&(s=e.lastIndexOf(r,s-1)),s}function eD(n){let e=n;for(;e=e.parent;)if(lT(e)&&aT(n,e)===0)return e}function lT({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function Zg(n){const e=In(eu),t=In(vf),s=pe(()=>{const c=Be(n.to);return e.resolve(c)}),r=pe(()=>{const{matched:c}=s.value,{length:u}=c,h=c[u-1],f=t.matched;if(!h||!f.length)return-1;const m=f.findIndex(Ui.bind(null,h));if(m>-1)return m;const _=e_(c[u-2]);return u>1&&e_(h)===_&&f[f.length-1].path!==_?f.findIndex(Ui.bind(null,c[u-2])):m}),i=pe(()=>r.value>-1&&iD(t.params,s.value.params)),o=pe(()=>r.value>-1&&r.value===t.matched.length-1&&sT(t.params,s.value.params));function l(c={}){if(rD(c)){const u=e[Be(n.replace)?"replace":"push"](Be(n.to)).catch(zo);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:s,href:pe(()=>s.value.href),isActive:i,isExactActive:o,navigate:l}}function tD(n){return n.length===1?n[0]:n}const nD=L_({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Zg,setup(n,{slots:e}){const t=Ic(Zg(n)),{options:s}=In(eu),r=pe(()=>({[t_(n.activeClass,s.linkActiveClass,"router-link-active")]:t.isActive,[t_(n.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&tD(e.default(t));return n.custom?i:uy("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:r.value},i)}}}),sD=nD;function rD(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function iD(n,e){for(const t in e){const s=e[t],r=n[t];if(typeof s=="string"){if(s!==r)return!1}else if(!Rn(r)||r.length!==s.length||s.some((i,o)=>i.valueOf()!==r[o].valueOf()))return!1}return!0}function e_(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const t_=(n,e,t)=>n??e??t,oD=L_({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const s=In(Kh),r=pe(()=>n.route||s.value),i=In(zg,0),o=pe(()=>{let u=Be(i);const{matched:h}=r.value;let f;for(;(f=h[u])&&!f.components;)u++;return u}),l=pe(()=>r.value.matched[o.value]);ll(zg,pe(()=>o.value+1)),ll(ON,l),ll(Kh,r);const c=be();return Ln(()=>[c.value,l.value,n.name],([u,h,f],[m,_,R])=>{h&&(h.instances[f]=u,_&&_!==h&&u&&u===m&&(h.leaveGuards.size||(h.leaveGuards=_.leaveGuards),h.updateGuards.size||(h.updateGuards=_.updateGuards))),u&&h&&(!_||!Ui(h,_)||!m)&&(h.enterCallbacks[f]||[]).forEach(x=>x(u))},{flush:"post"}),()=>{const u=r.value,h=n.name,f=l.value,m=f&&f.components[h];if(!m)return n_(t.default,{Component:m,route:u});const _=f.props[h],R=_?_===!0?u.params:typeof _=="function"?_(u):_:null,O=uy(m,Le({},R,e,{onVnodeUnmounted:$=>{$.component.isUnmounted&&(f.instances[h]=null)},ref:c}));return n_(t.default,{Component:O,route:u})||O}}});function n_(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const aD=oD;function lD(n){const e=YN(n.routes,n),t=n.parseQuery||VN,s=n.stringifyQuery||Gg,r=n.history,i=Io(),o=Io(),l=Io(),c=pw(As);let u=As;ii&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=Bu.bind(null,B=>""+B),f=Bu.bind(null,gN),m=Bu.bind(null,ya);function _(B,le){let te,de;return rT(B)?(te=e.getRecordMatcher(B),de=le):de=B,e.addRoute(de,te)}function R(B){const le=e.getRecordMatcher(B);le&&e.removeRoute(le)}function x(){return e.getRoutes().map(B=>B.record)}function O(B){return!!e.getRecordMatcher(B)}function $(B,le){if(le=Le({},le||c.value),typeof B=="string"){const k=$u(t,B,le.path),L=e.resolve({path:k.path},le),K=r.createHref(k.fullPath);return Le(k,L,{params:m(L.params),hash:ya(k.hash),redirectedFrom:void 0,href:K})}let te;if(B.path!=null)te=Le({},B,{path:$u(t,B.path,le.path).path});else{const k=Le({},B.params);for(const L in k)k[L]==null&&delete k[L];te=Le({},B,{params:f(k)}),le.params=f(le.params)}const de=e.resolve(te,le),Ce=B.hash||"";de.params=h(m(de.params));const E=vN(s,Le({},B,{hash:fN(Ce),path:de.path})),b=r.createHref(E);return Le({fullPath:E,hash:Ce,query:s===Gg?xN(B.query):B.query||{}},de,{redirectedFrom:void 0,href:b})}function U(B){return typeof B=="string"?$u(t,B,c.value.path):Le({},B)}function D(B,le){if(u!==B)return Bi(it.NAVIGATION_CANCELLED,{from:le,to:B})}function P(B){return I(B)}function j(B){return P(Le(U(B),{replace:!0}))}function Y(B,le){const te=B.matched[B.matched.length-1];if(te&&te.redirect){const{redirect:de}=te;let Ce=typeof de=="function"?de(B,le):de;return typeof Ce=="string"&&(Ce=Ce.includes("?")||Ce.includes("#")?Ce=U(Ce):{path:Ce},Ce.params={}),Le({query:B.query,hash:B.hash,params:Ce.path!=null?{}:B.params},Ce)}}function I(B,le){const te=u=$(B),de=c.value,Ce=B.state,E=B.force,b=B.replace===!0,k=Y(te,de);if(k)return I(Le(U(k),{state:typeof k=="object"?Le({},Ce,k.state):Ce,force:E,replace:b}),le||te);const L=te;L.redirectedFrom=le;let K;return!E&&EN(s,de,te)&&(K=Bi(it.NAVIGATION_DUPLICATED,{to:L,from:de}),Ut(de,de,!0,!1)),(K?Promise.resolve(K):S(L,de)).catch(F=>Hn(F)?Hn(F,it.NAVIGATION_GUARD_REDIRECT)?F:an(F):Re(F,L,de)).then(F=>{if(F){if(Hn(F,it.NAVIGATION_GUARD_REDIRECT))return I(Le({replace:b},U(F.to),{state:typeof F.to=="object"?Le({},Ce,F.to.state):Ce,force:E}),le||L)}else F=C(L,de,!0,b,Ce);return A(L,de,F),F})}function v(B,le){const te=D(B,le);return te?Promise.reject(te):Promise.resolve()}function w(B){const le=Z.values().next().value;return le&&typeof le.runWithContext=="function"?le.runWithContext(B):B()}function S(B,le){let te;const[de,Ce,E]=MN(B,le);te=qu(de.reverse(),"beforeRouteLeave",B,le);for(const k of de)k.leaveGuards.forEach(L=>{te.push(ks(L,B,le))});const b=v.bind(null,B,le);return te.push(b),Ge(te).then(()=>{te=[];for(const k of i.list())te.push(ks(k,B,le));return te.push(b),Ge(te)}).then(()=>{te=qu(Ce,"beforeRouteUpdate",B,le);for(const k of Ce)k.updateGuards.forEach(L=>{te.push(ks(L,B,le))});return te.push(b),Ge(te)}).then(()=>{te=[];for(const k of E)if(k.beforeEnter)if(Rn(k.beforeEnter))for(const L of k.beforeEnter)te.push(ks(L,B,le));else te.push(ks(k.beforeEnter,B,le));return te.push(b),Ge(te)}).then(()=>(B.matched.forEach(k=>k.enterCallbacks={}),te=qu(E,"beforeRouteEnter",B,le,w),te.push(b),Ge(te))).then(()=>{te=[];for(const k of o.list())te.push(ks(k,B,le));return te.push(b),Ge(te)}).catch(k=>Hn(k,it.NAVIGATION_CANCELLED)?k:Promise.reject(k))}function A(B,le,te){l.list().forEach(de=>w(()=>de(B,le,te)))}function C(B,le,te,de,Ce){const E=D(B,le);if(E)return E;const b=le===As,k=ii?history.state:{};te&&(de||b?r.replace(B.fullPath,Le({scroll:b&&k&&k.scroll},Ce)):r.push(B.fullPath,Ce)),c.value=B,Ut(B,le,te,b),an()}let T;function ue(){T||(T=r.listen((B,le,te)=>{if(!se.listening)return;const de=$(B),Ce=Y(de,se.currentRoute.value);if(Ce){I(Le(Ce,{replace:!0,force:!0}),de).catch(zo);return}u=de;const E=c.value;ii&&PN(Kg(E.fullPath,te.delta),Zc()),S(de,E).catch(b=>Hn(b,it.NAVIGATION_ABORTED|it.NAVIGATION_CANCELLED)?b:Hn(b,it.NAVIGATION_GUARD_REDIRECT)?(I(Le(U(b.to),{force:!0}),de).then(k=>{Hn(k,it.NAVIGATION_ABORTED|it.NAVIGATION_DUPLICATED)&&!te.delta&&te.type===jh.pop&&r.go(-1,!1)}).catch(zo),Promise.reject()):(te.delta&&r.go(-te.delta,!1),Re(b,de,E))).then(b=>{b=b||C(de,E,!1),b&&(te.delta&&!Hn(b,it.NAVIGATION_CANCELLED)?r.go(-te.delta,!1):te.type===jh.pop&&Hn(b,it.NAVIGATION_ABORTED|it.NAVIGATION_DUPLICATED)&&r.go(-1,!1)),A(de,E,b)}).catch(zo)}))}let oe=Io(),Ve=Io(),Oe;function Re(B,le,te){an(B);const de=Ve.list();return de.length?de.forEach(Ce=>Ce(B,le,te)):console.error(B),Promise.reject(B)}function Tt(){return Oe&&c.value!==As?Promise.resolve():new Promise((B,le)=>{oe.add([B,le])})}function an(B){return Oe||(Oe=!B,ue(),oe.list().forEach(([le,te])=>B?te(B):le()),oe.reset()),B}function Ut(B,le,te,de){const{scrollBehavior:Ce}=n;if(!ii||!Ce)return Promise.resolve();const E=!te&&CN(Kg(B.fullPath,0))||(de||!te)&&history.state&&history.state.scroll||null;return N_().then(()=>Ce(B,le,E)).then(b=>b&&RN(b)).catch(b=>Re(b,B,le))}const ft=B=>r.go(B);let ie;const Z=new Set,se={currentRoute:c,listening:!0,addRoute:_,removeRoute:R,clearRoutes:e.clearRoutes,hasRoute:O,getRoutes:x,resolve:$,options:n,push:P,replace:j,go:ft,back:()=>ft(-1),forward:()=>ft(1),beforeEach:i.add,beforeResolve:o.add,afterEach:l.add,onError:Ve.add,isReady:Tt,install(B){B.component("RouterLink",sD),B.component("RouterView",aD),B.config.globalProperties.$router=se,Object.defineProperty(B.config.globalProperties,"$route",{enumerable:!0,get:()=>Be(c)}),ii&&!ie&&c.value===As&&(ie=!0,P(r.location).catch(de=>{}));const le={};for(const de in As)Object.defineProperty(le,de,{get:()=>c.value[de],enumerable:!0});B.provide(eu,se),B.provide(vf,R_(le)),B.provide(Kh,c);const te=B.unmount;Z.add(B),B.unmount=function(){Z.delete(B),Z.size<1&&(u=As,T&&T(),T=null,c.value=As,ie=!1,Oe=!1),te()}}};function Ge(B){return B.reduce((le,te)=>le.then(()=>w(te)),Promise.resolve())}return se}function Wi(){return In(eu)}function cD(n){return In(vf)}const Yt=(n,e)=>{const t=n.__vccOpts||n;for(const[s,r]of e)t[s]=r;return t},uD={class:"top-bar-area"},hD={class:"top-bar-content"},dD={class:"center-area"},fD={class:"time-value"},pD={class:"right-area"},mD={class:"auth-text"},gD={class:"auth-icon"},_D={__name:"TheTopBar",setup(n){const{kstString:e}=gy(),{user:t,signInWithGoogle:s,signOutUser:r}=Yc();return(i,o)=>(W(),J("header",uD,[g("div",hD,[o[2]||(o[2]=g("div",{class:"left-area"},[g("h1",{class:"game-title"},"RCTS")],-1)),g("div",dD,[o[1]||(o[1]=g("span",{class:"time-label"},"KST",-1)),g("span",fD,_e(Be(e)),1)]),g("div",pD,[g("button",{class:"auth-btn",onClick:o[0]||(o[0]=l=>Be(t)?Be(r)():Be(s)())},[g("span",mD,_e(Be(t)?"":""),1),g("span",gD,_e(Be(t)?"":""),1)])])])]))}},yD=Yt(_D,[["__scopeId","data-v-0953860d"]]),vD=["bus","truck","rail","plane","ship","spaceship"],kl={bus:{name:"",icon:""},truck:{name:"",icon:""},rail:{name:"",icon:""},plane:{name:"",icon:""},ship:{name:"",icon:""},spaceship:{name:"",icon:""}};function ol(n,e=1){const t=Number(e||1);return Ys.find(r=>(r.effects||[]).some(i=>i.type==="UNLOCK_TRANSPORT_TIER"&&i.transportId===n&&Number(i.tier||1)===t))?.id??null}function ED(){return Ys.filter(t=>(t.effects||[]).some(s=>s?.type==="UNLOCK_STARTER_FLEET_PREVIEW")).map(t=>{const s=(t.effects||[]).find(i=>i?.type==="UNLOCK_STARTER_FLEET_PREVIEW")||null,r=s?{transports:Array.isArray(s.transports)?s.transports.filter(Boolean):[],runTimeMinSec:Number(s.runTimeMinSec||0),runTimeMaxSec:Number(s.runTimeMaxSec||0),countPerTransport:Number(s.countPerTransport||1)}:null;return{researchId:t.id,config:r}})}function cT(){const n=$r(),e=pe(()=>ED()),t=pe(()=>{const m=n.completedIds.value,_=e.value||[];return!m||_.length===0?!1:_.some(R=>R?.researchId&&m.has(R.researchId))}),s=pe(()=>{const m=n.completedIds.value,_=e.value||[];return _.length&&((m?_.find(x=>x?.researchId&&m.has(x.researchId)):null)?.researchId??_[0]?.researchId)||null}),r=pe(()=>{const m=n.completedIds.value,_=e.value||[];return _.length?(m?_.find(x=>x?.researchId&&m.has(x.researchId)):null)?.config??_[0]?.config??null:null}),i=pe(()=>{const m=r.value;return m?new Set(m.transports||[]):new Set}),o=pe(()=>{const m=i.value,_=t.value;return vD.map(R=>{const x=kl[R]||{},O=x.name??R,$=x.icon??"",D=Number(n.unlockedTransportTiers.value?.[R]||0)<1,P=ol(R,1),j=!!P&&n.activeResearch.value?.id===P;let Y=null,I=null;j&&n.activeResearch.value&&(Y=new Date(n.activeResearch.value.startedAtMs),I=new Date(n.activeResearch.value.endsAtMs));const v=m.has(R),w=!!_&&!D&&v;return{id:R,name:O,icon:$,locked:D,isResearching:j,researchStartTime:Y,researchFinishTime:I,unlockResearchId:P,previewEligible:v,previewActive:w,previewLabel:w?"  ":null}})}),l=pe(()=>o.value.filter(m=>m.locked)),c=pe(()=>o.value.filter(m=>!m.locked));function u(m){const _=ol(m,1);_&&n.startResearch(_)}function h(m){const _=ol(m,1);return _?n.getResearchProgress(_):0}function f(m){const _=ol(m,1);return _?n.getResearchRemainingTime(_):"00h 00m 00s"}return{transportTypes:o,lockedTransports:l,unlockedTransports:c,unlockTransport:u,getResearchProgress:h,getResearchRemainingTime:f,previewResearchId:s,previewConfig:r,previewStarterFleetUnlocked:t}}const s_=be(null);function ID(){return{selectedTransportId:s_,setSelectedTransportId:e=>{s_.value=e}}}const uT="rcts.preview.runs.v2",TD=60,wD=30*TD,bD=3*3600;function AD(n,e){const t=Math.ceil(n),s=Math.floor(e);return Math.floor(Math.random()*(s-t+1))+t}function SD(){try{const n=localStorage.getItem(uT);if(!n)return null;const e=JSON.parse(n);return!e||typeof e!="object"?null:e}catch{return null}}function To(n){try{localStorage.setItem(uT,JSON.stringify(n))}catch{}}function Ss(n,e){const t={transportId:n,status:"idle",startedAtMs:null,endsAtMs:null,durationSec:0,routeName:" "};if(!e||typeof e!="object")return t;const s=e.status==="running"||e.status==="idle"||e.status==="ready"?e.status:"idle";return{...t,...e,transportId:e.transportId||n,status:s,routeName:e.routeName||" "}}function RD(){const n=$r(),{transportTypes:e}=cT(),{formatRemainMs:t}=kI(),s=pe(()=>!!n.completedIds.value?.has?.("sys_preview_starter_vehicles")),r=pe(()=>!!n.completedIds.value?.has?.("sys_preview_auto_assign")),i=pe(()=>{const D=e.value||[];return new Set(D.filter(P=>P?.previewActive).map(P=>P.id))}),o=be({}),l=be(Date.now()),c=SD();c?.runs&&typeof c.runs=="object"&&(o.value=c.runs),Do(()=>{const D=o.value||{};let P=!1;for(const[j,Y]of Object.entries(D)){const I=Ss(j,Y);(!Y?.status||Y.status!==I.status||Y.routeName!==I.routeName)&&(D[j]=I,P=!0)}P&&(o.value={...D},To({runs:o.value}))});function u(D,P=Date.now()){const j=AD(wD,bD),Y=Ss(D,o.value?.[D]);o.value[D]={...Y,transportId:D,status:"running",startedAtMs:P,endsAtMs:P+j*1e3,durationSec:j,routeName:" "}}function h(D=Date.now()){if(!s.value||!r.value)return!1;const P=i.value;if(!P||P.size===0)return!1;let j=!1;for(const Y of P){const I=Ss(Y,o.value?.[Y]);if(I.status!=="running")u(Y,D),j=!0;else{const v=Number(I.endsAtMs||0);(!v||v<=D)&&(u(Y,D),j=!0)}}return j&&To({runs:o.value}),j}Do(()=>{if(!s.value)return;const D=i.value;if(!D||D.size===0)return;let P=!1;for(const j of D)o.value?.[j]||(u(j,Date.now()),P=!0);P&&To({runs:o.value}),h(Date.now())});let f=null;function m(){f||(f=setInterval(()=>{if(l.value=Date.now(),!s.value)return;const D=l.value,P=i.value;let j=!1;r.value&&h(D)&&(j=!0);for(const Y of Object.keys(o.value||{})){if(!P.has(Y))continue;const I=Ss(Y,o.value[Y]);if(I.status!=="running")continue;const v=Number(I.endsAtMs||0);v&&D>=v&&(r.value?u(Y,D):o.value[Y]={...I,status:"ready",startedAtMs:null,endsAtMs:v,durationSec:I.durationSec||0,routeName:" "},j=!0)}j&&To({runs:o.value})},1e3))}function _(){f&&(clearInterval(f),f=null)}Do(()=>{if(!s.value){_();return}m(),WT(()=>{_()})});function R(D){const P=l.value;if(!i.value.has(D))return 0;const j=Ss(D,o.value?.[D]);if(j.status!=="running")return 0;const Y=Number(j.endsAtMs||0);return Y?Math.max(0,Y-P):0}function x(D){return t(R(D))}function O(D){return i.value.has(D)?Ss(D,o.value?.[D]).status:"idle"}function $(D){return!s.value||!i.value.has(D)||r.value||Ss(D,o.value?.[D]).status!=="ready"?!1:(u(D,Date.now()),To({runs:o.value}),l.value=Date.now(),!0)}const U=pe(()=>{const D=i.value;return Object.values(o.value||{}).map(j=>Ss(j.transportId,j)).filter(j=>D.has(j.transportId)).sort((j,Y)=>String(j.transportId).localeCompare(String(Y.transportId)))});return{previewUnlocked:s,autoAssignUnlocked:r,runs:o,runList:U,remainingOf:x,statusOf:O,startManualRun:$}}const PD={class:"layout-area left-area"},CD={class:"left-panel-wrapper"},kD={class:"panel transport-list-container"},ND={class:"panel-head"},DD={class:"panel-meta"},VD={key:0,class:"transport-list"},xD=["onClick"],OD={class:"transport-icon"},MD={class:"transport-name"},LD={key:1,class:"placeholder-box"},FD={class:"panel transport-details-container"},UD={class:"panel-head"},BD={class:"panel-heading"},$D={key:0,class:"panel-meta"},jD={key:0,class:"placeholder-box"},qD={key:1,class:"details-content"},KD={class:"kv"},GD={class:"kv-row"},zD={class:"v"},HD={class:"kv-row"},WD={class:"v"},QD={class:"kv-row"},YD={class:"v"},JD={key:0,class:"lock-box"},XD={key:0,class:"preview-placeholder"},ZD={key:1,class:"preview-box"},eV={class:"box-desc"},tV={key:0,class:"preview-placeholder"},nV={key:1,class:"preview-data"},sV={class:"preview-left"},rV={class:"preview-title"},iV={class:"preview-sub"},oV={key:0,class:"preview-right"},aV={class:"preview-remain mono"},lV={key:1,class:"preview-right"},cV={key:0,class:"preview-right"},uV={class:"preview-remain mono"},hV={key:1,class:"preview-right"},dV=["onClick"],fV={class:"details-footnote"},pV={class:"panel resource-container"},mV={class:"panel-head"},gV={class:"panel-meta"},_V={key:0,class:"placeholder-box"},yV={key:1,class:"resource-content"},vV={__name:"TheLeftArea",setup(n){const e=$r(),{transportTypes:t,unlockedTransports:s,previewStarterFleetUnlocked:r,previewConfig:i}=cT(),o=pe(()=>!!e.completedIds.value?.has?.("sys_unlock_finance")),l=pe(()=>!!e.completedIds.value?.has?.("sys_unlock_finance")),{selectedTransportId:c,setSelectedTransportId:u}=ID(),h=pe(()=>s.value||[]),f=pe(()=>c.value&&(t.value||[]).find(D=>D.id===c.value)||null),m=pe(()=>{const D=new Set((s.value||[]).map(Y=>Y.id)),P=i.value;return(P&&Array.isArray(P.transports)&&P.transports.length>0?P.transports:["bus","truck","rail"]).some(Y=>D.has(Y))}),{runList:_,remainingOf:R,statusOf:x,startManualRun:O,autoAssignUnlocked:$}=RD();function U(D){return(t.value||[]).find(j=>j.id===D)?.name??D}return(D,P)=>(W(),J("aside",PD,[g("div",CD,[g("section",kD,[g("div",ND,[P[0]||(P[0]=g("h3",{class:"panel-heading"},"  ",-1)),g("span",DD,_e(h.value.length)+"",1)]),h.value.length>0?(W(),J("ul",VD,[(W(!0),J(Me,null,Rt(h.value,j=>(W(),J("li",{key:j.id,class:gi(["transport-item",{active:Be(c)===j.id}]),onClick:Y=>Be(u)(j.id)},[g("span",OD,_e(j.icon),1),g("span",MD,_e(j.name),1),P[1]||(P[1]=g("span",{class:"transport-count"},"0",-1))],10,xD))),128))])):(W(),J("div",LD,[...P[2]||(P[2]=[g("p",{class:"placeholder-text"},"     .   . ",-1)])]))]),g("section",FD,[g("div",UD,[g("h3",BD,_e(f.value?`${f.value.name} `:"  "),1),f.value?(W(),J("span",$D,"ID: "+_e(f.value.id),1)):at("",!0)]),f.value?(W(),J("div",qD,[g("div",KD,[g("div",GD,[P[4]||(P[4]=g("span",{class:"k"},"",-1)),g("span",zD,_e(f.value.icon),1)]),g("div",HD,[P[5]||(P[5]=g("span",{class:"k"},"",-1)),g("span",WD,_e(f.value.name),1)]),P[7]||(P[7]=g("div",{class:"kv-row"},[g("span",{class:"k"}," "),g("span",{class:"v"},"0")],-1)),g("div",QD,[P[6]||(P[6]=g("span",{class:"k"}," ",-1)),g("span",YD,_e(f.value.locked?"":""),1)])]),P[19]||(P[19]=g("hr",{class:"divider"},null,-1)),Be(r)?(W(),J("div",ZD,[P[18]||(P[18]=g("p",{class:"box-title"},"   ",-1)),g("p",eV,[P[12]||(P[12]=At(" (): ",-1)),g("strong",null,_e(l.value?"":""),1)]),Be(_).length===0?(W(),J("div",tV,[...P[13]||(P[13]=[g("p",{class:"placeholder-text"},"      . (/   ) ",-1)])])):(W(),J("div",nV,[(W(!0),J(Me,null,Rt(Be(_),j=>(W(),J("div",{class:"preview-row",key:j.transportId},[g("div",sV,[g("div",rV,_e(U(j.transportId)),1),g("div",iV,_e(j.routeName),1)]),Be($)?(W(),J(Me,{key:0},[Be(x)(j.transportId)==="running"?(W(),J("div",oV,[P[14]||(P[14]=g("div",{class:"preview-pill"},"",-1)),g("div",aV,_e(Be(R)(j.transportId)),1)])):(W(),J("div",lV,[...P[15]||(P[15]=[g("div",{class:"preview-idle-text"}," ",-1),g("div",{class:"preview-remain mono"},"00:00",-1)])]))],64)):(W(),J(Me,{key:1},[Be(x)(j.transportId)==="running"?(W(),J("div",cV,[P[16]||(P[16]=g("div",{class:"preview-pill"},"",-1)),g("div",uV,_e(Be(R)(j.transportId)),1)])):(W(),J("div",hV,[P[17]||(P[17]=g("div",{class:"preview-idle-text"},"",-1)),g("button",{class:"preview-btn",type:"button",onClick:Y=>Be(O)(j.transportId)},"    ",8,dV)]))],64))]))),128))]))])):(W(),J("div",JD,[P[9]||(P[9]=g("p",{class:"box-title"},"    ",-1)),P[10]||(P[10]=g("p",{class:"box-desc"},[At("  "),g("strong",null,"  "),At("  ,  "),g("strong",null," / "),At(" . ")],-1)),P[11]||(P[11]=g("p",{class:"box-desc subtle"}," (    .) ",-1)),m.value?at("",!0):(W(),J("div",XD,[...P[8]||(P[8]=[g("p",{class:"placeholder-text"}," :           . ",-1)])]))])),g("p",fV,"  "+_e(f.value.name)+"       . ",1)])):(W(),J("div",jD,[...P[3]||(P[3]=[g("p",{class:"placeholder-text"},"     .",-1)])]))]),g("section",pV,[g("div",mV,[P[20]||(P[20]=g("h3",{class:"panel-heading"},"  ",-1)),g("span",gV,_e(o.value?"":""),1)]),o.value?(W(),J("div",yV,[...P[22]||(P[22]=[g("div",{class:"kv"},[g("div",{class:"kv-row"},[g("span",{class:"k"},""),g("span",{class:"v"},"$10,000")])],-1)])])):(W(),J("div",_V,[...P[21]||(P[21]=[g("p",{class:"placeholder-text"}," .",-1)])]))])])]))}},hT=Yt(vV,[["__scopeId","data-v-c2ac4b92"]]),EV={class:"layout-area center-area"},IV={class:"center-content-wrapper"},TV={class:"main-content-nav desktop-only","aria-label":"Main navigation"},wV={class:"nav-list"},bV={class:"nav-item"},AV={class:"nav-item"},SV={class:"nav-item"},RV={class:"nav-item"},PV={class:"nav-item"},CV={class:"nav-item"},kV={class:"nav-item"},NV={class:"mobile-nav mobile-only","aria-label":"Mobile navigation header"},DV=["aria-expanded"],VV={class:"mobile-title"},xV={class:"mobile-title-text"},OV={class:"drawer",role:"dialog","aria-modal":"true","aria-label":"Main menu"},MV={class:"drawer-body"},LV={class:"main-content-display"},FV={__name:"TheCenterArea",setup(n){const e=Wi(),t=cD(),s=be(!1);function r(){s.value=!1}function i(){s.value=!s.value}function o(u){r(),e.push(u)}const l=pe(()=>{const u=t.path||"";return u.includes("/home/preview")?" ":u.includes("/home/research")?"":u.includes("/home/vehicles")?"":u.includes("/home/line")?"":u.includes("/home/construction")?"":u.includes("/home/finance")?"":u.includes("/home/city")?"":u.includes("/home/settings")?"":""});Ln(()=>t.fullPath,()=>{r()});function c(u){u.key==="Escape"&&r()}return Ln(s,u=>{document.body.style.overflow=u?"hidden":""}),od(()=>{window.addEventListener("keydown",c)}),$_(()=>{window.removeEventListener("keydown",c),document.body.style.overflow=""}),(u,h)=>{const f=Yo("router-link"),m=Yo("router-view");return W(),J("div",EV,[g("div",IV,[g("nav",TV,[g("ul",wV,[g("li",bV,[$e(f,{to:"/home/research"},{default:mn(()=>[...h[8]||(h[8]=[At("",-1)])]),_:1})]),g("li",AV,[$e(f,{to:"/home/vehicles"},{default:mn(()=>[...h[9]||(h[9]=[At("",-1)])]),_:1})]),g("li",SV,[$e(f,{to:"/home/line"},{default:mn(()=>[...h[10]||(h[10]=[At("",-1)])]),_:1})]),g("li",RV,[$e(f,{to:"/home/construction"},{default:mn(()=>[...h[11]||(h[11]=[At("",-1)])]),_:1})]),g("li",PV,[$e(f,{to:"/home/finance"},{default:mn(()=>[...h[12]||(h[12]=[At("",-1)])]),_:1})]),g("li",CV,[$e(f,{to:"/home/city"},{default:mn(()=>[...h[13]||(h[13]=[At("",-1)])]),_:1})]),g("li",kV,[$e(f,{to:"/home/settings"},{default:mn(()=>[...h[14]||(h[14]=[At("",-1)])]),_:1})])])]),g("div",NV,[g("button",{class:"hamburger-btn",type:"button","aria-label":"Open menu","aria-expanded":s.value?"true":"false",onClick:i},[...h[15]||(h[15]=[g("span",{class:"hamburger-icon"},"",-1),g("span",{class:"hamburger-label"},"",-1)])],8,DV),g("div",VV,[g("span",xV,_e(l.value),1)])]),s.value?(W(),J("div",{key:0,class:"drawer-overlay mobile-only",role:"presentation",onClick:py(r,["self"])},[g("aside",OV,[g("div",{class:"drawer-head"},[h[16]||(h[16]=g("div",{class:"drawer-title"},"RCTS ",-1)),g("button",{class:"drawer-close",type:"button","aria-label":"Close menu",onClick:r},"  ")]),g("div",MV,[g("button",{class:"drawer-item drawer-item-preview",type:"button",onClick:h[0]||(h[0]=_=>o("/home/preview"))},"   "),g("button",{class:"drawer-item",type:"button",onClick:h[1]||(h[1]=_=>o("/home/research"))},""),g("button",{class:"drawer-item",type:"button",onClick:h[2]||(h[2]=_=>o("/home/vehicles"))},""),g("button",{class:"drawer-item",type:"button",onClick:h[3]||(h[3]=_=>o("/home/line"))},""),g("button",{class:"drawer-item",type:"button",onClick:h[4]||(h[4]=_=>o("/home/construction"))},""),g("button",{class:"drawer-item",type:"button",onClick:h[5]||(h[5]=_=>o("/home/finance"))},""),g("button",{class:"drawer-item",type:"button",onClick:h[6]||(h[6]=_=>o("/home/city"))},""),g("button",{class:"drawer-item",type:"button",onClick:h[7]||(h[7]=_=>o("/home/settings"))},"")]),h[17]||(h[17]=g("div",{class:"drawer-foot"},[g("div",{class:"drawer-hint"},"     . ")],-1))])])):at("",!0),g("div",LV,[$e(m)])])])}}},UV=Yt(FV,[["__scopeId","data-v-6101d703"]]),BV={class:"game-wrapper"},$V={class:"main-layout"},jV={__name:"HomeView",setup(n){return(e,t)=>(W(),J("div",BV,[$e(yD),g("div",$V,[$e(hT,{class:"layout-area left-area desktop-only"}),$e(UV,{class:"layout-area center-area"})])]))}},qV=Yt(jV,[["__scopeId","data-v-baa77003"]]),KV={class:"research-page"},GV={class:"research-header"},zV={class:"status-row"},HV={key:0,class:"badge ok"},WV={class:"badge"},QV={class:"panel"},YV={class:"panel-head"},JV={class:"panel-actions"},XV=["disabled"],ZV={key:0,class:"empty"},ex={key:1,class:"empty"},tx={key:2,class:"list"},nx={class:"card"},sx={class:"card-mid"},rx={class:"name-row"},ix={class:"name"},ox={class:"meta"},ax={class:"pill time"},lx={key:0,class:"pill fixed"},cx={key:0,class:"hint2"},ux={class:"progress-area"},hx={class:"progress-bar"},dx={class:"progress-info"},fx={class:"mono"},px={key:1,class:"queue-row"},mx={class:"queue-title"},gx={key:2,class:"queue-list"},_x={class:"mono"},yx=["onClick"],vx={class:"panel"},Ex={key:0,class:"empty"},Ix={key:1,class:"empty"},Tx={key:2,class:"list"},wx={class:"card-left"},bx={class:"icon"},Ax={class:"card-mid"},Sx={class:"name-row"},Rx={class:"name"},Px={class:"meta"},Cx={key:0,class:"pill"},kx={key:0,class:"hint2"},Nx={class:"card-right"},Dx=["disabled","onClick"],Vx={class:"card-left"},xx={class:"icon"},Ox={class:"card-mid"},Mx={class:"name-row"},Lx={class:"name"},Fx={class:"meta"},Ux={class:"pill time"},Bx={key:0,class:"pill fixed"},$x={key:1,class:"pill"},jx={key:2,class:"pill"},qx={key:0,class:"hint2"},Kx={key:1,class:"hint2"},Gx={class:"card-right"},zx=["disabled","onClick"],Hx={class:"panel"},Wx={key:0,class:"empty"},Qx={key:1,class:"empty"},Yx={key:2,class:"list"},Jx={class:"card-mid"},Xx={class:"name-row"},Zx={class:"name"},eO={class:"meta"},tO={class:"pill lock"},nO={class:"pill time"},sO={key:0,class:"pill fixed"},rO={key:0,class:"hint2"},iO={key:1,class:"hint2"},oO={key:2,class:"hint2"},aO={__name:"ResearchView",setup(n){const e=$r(),t=pe(()=>e.isHydrated.value),s=e.firstUnlockTransportId,r=e.needsFirstUnlockSelection,i=e.firstUnlockCandidates,o=pe(()=>e.activeResearch.value),l=pe(()=>e.queuedResearchIds.value||[]),c=pe(()=>e.queueReserveLevel.value||1),u=pe(()=>e.queueLimit.value||1),h=pe(()=>e.queueCount.value||0),f=pe(()=>e.isQueueFull.value),m=pe(()=>!!e.saveEnabled.value&&!!e.isStateLoaded.value&&!e.isSavingFirebaseData.value);function _(ie){return kl[ie]?.name??ie}function R(ie){return e.catalog.find(Z=>Z.id===ie)||null}function x(ie){return R(ie)?.title??ie}function O(ie){return ie?ie.timePolicy==="FIXED"?!0:ie.type==="SYSTEM":!1}function $(ie){return O(R(ie))}function U(ie){const Z=Math.max(0,Number(ie||0));if(!Z)return"";if(Z<3600)return`${Math.max(1,Math.round(Z/60))}`;const se=Math.floor(Z/3600),Ge=Math.round(Z%3600/60);return Ge>0?`${se} ${Ge}`:`${se}`}function D(ie){const Z=Number(ie?.durationSec||0),se=O(ie),Ge=U(Z);return Ge===""?"":se?`: ${Ge}`:`: ${Ge}`}function P(ie){return D(R(ie))}function j(ie){return(ie.effects||[]).find(se=>se?.type==="UNLOCK_TRANSPORT_TIER"&&Number(se?.tier||1)===1)?.transportId||null}function Y(ie,Z){const se=j(ie);return!se||!Z.has(se)?null:{key:`first-${se}`,transportId:se,icon:kl[se]?.icon??"",title:`${kl[se]?.name??se}  `,desc:" 1  ."}}const I=pe(()=>{const ie=e.visibleCatalog.value||[];if(s.value)return[];const Z=new Set((i.value||[]).map(se=>se.id));return ie.map(se=>Y(se,Z)).filter(Boolean)});function v(ie,Z){const se=String(ie?.title??"").trim(),Ge=String(Z?.title??"").trim();return se.localeCompare(Ge,"ko")}function w(ie){return{id:ie.id,title:ie.title??ie.id,desc:ie.desc??"",durationLabel:D(ie),fixed:O(ie),type:ie.type,domain:ie.domain}}const S=pe(()=>(e.visibleCatalog.value||[]).filter(Z=>e.getStatus(Z.id)==="available").map(w).sort(v)),A=pe(()=>(e.visibleCatalog.value||[]).map(Z=>{const se=e.getStatus(Z.id);return se!=="locked"&&se!=="comingSoon"?null:{...w(Z),status:se,statusLabel:se==="comingSoon"?"":"",lockReason:"  ."}}).filter(Boolean).sort(v));function C(ie){const Z=String(ie?.type||"");return Z==="SYSTEM"?"":Z==="CITY"?"":Z==="TRANSPORT"?"":Z==="EFFICIENCY"?"":String(ie?.id||"").startsWith("sys_preview_")?"":""}function T(ie){return l.value.includes(ie)}function ue(ie){return o.value?T(ie)?"":f.value?" ":"":" "}function oe(ie){e.setFirstUnlockTransport(ie)}function Ve(ie){e.startResearch(ie)}function Oe(ie){e.cancelQueuedResearch(ie)}function Re(){e.cancelAllQueuedResearch()}function Tt(ie){return e.getResearchProgress(ie)}function an(ie){return e.getResearchRemainingTime(ie)}function Ut(ie){e.saveNow(ie)}function ft(){console.log("[ResearchView Debug]"),console.log("queueReserveLevel:",c.value),console.log("queueLimit:",u.value),console.log("queuedResearchIds:",l.value);const ie=(e.visibleCatalog.value||[]).filter(Z=>String(Z?.id||"").startsWith("sys_preview_"));console.log("[Preview durations]",ie.map(Z=>({id:Z.id,sec:Z.durationSec,label:D(Z)})))}return(ie,Z)=>(W(),J("div",KV,[g("header",GV,[Z[1]||(Z[1]=g("h1",{class:"title"},"",-1)),Z[2]||(Z[2]=g("p",{class:"desc"},"    1 .        . ",-1)),g("div",zV,[g("span",{class:gi(["badge",{ok:t.value}])},_e(t.value?"  ":"  "),3),g("span",{class:gi(["badge",{warn:Be(r)}])},_e(Be(r)?"  ()":"  "),3),Be(s)?(W(),J("span",HV,"  : "+_e(_(Be(s))),1)):at("",!0),g("span",WV," : "+_e(h.value)+"/"+_e(u.value)+" (Lv"+_e(c.value)+") ",1)])]),g("section",QV,[g("div",YV,[Z[3]||(Z[3]=g("h2",{class:"panel-title"}," ",-1)),g("div",JV,[g("button",{class:"btn",disabled:!m.value,onClick:Z[0]||(Z[0]=se=>Ut({reason:"manual"}))},"   ",8,XV),g("button",{class:"btn ghost",onClick:ft},"   ")])]),t.value?o.value?(W(),J("div",tx,[g("article",nx,[Z[6]||(Z[6]=g("div",{class:"card-left"},[g("div",{class:"icon"},"")],-1)),g("div",sx,[g("div",rx,[g("div",ix,_e(x(o.value.id)),1),g("div",ox,[Z[4]||(Z[4]=g("span",{class:"pill"},"",-1)),g("span",ax,_e(P(o.value.id)),1),$(o.value.id)?(W(),J("span",lx,"")):at("",!0)])]),$(o.value.id)?(W(),J("div",cx,"    ,     . ")):at("",!0),g("div",ux,[g("div",hx,[g("div",{class:"progress-fill",style:vc({transform:`scaleX(${Math.max(0,Math.min(100,Tt(o.value.id)))/100})`})},null,4)]),g("div",dx,[g("span",null,_e(Tt(o.value.id).toFixed(1))+"%",1),g("span",fx,": "+_e(an(o.value.id)),1)])]),l.value.length>0?(W(),J("div",px,[Z[5]||(Z[5]=g("span",{class:"pill"},"",-1)),g("span",mx,_e(l.value.length)+" ",1),g("button",{class:"btn small ghost",onClick:Re}," ")])):at("",!0),l.value.length>0?(W(),J("div",gx,[(W(!0),J(Me,null,Rt(l.value,se=>(W(),J("div",{key:se,class:"queue-item"},[g("span",_x,_e(x(se)),1),g("button",{class:"btn small ghost",onClick:Ge=>Oe(se)},"",8,yx)]))),128))])):at("",!0)]),Z[7]||(Z[7]=g("div",{class:"card-right"},[g("button",{class:"btn primary",disabled:""},"")],-1))])])):(W(),J("div",ex,"    .     . ")):(W(),J("div",ZV," "))]),g("section",vx,[Z[9]||(Z[9]=g("h2",{class:"panel-title"}," ( )",-1)),Z[10]||(Z[10]=g("p",{class:"panel-desc"},"     (  )   .       . ",-1)),t.value?S.value.length===0&&I.value.length===0?(W(),J("div",Ix,"     . ")):(W(),J("div",Tx,[(W(!0),J(Me,null,Rt(I.value,se=>(W(),J("article",{key:se.key,class:"card"},[g("div",wx,[g("div",bx,_e(se.icon),1)]),g("div",Ax,[g("div",Sx,[g("div",Rx,_e(se.title),1),g("div",Px,[Z[8]||(Z[8]=g("span",{class:"pill time"},"",-1)),Be(r)?(W(),J("span",Cx,"")):at("",!0)])]),se.desc?(W(),J("div",kx,_e(se.desc),1)):at("",!0)]),g("div",Nx,[g("button",{class:"btn primary",disabled:!!o.value||!t.value,onClick:Ge=>oe(se.transportId)},"   ",8,Dx)])]))),128)),(W(!0),J(Me,null,Rt(S.value,se=>(W(),J("article",{key:se.id,class:"card"},[g("div",Vx,[g("div",xx,_e(C(se)),1)]),g("div",Ox,[g("div",Mx,[g("div",Lx,_e(se.title),1),g("div",Fx,[g("span",Ux,_e(se.durationLabel),1),se.fixed?(W(),J("span",Bx,"")):at("",!0),o.value?(W(),J("span",$x,"")):(W(),J("span",jx,""))])]),se.desc?(W(),J("div",qx,_e(se.desc),1)):at("",!0),se.fixed?(W(),J("div",Kx,"        .")):at("",!0)]),g("div",Gx,[g("button",{class:"btn primary",disabled:!t.value||o.value&&f.value&&!T(se.id),onClick:Ge=>Ve(se.id)},_e(ue(se.id)),9,zx)])]))),128))])):(W(),J("div",Ex," "))]),g("section",Hx,[Z[13]||(Z[13]=g("h2",{class:"panel-title"},"  ",-1)),Z[14]||(Z[14]=g("p",{class:"panel-desc"},"     .        . ",-1)),t.value?A.value.length===0?(W(),J("div",Qx,"/  .")):(W(),J("div",Yx,[(W(!0),J(Me,null,Rt(A.value,se=>(W(),J("article",{key:se.id,class:"card"},[Z[11]||(Z[11]=g("div",{class:"card-left"},[g("div",{class:"icon"},"")],-1)),g("div",Jx,[g("div",Xx,[g("div",Zx,_e(se.title),1),g("div",eO,[g("span",tO,_e(se.statusLabel),1),g("span",nO,_e(se.durationLabel),1),se.fixed?(W(),J("span",sO,"")):at("",!0)])]),se.desc?(W(),J("div",rO,_e(se.desc),1)):at("",!0),se.status==="comingSoon"?(W(),J("div",iO,".")):se.status==="locked"?(W(),J("div",oO,_e(se.lockReason||"  ."),1)):at("",!0)]),Z[12]||(Z[12]=g("div",{class:"card-right"},[g("button",{class:"btn primary",disabled:""},"")],-1))]))),128))])):(W(),J("div",Wx," "))])]))}},lO=Yt(aO,[["__scopeId","data-v-b9cdda19"]]),cO={class:"page"},uO={class:"panel"},hO={class:"list"},dO={class:"panel"},fO={class:"grid"},pO={class:"table"},mO={__name:"VehiclesView",setup(n){const e=Wi();function t(){e.push("/home/research")}return(s,r)=>(W(),J("div",cO,[g("header",{class:"page-header"},[r[2]||(r[2]=g("h1",{class:"title"},"",-1)),r[3]||(r[3]=g("p",{class:"desc"},"     .      .",-1)),g("div",{class:"status-row"},[r[0]||(r[0]=g("span",{class:"badge lock"},"LOCKED",-1)),r[1]||(r[1]=g("span",{class:"badge"}," ",-1)),g("button",{class:"btn primary",onClick:t}," ")])]),g("section",uO,[r[5]||(r[5]=Tn('<div class="panel-head" data-v-e2a4d6c8><h2 class="panel-title" data-v-e2a4d6c8> </h2><div class="panel-actions" data-v-e2a4d6c8><button class="btn" disabled data-v-e2a4d6c8> </button><button class="btn" disabled data-v-e2a4d6c8></button><button class="btn ghost" disabled data-v-e2a4d6c8></button></div></div><div class="empty" data-v-e2a4d6c8>   . <span class="mono" data-v-e2a4d6c8> ( 8)</span>     . </div>',2)),g("div",hO,[(W(),J(Me,null,Rt(8,i=>g("article",{class:"card",key:i},[...r[4]||(r[4]=[Tn('<div class="card-left" data-v-e2a4d6c8><div class="icon" data-v-e2a4d6c8></div></div><div class="card-mid" data-v-e2a4d6c8><div class="name-row" data-v-e2a4d6c8><div class="name" data-v-e2a4d6c8>  </div><div class="meta" data-v-e2a4d6c8><span class="pill lock" data-v-e2a4d6c8></span><span class="pill time" data-v-e2a4d6c8></span></div></div><div class="hint2" data-v-e2a4d6c8>  :  ////  UI . </div></div><div class="card-right" data-v-e2a4d6c8><button class="btn primary" disabled data-v-e2a4d6c8></button></div>',3)])])),64))])]),g("section",dO,[r[9]||(r[9]=g("h2",{class:"panel-title"},"",-1)),r[10]||(r[10]=g("p",{class:"panel-desc"},"      .",-1)),g("div",fO,[(W(),J(Me,null,Rt(4,i=>g("div",{class:"mini-card",key:i},[...r[6]||(r[6]=[g("div",{class:"mini-title"},"",-1),g("div",{class:"mini-value muted"},"",-1),g("div",{class:"mini-sub muted"},"",-1)])])),64))]),g("div",pO,[r[8]||(r[8]=g("div",{class:"table-head"},[g("span",null,""),g("span",null,""),g("span",null,""),g("span",null,""),g("span",null,"")],-1)),(W(),J(Me,null,Rt(6,i=>g("div",{class:"table-row",key:i},[...r[7]||(r[7]=[Tn('<span class="muted" data-v-e2a4d6c8></span><span class="muted" data-v-e2a4d6c8></span><span class="muted" data-v-e2a4d6c8></span><span class="muted" data-v-e2a4d6c8></span><span class="muted" data-v-e2a4d6c8></span>',5)])])),64))])])]))}},gO=Yt(mO,[["__scopeId","data-v-e2a4d6c8"]]),_O={class:"page"},yO={class:"panel"},vO={class:"list"},EO={class:"panel"},IO={class:"table"},TO={__name:"LineView",setup(n){const e=Wi();function t(){e.push("/home/research")}return(s,r)=>(W(),J("div",_O,[g("header",{class:"page-header"},[r[2]||(r[2]=g("h1",{class:"title"},"",-1)),r[3]||(r[3]=g("p",{class:"desc"},"//     .    .",-1)),g("div",{class:"status-row"},[r[0]||(r[0]=g("span",{class:"badge lock"},"LOCKED",-1)),r[1]||(r[1]=g("span",{class:"badge"}," ",-1)),g("button",{class:"btn primary",onClick:t}," ")])]),g("section",yO,[r[5]||(r[5]=Tn('<div class="panel-head" data-v-58d6af1b><h2 class="panel-title" data-v-58d6af1b> </h2><div class="panel-actions" data-v-58d6af1b><button class="btn" disabled data-v-58d6af1b> </button><button class="btn" disabled data-v-58d6af1b> </button><button class="btn ghost" disabled data-v-58d6af1b> </button></div></div><div class="empty" data-v-58d6af1b>   .       . </div>',2)),g("div",vO,[(W(),J(Me,null,Rt(8,i=>g("article",{class:"card",key:i},[...r[4]||(r[4]=[Tn('<div class="card-left" data-v-58d6af1b><div class="icon" data-v-58d6af1b></div></div><div class="card-mid" data-v-58d6af1b><div class="name-row" data-v-58d6af1b><div class="name" data-v-58d6af1b>  </div><div class="meta" data-v-58d6af1b><span class="pill lock" data-v-58d6af1b></span><span class="pill time" data-v-58d6af1b></span></div></div><div class="hint2" data-v-58d6af1b>  : ,  , , /  . </div></div><div class="card-right" data-v-58d6af1b><button class="btn primary" disabled data-v-58d6af1b></button></div>',3)])])),64))])]),g("section",EO,[r[8]||(r[8]=g("h2",{class:"panel-title"},"",-1)),r[9]||(r[9]=g("p",{class:"panel-desc"},"    / .",-1)),g("div",IO,[r[7]||(r[7]=g("div",{class:"table-head"},[g("span",null,""),g("span",null,""),g("span",null,""),g("span",null,""),g("span",null,"")],-1)),(W(),J(Me,null,Rt(8,i=>g("div",{class:"table-row",key:i},[...r[6]||(r[6]=[Tn('<span class="muted" data-v-58d6af1b></span><span class="muted" data-v-58d6af1b></span><span class="muted" data-v-58d6af1b></span><span class="muted" data-v-58d6af1b></span><span class="muted" data-v-58d6af1b></span>',5)])])),64))])])]))}},wO=Yt(TO,[["__scopeId","data-v-58d6af1b"]]),bO={class:"page"},AO={class:"panel"},SO={class:"list"},RO={class:"panel"},PO={class:"grid"},CO={__name:"ConstructionView",setup(n){const e=Wi();function t(){e.push("/home/research")}return(s,r)=>(W(),J("div",bO,[g("header",{class:"page-header"},[r[2]||(r[2]=g("h1",{class:"title"},"",-1)),r[3]||(r[3]=g("p",{class:"desc"}," /     .    .",-1)),g("div",{class:"status-row"},[r[0]||(r[0]=g("span",{class:"badge lock"},"LOCKED",-1)),r[1]||(r[1]=g("span",{class:"badge"}," ",-1)),g("button",{class:"btn primary",onClick:t}," ")])]),g("section",AO,[r[5]||(r[5]=Tn('<div class="panel-head" data-v-f1dc01af><h2 class="panel-title" data-v-f1dc01af> </h2><div class="panel-actions" data-v-f1dc01af><button class="btn" disabled data-v-f1dc01af></button><button class="btn" disabled data-v-f1dc01af></button><button class="btn" disabled data-v-f1dc01af></button><button class="btn" disabled data-v-f1dc01af></button><button class="btn" disabled data-v-f1dc01af></button></div></div><div class="empty" data-v-f1dc01af>   .       . </div>',2)),g("div",SO,[(W(),J(Me,null,Rt(10,i=>g("article",{class:"card",key:i},[...r[4]||(r[4]=[Tn('<div class="card-left" data-v-f1dc01af><div class="icon" data-v-f1dc01af></div></div><div class="card-mid" data-v-f1dc01af><div class="name-row" data-v-f1dc01af><div class="name" data-v-f1dc01af>  </div><div class="meta" data-v-f1dc01af><span class="pill lock" data-v-f1dc01af></span><span class="pill time" data-v-f1dc01af></span></div></div><div class="hint2" data-v-f1dc01af>  : //,  ,    UI . </div></div><div class="card-right" data-v-f1dc01af><button class="btn primary" disabled data-v-f1dc01af></button></div>',3)])])),64))])]),g("section",RO,[r[7]||(r[7]=g("h2",{class:"panel-title"},"",-1)),r[8]||(r[8]=g("p",{class:"panel-desc"},"     /   /   .",-1)),g("div",PO,[(W(),J(Me,null,Rt(3,i=>g("div",{class:"mini-card",key:i},[...r[6]||(r[6]=[g("div",{class:"mini-title"},"",-1),g("div",{class:"mini-value muted"},"",-1),g("div",{class:"mini-sub muted"},"",-1)])])),64))])])]))}},kO=Yt(CO,[["__scopeId","data-v-f1dc01af"]]),NO={class:"page"},DO={class:"panel"},VO={class:"grid"},xO={class:"table"},OO={__name:"FinanceView",setup(n){const e=Wi();function t(){e.push("/home/research")}return(s,r)=>(W(),J("div",NO,[g("header",{class:"page-header"},[r[2]||(r[2]=g("h1",{class:"title"},"",-1)),r[3]||(r[3]=g("p",{class:"desc"},"//    .    .",-1)),g("div",{class:"status-row"},[r[0]||(r[0]=g("span",{class:"badge lock"},"LOCKED",-1)),r[1]||(r[1]=g("span",{class:"badge"}," ",-1)),g("button",{class:"btn primary",onClick:t}," ")])]),g("section",DO,[r[7]||(r[7]=Tn('<div class="panel-head" data-v-d1892e60><h2 class="panel-title" data-v-d1892e60> </h2><div class="panel-actions" data-v-d1892e60><button class="btn" disabled data-v-d1892e60></button><button class="btn" disabled data-v-d1892e60></button><button class="btn" disabled data-v-d1892e60></button><button class="btn ghost" disabled data-v-d1892e60></button></div></div><div class="empty" data-v-d1892e60>   .       . </div>',2)),g("div",VO,[(W(),J(Me,null,Rt(4,i=>g("div",{class:"mini-card",key:i},[...r[4]||(r[4]=[g("div",{class:"mini-title"},"",-1),g("div",{class:"mini-value muted"},"",-1),g("div",{class:"mini-sub muted"},"",-1)])])),64))]),g("div",xO,[r[6]||(r[6]=g("div",{class:"table-head"},[g("span",null,""),g("span",null,""),g("span",null,""),g("span",null,"")],-1)),(W(),J(Me,null,Rt(8,i=>g("div",{class:"table-row",key:i},[...r[5]||(r[5]=[g("span",{class:"muted"},"",-1),g("span",{class:"muted"},"",-1),g("span",{class:"muted"},"",-1),g("span",{class:"muted"},"",-1)])])),64))])])]))}},MO=Yt(OO,[["__scopeId","data-v-d1892e60"]]),LO={class:"page"},FO={class:"panel"},UO={class:"list"},BO={class:"panel"},$O={class:"grid"},jO={__name:"CityView",setup(n){const e=Wi();function t(){e.push("/home/research")}return(s,r)=>(W(),J("div",LO,[g("header",{class:"page-header"},[r[2]||(r[2]=g("h1",{class:"title"},"",-1)),r[3]||(r[3]=g("p",{class:"desc"}," //     .    .",-1)),g("div",{class:"status-row"},[r[0]||(r[0]=g("span",{class:"badge lock"},"LOCKED",-1)),r[1]||(r[1]=g("span",{class:"badge"}," ",-1)),g("button",{class:"btn primary",onClick:t}," ")])]),g("section",FO,[r[5]||(r[5]=Tn('<div class="panel-head" data-v-370df6f4><h2 class="panel-title" data-v-370df6f4> </h2><div class="panel-actions" data-v-370df6f4><button class="btn" disabled data-v-370df6f4></button><button class="btn" disabled data-v-370df6f4></button><button class="btn" disabled data-v-370df6f4></button><button class="btn ghost" disabled data-v-370df6f4></button></div></div><div class="empty" data-v-370df6f4>   .  /     . </div>',2)),g("div",UO,[(W(),J(Me,null,Rt(8,i=>g("article",{class:"card",key:i},[...r[4]||(r[4]=[Tn('<div class="card-left" data-v-370df6f4><div class="icon" data-v-370df6f4></div></div><div class="card-mid" data-v-370df6f4><div class="name-row" data-v-370df6f4><div class="name" data-v-370df6f4>  </div><div class="meta" data-v-370df6f4><span class="pill lock" data-v-370df6f4></span><span class="pill time" data-v-370df6f4></span></div></div><div class="hint2" data-v-370df6f4>  : /// ,  , ,   . </div></div><div class="card-right" data-v-370df6f4><button class="btn primary" disabled data-v-370df6f4></button></div>',3)])])),64))])]),g("section",BO,[r[7]||(r[7]=g("h2",{class:"panel-title"},"",-1)),r[8]||(r[8]=g("p",{class:"panel-desc"},"     /  /  .",-1)),g("div",$O,[(W(),J(Me,null,Rt(3,i=>g("div",{class:"mini-card",key:i},[...r[6]||(r[6]=[g("div",{class:"mini-title"},"",-1),g("div",{class:"mini-value muted"},"",-1),g("div",{class:"mini-sub muted"},"",-1)])])),64))])])]))}},qO=Yt(jO,[["__scopeId","data-v-370df6f4"]]),KO={},GO={class:"settings-shell"},zO={class:"settings-nav"},HO={class:"settings-content"};function WO(n,e){return W(),J("div",GO,[g("aside",zO,[mp(n.$slots,"nav",{},void 0)]),g("section",HO,[mp(n.$slots,"content",{},void 0)])])}const QO=Yt(KO,[["render",WO],["__scopeId","data-v-e20a5156"]]),YO={},JO={class:"settings-nav-inner"},XO={class:"menu"};function ZO(n,e){const t=Yo("router-link");return W(),J("nav",JO,[e[1]||(e[1]=g("h3",{class:"title"},"",-1)),g("ul",XO,[g("li",null,[$e(t,{to:{name:"DataManager"}},{default:mn(()=>[...e[0]||(e[0]=[At("   ",-1)])]),_:1})])])])}const eM=Yt(YO,[["render",ZO],["__scopeId","data-v-0036c63e"]]),tM={__name:"SettingsView",setup(n){return(e,t)=>{const s=Yo("router-view");return W(),vi(QO,null,{nav:mn(()=>[$e(eM)]),content:mn(()=>[$e(s)]),_:1})}}},nM={class:"data-manager"},sM={class:"card"},rM={class:"kv"},iM={class:"v"},oM={key:0,class:"hint"},aM={class:"card"},lM={class:"row"},cM=["disabled"],uM=["disabled"],hM=["disabled"],dM={class:"autosave"},fM={class:"autosave-controls"},pM={class:"radio"},mM=["disabled"],gM={class:"radio"},_M=["disabled"],yM={class:"radio"},vM=["disabled"],EM={key:0,class:"hint"},IM={key:0,class:"message"},TM={key:1,class:"preview"},wM={class:"preview-head"},bM={class:"summary"},AM={class:"summary-item"},SM={class:"summary-v"},RM={class:"summary-item"},PM={class:"summary-v"},CM={class:"summary-item"},kM={class:"summary-v"},NM={key:0,class:"pre"},DM={key:2,class:"hint"},VM={class:"modal"},xM={class:"check"},OM={class:"row"},MM=["disabled"],LM=["disabled"],FM={__name:"DataManagerPanel",setup(n){const e=Yc(),t=pe(()=>(e?.user?.value??e?.currentUser?.value??e?.firebaseUser?.value??e?.user??e?.currentUser??null)?.uid??null),{saveNow:s,isSavingFirebaseData:r,autoSaveEnabled:i,autoSaveBase:o,autoSaveIntervalMin:l,setAutoSaveEnabled:c,setAutoSaveBase:u,setAutoSaveIntervalMin:h,autoSaveRunning:f}=$r(),m=pe(()=>r.value),_=be(!1),R=be(""),x=be(!1),O=be(null),$=be(!1);function U(ue){return JSON.stringify(ue,null,2)}function D(ue){if(!ue)return"-";try{return typeof ue?.toDate=="function"?ue.toDate().toLocaleString():ue instanceof Date?ue.toLocaleString():typeof ue=="number"?new Date(ue).toLocaleString():String(ue)}catch{return String(ue)}}const P=be("off");function j(){if(!i.value){P.value="off";return}const ue=Number(o.value),oe=Number(l.value);ue===10&&oe===10?P.value="10":ue===5&&oe===5?P.value="5":ue===10?P.value="10":P.value="5"}Ln([i,o,l],()=>j(),{immediate:!0}),Ln(P,ue=>{if(t.value){if(ue==="off"){c(!1);return}if(ue==="5"){u(5),h(5),c(!0);return}ue==="10"&&(u(10),h(10),c(!0))}});async function Y(){if(t.value){R.value="";try{await s({reason:"manual-ui"}),R.value=" ."}catch(ue){console.error("DataManager: save failed",ue),R.value=` : ${String(ue?.message??ue)}`}}}async function I(){if(t.value){_.value=!0,R.value="",x.value=!1,O.value=null,$.value=!1;try{const ue=ac(cc,"users",t.value,"research","state"),oe=await Tk(ue);oe.exists()?(O.value=oe.data(),x.value=!0,R.value="  ."):R.value="  . ( )"}catch(ue){console.error("DataManager: load failed",ue),R.value=` : ${String(ue?.message??ue)}`}finally{_.value=!1}}}const v=be(!1),w=be(!1),S=be("");function A(){v.value=!0,w.value=!1,S.value=""}function C(){v.value=!1}async function T(){if(t.value){_.value=!0,R.value="";try{const ue=ac(cc,"users",t.value,"research","state");await wk(ue),x.value=!1,O.value=null,$.value=!1,R.value=" .   .",C()}catch(ue){console.error("DataManager: delete failed",ue),R.value=` : ${String(ue?.message??ue)}`}finally{_.value=!1}}}return(ue,oe)=>(W(),J("div",nM,[oe[22]||(oe[22]=g("header",{class:"header"},[g("div",null,[g("h1",{class:"title"}," "),g("p",{class:"desc"},"   ,        . ")])],-1)),g("section",sM,[oe[7]||(oe[7]=g("h2",{class:"card-title"}," ",-1)),g("div",rM,[oe[6]||(oe[6]=g("div",{class:"k"}," ",-1)),g("div",iM,_e(t.value?"":"()"),1)]),t.value?at("",!0):(W(),J("p",oM," Firestore  /   . "))]),g("section",aM,[oe[16]||(oe[16]=g("h2",{class:"card-title"}," ",-1)),g("div",lM,[g("button",{class:"btn",onClick:Y,disabled:!t.value||_.value||m.value},"  ",8,cM),g("button",{class:"btn",onClick:I,disabled:!t.value||_.value},"   ",8,uM),g("button",{class:"btn danger",onClick:A,disabled:!t.value||_.value},"   ",8,hM)]),g("div",dM,[oe[11]||(oe[11]=g("div",{class:"autosave-title"},"",-1)),g("div",fM,[g("label",pM,[ho(g("input",{type:"radio",name:"autosave",value:"off","onUpdate:modelValue":oe[0]||(oe[0]=Ve=>P.value=Ve),disabled:!t.value||_.value},null,8,mM),[[bu,P.value]]),oe[8]||(oe[8]=g("span",null,"",-1))]),g("label",gM,[ho(g("input",{type:"radio",name:"autosave",value:"5","onUpdate:modelValue":oe[1]||(oe[1]=Ve=>P.value=Ve),disabled:!t.value||_.value},null,8,_M),[[bu,P.value]]),oe[9]||(oe[9]=g("span",null,"5",-1))]),g("label",yM,[ho(g("input",{type:"radio",name:"autosave",value:"10","onUpdate:modelValue":oe[2]||(oe[2]=Ve=>P.value=Ve),disabled:!t.value||_.value},null,8,vM),[[bu,P.value]]),oe[10]||(oe[10]=g("span",null,"10",-1))])]),t.value&&Be(i)&&Be(f)?(W(),J("p",EM,"    (KST   ) ")):at("",!0)]),R.value?(W(),J("p",IM,_e(R.value),1)):at("",!0),x.value?(W(),J("div",TM,[g("div",wM,[oe[12]||(oe[12]=g("h3",{class:"preview-title"},"    ",-1)),g("button",{class:"btn small",onClick:oe[3]||(oe[3]=Ve=>$.value=!$.value)},_e($.value?"":""),1)]),g("div",bM,[g("div",AM,[oe[13]||(oe[13]=g("div",{class:"summary-k"},"",-1)),g("div",SM,_e(O.value?.version??"-"),1)]),g("div",RM,[oe[14]||(oe[14]=g("div",{class:"summary-k"},"  ",-1)),g("div",PM,_e(O.value?.transports?.length??0),1)]),g("div",CM,[oe[15]||(oe[15]=g("div",{class:"summary-k"},"",-1)),g("div",kM,_e(D(O.value?.updatedAt)),1)])]),$.value?(W(),J("pre",NM,_e(U(O.value)),1)):at("",!0)])):(W(),J("p",DM,"   ."))]),v.value?(W(),J("div",{key:0,class:"modal-backdrop",onClick:py(C,["self"])},[g("div",VM,[oe[18]||(oe[18]=g("h2",{class:"modal-title"}," ?",-1)),oe[19]||(oe[19]=g("p",{class:"modal-desc danger-text"},"     .  ? ",-1)),oe[20]||(oe[20]=g("p",{class:"modal-desc"},[At("   ,  "),g("b",null," "),At(". ")],-1)),g("label",xM,[ho(g("input",{type:"checkbox","onUpdate:modelValue":oe[4]||(oe[4]=Ve=>w.value=Ve)},null,512),[[Jb,w.value]]),oe[17]||(oe[17]=g("span",null,"      .",-1))]),oe[21]||(oe[21]=g("p",{class:"modal-desc"},[At("   "),g("b",null,"DELETE"),At(" . ")],-1)),ho(g("input",{class:"input","onUpdate:modelValue":oe[5]||(oe[5]=Ve=>S.value=Ve),placeholder:"DELETE"},null,512),[[Yb,S.value]]),g("div",OM,[g("button",{class:"btn",onClick:C,disabled:_.value},"",8,MM),g("button",{class:"btn danger",onClick:T,disabled:_.value||!w.value||S.value!=="DELETE"},"   ",8,LM)])])])):at("",!0)]))}},UM=Yt(FM,[["__scopeId","data-v-a8ca5a4d"]]),BM={__name:"DataManagerView",setup(n){return(e,t)=>(W(),vi(UM))}},$M={class:"preview-page"},jM={__name:"PreviewRunsView",setup(n){return(e,t)=>(W(),J("div",$M,[$e(hT,{class:"preview-left-as-main"})]))}},qM=Yt(jM,[["__scopeId","data-v-3aa6340f"]]),KM=[{path:"/",redirect:"/home/research"},{path:"/home",component:qV,children:[{path:"",redirect:"/home/research"},{path:"preview",name:"PreviewRuns",component:qM},{path:"research",name:"Research",component:lO},{path:"vehicles",name:"Vehicles",component:gO},{path:"line",name:"Line",component:wO},{path:"construction",name:"Construction",component:kO},{path:"finance",name:"Finance",component:MO},{path:"city",name:"City",component:qO},{path:"settings",component:tM,children:[{path:"",redirect:{name:"DataManager"}},{path:"data",name:"DataManager",component:BM}]}]}],GM=lD({history:BN(),routes:KM,scrollBehavior(){return{top:0}}}),{user:zM,authReady:HM}=Yc(),{loadForUser:WM,clearUserState:QM}=$r();let Ku=null;Ln([HM,zM],async([n,e])=>{if(!n)return;if(!e){Ku=null,QM();return}const t=e.uid;t&&t!==Ku&&(Ku=t,await WM(t))},{immediate:!0});const dT=nA(nN);dT.use(GM);dT.mount("#app");
